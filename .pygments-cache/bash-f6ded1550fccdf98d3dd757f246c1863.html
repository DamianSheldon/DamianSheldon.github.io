<div class="highlight"><pre>// Step 1:创建一个 ‘git’ 用户并为其创建一个 .ssh 目录
<span class="nv">$ </span>sudo adduser git 
<span class="nv">$ </span>su -l git
<span class="nv">$ </span><span class="nb">cd</span> ~
<span class="nv">$ </span>mkdir .ssh

// Step 2:把开发者的 SSH 公钥添加到这个用户的 authorized_keys 文件中。
// 假设你通过 e-mail 收到了几个 公钥并存到了临时文件里
<span class="nv">$ </span>cat /tmp/id_rsa.john.pub &gt;&gt; ~/.ssh/authorized_keys
<span class="nv">$ </span>cat /tmp/id_rsa.josie.pub &gt;&gt; ~/.ssh/authorized_keys
<span class="nv">$ </span>cat /tmp/id_rsa.jessica.pub &gt;&gt; ~/.ssh/authorized_keys

// Preparation <span class="p">&amp;</span> Accounts Setup
<span class="nv">$ </span>sudo useradd -G git -d /home/john -m -s /bin/bash john
<span class="nv">$ </span>sudo useradd -G git -d /home/andrew -m -s /bin/bash andrew
<span class="nv">$ </span>sudo useradd -G git -d /home/robert -m -s /bin/bash robert

// Exist user change his primary group by newgrp <span class="nb">command</span>
<span class="nv">$ </span>sudo newgrp -g git john

// Step 3:使用 --bare 选项运行 git init 来设定一个空仓库,这会初始化一个不包含工作目录的仓库
<span class="nv">$sudo</span> mkdir /git
<span class="nv">$sudo</span> chown -R git /git
<span class="nv">$ </span><span class="nb">cd</span> /git
<span class="nv">$ </span>mkdir project.git 
<span class="nv">$ </span><span class="nb">cd </span>project.git
<span class="nv">$ </span>git --bare --shared<span class="o">=</span>group init

// <span class="k">if</span> forget init with --shared<span class="o">=</span>group, we can config with <span class="nb">command</span>:
<span class="nv">$ </span>git config -- core.sharedRepository ture

// Mac 下需要开启ssh并允许remote login
<span class="nv">$launchctl</span> start sshd
// System Preferences -&gt; Sharing -&gt; Remote Login -&gt; All Users

// Step 4:Join,Josie 或者 Jessica 就可以把它加为远程仓库,
推送一个分支,从而把第一个版本的工程上 传到仓库里了
<span class="c"># 在 John 的电脑上</span>
<span class="nv">$ </span><span class="nb">cd </span>myproject
<span class="nv">$ </span>git init
<span class="nv">$ </span>git add .
<span class="nv">$ </span>git commit -m <span class="s1">&#39;initial commit&#39;</span>
<span class="nv">$ </span>git remote add origin git@gitserver:/git/project.git 
<span class="nv">$ </span>git push origin master

// Step 5:其他人的克隆和推送也一样变得很简单
<span class="nv">$ </span>git clone git@gitserver:/git/project.git 
<span class="nv">$ </span>vim README
<span class="nv">$ </span>git commit -am <span class="s1">&#39;fix for the README file&#39;</span>
<span class="nv">$ </span>git push origin master

// Step 6:用这个方法可以很快捷的为少数几个开发者架设一个可读写的 Git 服务


// 如何生成 SSH 公钥？
// Step 1:首先,确定一下是否已经有一个公钥了。SSH 公钥默认储存 在账户的 ~/.ssh 目录。
// 进入那里并查看其内容,有没有公钥一目了然:
<span class="nv">$ </span><span class="nb">cd</span> ~/.ssh
<span class="nv">$ </span>ls
authorized_keys2 id_dsa known_hosts config id_dsa.pub

// Step 2:关键是看有没有用 文件名 和 文件名.pub 来命名的一对文件,
// 这个 文件名 通常是 id_dsa 或者 id_rsa。 .pub 文件是公钥,另一个文件是密钥。
// 假如没有这些文件<span class="o">(</span>或者干脆连 .ssh 目录都没有<span class="o">)</span>,你可以用 ssh- keygen 的程序来建立它们,
// 该程序在 Linux/Mac 系统由 SSH 包提供, 在 Windows 上则包含在 MSysGit 包 里:
<span class="nv">$ </span>ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key <span class="o">(</span>/Users/schacon/.ssh/id_rsa<span class="o">)</span>:
Enter passphrase <span class="o">(</span>empty <span class="k">for</span> no passphrase<span class="o">)</span>:
Enter same passphrase again:
Your identification has been saved in /Users/schacon/.ssh/id_rsa.
Your public key has been saved in /Users/schacon/.ssh/id_rsa.pub.
The key fingerprint is:
43:c5:5b:5f:b1:f1:50:43:ad:20:a6:92:6a:1f:9a:3a schacon@agadorlaptop.local

// Step 3:它先要求你确认保存公钥的位置<span class="o">(</span>.ssh/id_rsa<span class="o">)</span>,然后它会让你重复一个密码两次,
// 如果不想在使用公钥的 时候输入密码,可以留空。
// 现在,所有做过这一步的用户都得把它们的公钥给你
// 或者 Git 服务器的管理者<span class="o">(</span>假设 SSH 服务被设定为使 用公钥机制<span class="o">)</span>。
// 他们只需要复制 .put 文件的内容然后 e-email 之。公钥的样子大致如下:
<span class="nv">$ </span>cat ~/.ssh/id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAklOUpkDHrfHY17SbrmTIpNLTGK9Tjom/BWDSU 
GPl+nafzlHDTYW7hdI4yZ5ew18JH4JW9jbhUFrviQzM7xlELEVf4h9lFX5QVkbPppSwg0cda3 
Pbv7kOdJ/MTyBlWXFCR+HAo3FXRitBqxiX1nKhXpHAZsMciLq8V6RjsNAQwdsdMFvSlVK/7XA 
t3FaoJoAsncM1Q9x5+3V0Ww68/eIFmb1zuUFljQJKprrX88XypNDvjYNby6vw/Pb0rwert/En 
mZ+AW4OZPnTPI89ZPmVMLuayrD2cE86Z/il8b+gw3r3+1nKatmIkjn2so1d01QraTlMqVSsbx 
NrRFi9wrf+M7Q<span class="o">==</span> schacon@agadorlaptop.local
</pre></div>