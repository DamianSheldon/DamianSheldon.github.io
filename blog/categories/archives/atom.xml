<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: archives | Hello World]]></title>
  <link href="http://DamianSheldon.github.io/blog/categories/archives/atom.xml" rel="self"/>
  <link href="http://DamianSheldon.github.io/"/>
  <updated>2016-10-10T11:49:51+08:00</updated>
  <id>http://DamianSheldon.github.io/</id>
  <author>
    <name><![CDATA[Sheldon]]></name>
    <email><![CDATA[dongmeilianghy@sina.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[iOS Technical Interview Part 4]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-technical-interview-part-4.html"/>
    <updated>2016-08-30T10:43:36+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-technical-interview-part-4</id>
    <content type="html"><![CDATA[<h3>1.熟悉 CocoaPods 么？能大概讲一下工作原理么？</h3>

<p>A:熟悉，项目中的 Podfile 文件指定了使用的第三方库，根据它可以找到对应的 podspec 。 podspec 文件存储着第三方库的基本信息：包含哪些文件，静态库，资源文件，信赖哪些其他第三方库、系统框架，之后 pod 会创建一个工程，把这个库以 target 的形式包含进来，应用则依赖这个 pod 工程。</p>

<h3>2.最常用的版本控制工具是什么，能大概讲讲原理么？</h3>

<p>A: Git</p>

<h3>3.你一般是怎么用 Instruments 的？</h3>

<p>A:根据想要分析的问题，选择对应的　instruments　，同时参考　Instruments　User　Guide．</p>

<h3>4.你一般是如何调试 Bug 的</h3>

<p>A:复现 bug，之后单步调试定位。</p>

<h3>5.你在你的项目中用到了哪些设计模式？</h3>

<p>A:</p>

<pre><code>* 单例
* 委托
* Target-Action
* MVC
* 观察者
* 工厂方法
* 信息流
* 类簇
</code></pre>

<!-- more -->


<h3>6.如何实现单例，单例会有什么弊端？</h3>

<p>A：</p>

<pre><code>+ (instancetype)sharedInstance
{
    static dispatch_once_t once;
    static id sharedInstance;
    dispatch_once(&amp;once, ^{
        sharedInstance = [[self alloc] init];
    });
    return sharedInstance;
}
</code></pre>

<ul>
<li>单例相当于全局变量，因此存在强藕合，不利于扩展和应对变化；</li>
<li>单例违背单一设计原则；</li>
</ul>


<h3>7.如何把一个包含自定义对象的数组序列化到磁盘？</h3>

<p>A:自定义对象需要实现 NSCoding 协议，然后可以调用 NSKeyedArchiver 的<code>+ (BOOL)archiveRootObject:(id)rootObject toFile:(NSString *)path</code>方法将它序列化到磁盘。</p>

<h3>8.iOS 的沙盒目录结构是怎样的？ App Bundle 里面都有什么？</h3>

<p>A:</p>

<p>App Bundle 里面有 Info.plist, Executeable, Resource files and Other support files.</p>

<h3>9.iOS 7的多任务添加了哪两个新的 API? 各自的使用场景是什么？</h3>

<p>A:</p>

<ul>
<li>Apps that regularly update their content by contacting a server can register with the system and be launched periodically to retrieve that content in the background. To register, include the UIBackgroundModes key with the fetch value in your app’s Info.plist file. Then, when your app is launched, call the setMinimumBackgroundFetchInterval: method to determine how often it receives update messages. Finally, you must also implement the application:performFetchWithCompletionHandler: method in your app delegate.</li>
<li>Apps that use push notifications to notify the user that new content is available can fetch the content in the background. To support this mode, include the UIBackgroundModes key with the remote-notification value in your app’s Info.plist file. You must also implement the application:didReceiveRemoteNotification:fetchCompletionHandler: method in your app delegate.</li>
</ul>


<p>Reference: What&rsquo;s New in iOS</p>

<h3>10.Objective-C 的 class 是如何实现的？Selector 是如何被转化为 C 语言的函数调用的？</h3>

<p>A:</p>

<p>[receiver message]</p>

<p>=> objc_msgSend(receiver, selector);</p>

<h3>11.UIScrollView 大概是如何实现的，它是如何捕捉、响应手势的？</h3>

<h3>12.Objective-C 如何对已有的方法，添加自己的功能代码以实现类似记录日志这样的功能？</h3>

<p>A: Method Swizzle.</p>

<h3>13.<code>+load</code> 和 <code>+initialize</code> 的区别是什么？</h3>

<p>A:</p>

<ul>
<li>load:Invoked whenever a class or category is added to the Objective-C runtime; implement this method to perform class-specific behavior upon loading.</li>
<li>initialize:Initializes the class before it receives its first message.</li>
</ul>


<h3>14.NSOperation 相比于 GCD 有哪些优势？</h3>

<p>A:</p>

<ul>
<li>可以取消操作；</li>
<li>可以添加依赖；</li>
<li>可以 KVO 属性;</li>
<li>可以添加优先级;</li>
<li>可以复用;</li>
</ul>


<h3>15.strong / weak / unsafe_unretained 的区别</h3>

<p>A:</p>

<ul>
<li>strong:对象的引用计数加一;</li>
<li>weak:对象的引用计数不变，对象销毁时 weak 属性自动置为nil;</li>
<li>unsafe_unretained:对象的引用计数不变，对象销毁时 unsafe_unretained 属性成为野指针;</li>
</ul>


<p>你可能会奇怪，有了 weak 还要 unsafe_unretained 干什么？ 原因是 weak 是 iOS 5 才可用的，所以当你要兼容 iOS 5, 或者将 iOS 5 时代之前 MRC 代码迁移到 ARC 时会用它，除些之外我们应该使用 weak.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/15968198/what-is-the-use-of-unsafe-unretained-attribute">http://stackoverflow.com/questions/15968198/what-is-the-use-of-unsafe-unretained-attribute</a></p>

<h3>16.Objective-C 中，meta-class 指的是什么</h3>

<p>A:类对象的类称为 meta-class.</p>

<h3>17.UIView 和 CALayer 之间的关系？</h3>

<p>A: UIView 会持有至少一个 CALayer 实例，CALayer 是 UIView 的骨架，它将 UIView 的内容绘制出来并提供动画支持。</p>

<h3>18.<code>+[UIView animateWithDuration:animations:completion:]</code> 内部大概是如何实现的？</h3>

<p>A:我觉得<code>+[UIView animateWithDuration:animations:completion:]</code> 内部应该是先使能 CALayer 实例的隐式动画，之后对 UIView animatable properties 的设置会传递到 CALayer 对应属性的 setter 方法，CALayer 的 setter 方法会触发对应的隐式动画，最后禁止 CALayer 实例的隐式动画。</p>

<p>Reference:</p>

<ul>
<li><a href="https://www.quora.com/How-is-UIViews-+animateWithDuration-animations-implemented">https://www.quora.com/How-is-UIViews-+animateWithDuration-animations-implemented</a></li>
<li><a href="http://stackoverflow.com/questions/15175750/how-uiview-animations-with-blocks-work-under-the-hood">http://stackoverflow.com/questions/15175750/how-uiview-animations-with-blocks-work-under-the-hood</a></li>
</ul>


<h3>19.什么时候会发生「隐式动画」？</h3>

<p>A: CALayer 的实例是支持隐式动画的，所以修改 CALayer Animatable Properties 里面的属性都可以触发隐式动画。UIView 默认禁止了 CALayer 的隐式动画，在动画块中又使能了，所以和 UIView 关联的 CALayer 实例只能在动画块中修改 Animatable UIView properties 里的属性也可以触发隐式动画。</p>

<p>Reference:<a href="http://stackoverflow.com/questions/4749343/when-exactly-do-implicit-animations-take-place-in-ios">http://stackoverflow.com/questions/4749343/when-exactly-do-implicit-animations-take-place-in-ios</a></p>

<h3>20.如何把一张大图缩小为1/4大小的缩略图？</h3>

<p>A:</p>

<ul>
<li>UIGraphicsBeginImageContextWithOptions &amp; UIImage -drawInRect:(UIKit)</li>
<li>CGBitmapContextCreate &amp; CGContextDrawImage(Core Graphics)</li>
<li>CGImageSourceCreateThumbnailAtIndex(Image IO)</li>
<li>Lanczos Resampling with Core Image(Core Image)</li>
<li>vImage in Accelerate(vImage)</li>
</ul>


<p>Reference:<a href="http://nshipster.com/image-resizing/">http://nshipster.com/image-resizing/</a></p>

<h3>21.Toll-Free Bridging 是什么？什么情况下会使用？</h3>

<p>A:</p>

<blockquote><p>There are a number of data types in the Core Foundation framework and the Foundation framework that can be used interchangeably. Data types that can be used interchangeably are also referred to as toll-free bridged data types. This means that you can use the same data structure as the argument to a Core Foundation function call or as the receiver of an Objective-C message invocation.</p></blockquote>

<h3>22.当系统出现内存警告时会发生什么？</h3>

<p>A:系统会杀死后台内存占用量大的应用释放内存给当前运行的应用，当前的应用也会收到内存警告的通知。</p>

<h3>23.什么是 Protocol，Delegate 一般是怎么用的？</h3>

<p>A:Protocol是一份消息合约。Delegate 是我们改变一个对象行为方式，这种方式不需要对类做继承。</p>

<h3>24.UIWebView 有哪些性能问题？有没有可替代的方案。</h3>

<p>A:</p>

<ul>
<li><strong>线程阻塞问题</strong>&ndash;当在 native 层调用 stringByEvaluatingJavaScriptFromString 方法时，可能由于 javascript 是单线程的原因，会阻塞原有 js 代码的执行。这里我们的解决办法是在 js 端用 defer 将 iframe 的插入延后执行。</li>
<li><strong>主线程的问题</strong>&ndash;UIWebView 的 stringByEvaluatingJavaScriptFromString 方法必须是主线程中执行，而主线程的执行时间过长就会 block UI 的更新。所以我们应该尽量让 stringByEvaluatingJavaScriptFromString 方法执行的时间短。</li>
</ul>


<p>Reference:<a href="http://blog.devtang.com/2012/03/24/talk-about-uiwebview-and-phonegap/">关于UIWebView的总结</a></p>

<h3>25.为什么 NotificationCenter 要 removeObserver? 如何实现自动 remove?</h3>

<p>A:因为之后产生了 Observer 感兴趣的通知 NotificationCenter 会调用 Observer 对应的处理方法，如果 Observer 销毁之后不从 NotificationCenter remove,那么会导致应用崩溃。</p>

<p>想要实现自动 remove，如果 NotificationCenter 对 Observer 的引用在 Observer 销毁后能自动置为 nil，类似 weak 的效果，那么问题就解决了。我们不能去修改 NotificationCenter 的内部实现，所以只能用其他的办法。有一个想法是在 Observer 销毁时调用 remove，可以利用 Objective-C 的 runtime 来帮助我们实现。具体思路是混写 addObserver 的方法，在这个混写方法中创建一个对象和 Observer 的生命周期关联起来，然后在这个关联对象的销毁方法中调用 removeObserver。</p>

<p>Reference:<a href="http://merowing.info/2012/03/automatic-removal-of-nsnotificationcenter-or-kvo-observers/">Automatic removal of NSNotificationCenter or KVO observers</a></p>

<h3>26.当 TableView 的 Cell 改变时，如何让这些改变以动画的形式呈现？</h3>

<p>A:You can also use beginUpdates method followed by the endUpdates method to animate the change in the row heights without reloading the cell.</p>

<h3>27.什么是 Method Swizzle，什么情况下会使用？</h3>

<p>A:Method Swizzle 是一种改变已存在方法实现的技术。当我们有改变已存在方法实现的需求是使用。</p>

<h3>28.为什么当 Core Animation 完成时，layer 又会恢复到原先的状态？</h3>

<p>A: Layer 有两个独立的图层: 1.modelLayer;2.presentationLayer. 动画是在 presentationLayer 上，所以当动画完成时， layer 又恢复到原先的状态。</p>

<h3>29.你会如何存储用户的一些敏感信息，如登录的 token。</h3>

<p>A:KeyChain services</p>

<h3>30.什么时候会使用 Core Graphics，有什么注意事项么？</h3>

<p>A:当需要绘制的内容不能用 UIKit 实现时，会使用 Core Graphics。</p>

<p>注意事项：</p>

<pre><code>* 坐标系统
* 线条的宽度尽量使用整数
* 缓存代价昂贵的数据
</code></pre>

<h3>31.使用 Block 时需要注意哪些问题？</h3>

<p>A:</p>

<ul>
<li>循环引用</li>
<li>对象的生命周期会延长</li>
</ul>


<h3>32.performSelector:withObject:afterDelay: 内部大概是怎么实现的，有什么注意事项么？</h3>

<p>A:</p>

<pre><code>- (void)eoc_performSelector:(SEL)aSelector
withObject:(id)anArgument
afterDelay:(NSTimeInterval)delay
{
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delay * NSEC_PER_SEC)), dispatch_get_global_queue(QOS_CLASS_UTILITY, 0), ^{
            typedef void (*send_type)(id, SEL, id);

            send_type func = (send_type)objc_msgSend;
            func(self, aSelector, anArgument);
            });
}
</code></pre>

<p>注意事项：
可能会导致内存泄露。因为不确定调用的方法，所以编译器不能插入合适的内存管理方法调用。例如newObject，copy之类的方法调用就会导致内存泄露。</p>

<h3>33.如何播放 GIF 图片，有什么优化方案么？</h3>

<p>A: 用 ImageIO 框架为每一帧动画创建一个 UIImage 对象，把这些对象聚合成一个 animatedImages 赋给 UIImageView，然后根据 GIF 的文件信息设置好 animationDuration 和 animationRepeatCount，最后调用 startAnimating。</p>

<p>优化方案：</p>

<pre><code>* variable frame delays -- One approach to support variable frame delays with UIImageView is to find the greatest common divisor of all frame delays and slot longer frames multiple times in a row into the animatedImages array.

* memory implications -- Whenever memory is the constraint, instead of storing the solution to a problem one has to recalculate it. In our case we needed a way to load and decode the frames just in time before they were displayed, and to purge the ones that were no longer on screen.
</code></pre>

<p>Reference:</p>

<pre><code>* [How FlipBoard Play Animated GIFs On iOS](http://engineering.flipboard.com/2014/05/animated-gif/)
</code></pre>

<h3>34.有哪几种方式可以对图片进行缩放，使用 CoreGraphics 缩放时有什么注意事项？</h3>

<p>A:</p>

<ul>
<li>UIGraphicsBeginImageContextWithOptions &amp; UIImage -drawInRect:(UIKit)</li>
<li>CGBitmapContextCreate &amp; CGContextDrawImage(Core Graphics)</li>
<li>CGImageSourceCreateThumbnailAtIndex(Image IO)</li>
<li>Lanczos Resampling with Core Image(Core Image)</li>
<li>vImage in Accelerate(vImage)</li>
</ul>


<h3>35.哪些途径可以让 ViewController 瘦下来？</h3>

<p>A: 我们的 App 基本都是使用类 MVC 架构，要想让 ViewController 瘦下来，基本的想法肯定是把和 ViewController 弱相关的代码移出去，移到哪？要么是称多 MV 中， 要么移到一个辅助对象中。所以基本做法应该是把弱业务代码移到 Model 中，和 View 相关的代码移到 View 中；甚至引入一个辅助对象来分担可以分离出去的职责。</p>

<p>Reference: <a href="https://objccn.io/issue-1-1/">更轻量的 View Controllers</a></p>

<h3>36.有哪些常见的 Crash 场景？</h3>

<p>A:</p>

<ul>
<li>数组越界</li>
<li>向数组或字典中插入的对象为 nil</li>
<li>向已经销毁的对象发送消息</li>
<li>内存管理出错</li>
<li>调用一个对象不支持的方法</li>
<li>看门狗超时</li>
<li>在非主线程操作 UI</li>
</ul>


<h3>37.设计一套大文件（如上百M的视频）下载方案。</h3>

<p>A:
<a href="https://github.com/thibaultcha/TCBlobDownload">TCBlobDownload</a></p>

<h3>38.如果让你来实现 dispatch_once，你会怎么做？</h3>

<p>A:</p>

<pre><code>void SpinlockOnce(dispatch_once_t *predicate, dispatch_block_t block) {
        static OSSpinLock lock = OS_SPINLOCK_INIT;

        OSSpinLockLock(&amp;lock);
        if(!*predicate) {
            block();
            *predicate = 1;
        }
        OSSpinLockUnlock(&amp;lock);
    }
</code></pre>

<p>Reference:
<a href="https://www.mikeash.com/pyblog/friday-qa-2014-06-06-secrets-of-dispatch_once.html">Friday Q&amp;A 2014-06-06: Secrets of dispatch_once</a></p>

<p>Reference:<a href="https://github.com/lzyy/iOS-Developer-Interview-Questions">https://github.com/lzyy/iOS-Developer-Interview-Questions</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（八）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-8.html"/>
    <updated>2016-06-24T15:54:30+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-8</id>
    <content type="html"><![CDATA[<h3>1.Detect hash tags #, mention tags @, in iOS like in Twitter App</h3>

<p>A:You can use <a href="https://github.com/Krelborn/KILabel">https://github.com/Krelborn/KILabel</a> this library. It also detect user taps on hashtags Like this:</p>

<pre><code>label.hashtagLinkTapHandler = ^(KILabel *label, NSString *string, NSRange range) {
  NSLog(@"Hashtag tapped %@", string);
};
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/24359972/detect-hash-tags-mention-tags-in-ios-like-in-twitter-app">http://stackoverflow.com/questions/24359972/detect-hash-tags-mention-tags-in-ios-like-in-twitter-app</a></p>

<h3>2.如何给应用重签名？</h3>

<p>A：利用用途广泛的命令行工具 security快速地显示出你的系统中能用来对代码进行签名的认证的方法：</p>

<pre><code>$ security find-identity -v -p codesigning                       
  1) 01C8E9712E9632E6D84EC533827B4478938A3B15 "iPhone Developer: Thomas Kollbach (7TPNXN7G6K)"
</code></pre>

<p>用<a href="https://github.com/fastlane/fastlane/tree/master/sigh">sign</a>给应用重签名</p>

<pre><code>$ sigh resign ./path/app.ipa --signing_identity "iPhone Distribution: Felix Krause" -p "my.mobileprovision"
</code></pre>

<p>Reference:<a href="http://objccn.io/issue-17-2/">http://objccn.io/issue-17-2/</a></p>

<!--more-->


<h3>3. It report BAD_ACCESS when set delegate for AVAudioPlayer.</h3>

<p>A: The reason is I instance AVAuidoPlayer without content like this:</p>

<pre><code>AVAudioPlayer *audioPlayer = [AVAudioPlayer new];
audioPlayer.delegate = self;
</code></pre>

<p>We should instance it with content:</p>

<pre><code>_audioPlayer = [[AVAudioPlayer alloc] initWithData:_audioData error:nil];
[_audioPlayer prepareToPlay];
_audioPlayer.delegate = self;
</code></pre>

<h3>4.  How can I show my own app icon at the bottom-left corner of iPhone lock screen?</h3>

<p>Solution: 1. This is iOS 8 new feature called Handoff more info <a href="http://www.macrumors.com/2014/06/03/ios-8-apps-quick-access/">here</a>.</p>

<ol>
<li>You can&rsquo;t control what app appears in the bottom-left corner of the lock screen. Neither can you add code to your app to make your app appear there whenever you want. These are called Suggested Apps and it&rsquo;s a feature of iOS.</li>
</ol>


<p>iOS controls what app appears there based on several factors, including your location, the apps on your device, and your history of where &amp; when you use those apps. Together, iOS trys to present you with the app you would most-likely use at a given time, location, and history.</p>

<p>If you don&rsquo;t like this feature, it can be turned off in Settings -> General -> Handoff &amp; Suggested Apps.</p>

<p>Reference:<a href="http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen">http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen</a></p>

<p><a href="http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen">http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen</a></p>

<h3>5.</h3>

<pre><code>     Class AJXorEncryptor is implemented in both /Users/dongmeiliang/Library/Developer/CoreSimulator/Devices/71988A60-BE7B-425A-BDE4-AAE4D098A516/data/Containers/Bundle/Application/051ED3F9-A920-41C8-9D96-41EED06DE618/AJFrameDevApp.app/AJFrameDevApp and /Users/dongmeiliang/Library/Developer/Xcode/DerivedData/AJFrameDevApp-fwmhocnqvmbmzkftzzdryfyigyzs/Build/Products/Debug-iphonesimulator/AJFrameDevApp.app/PlugIns/AJFrameDevAppTests.xctest/AJFrameDevAppTests. One of the two will be used. Which one is undefined.
</code></pre>

<p> A:问题的原因是AJFrameDevApp和AJFrameDevAppTests这两个target都链接了一个相同的静态库。
 于是我将Podfile的内容由</p>

<pre><code>target 'AJFrameDevApp' do
    pod 'AJFrame', :path =&gt; '../'
end

target 'AJFrameDevAppTests' do
    pod 'AJFrame', :path =&gt; '../'
end
</code></pre>

<p>改为：</p>

<pre><code>target 'AJFrameDevApp' do
    pod 'AJFrame', :path =&gt; '../'

    target 'AJFrameDevAppTests' do
        inherit! :search_paths

    end
end
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/30581884/class-is-implemented-in-both-one-of-the-two-will-be-used/30582486">http://stackoverflow.com/questions/30581884/class-is-implemented-in-both-one-of-the-two-will-be-used/30582486</a></p>

<h3>6. 如何调用私有类的私有方法？真实的场景是开发了一个库，库中A持有一个私有类的属性，那么如何对私有类进行相应的单元测试呢？</h3>

<p>A：Objective-C的runtime可以帮我们做到，</p>

<pre><code>#include &lt;objc/message.h&gt;

NSString *originalString = @"testEncryptMethod";

NSData *originalData = [originalString dataUsingEncoding:NSUTF8StringEncoding];

AJBinaryChannel *binaryChannel = [AJBinaryChannel new];
binaryChannel.encryptKey = @"xorkey";

id wrapperEncryptor = (id)(binaryChannel.encryptor);

typedef NSData* (*send_type)(id, SEL, id);

send_type func = (send_type)objc_msgSend;

NSData *encryptData = func(wrapperEncryptor, @selector(encrypt:), originalData);

NSString *encryptString = [[NSString alloc] initWithData:encryptData encoding:NSUTF8StringEncoding];

XCTAssertNotEqualObjects(originalString, encryptString);

NSData *decryptData = func(wrapperEncryptor, @selector(decrypt:), encryptData);

NSString *decryptString = [[NSString alloc] initWithData:decryptData encoding:NSUTF8StringEncoding];

XCTAssertEqualObjects(originalString, decryptString);
</code></pre>

<h3>7.Too many arguments to function call, expected 0, have 3</h3>

<p>A:The answer is you need to strong type objc_msgSend for the compiler to build it:</p>

<pre><code>typedef void (*send_type)(void*, SEL, void*);
send_type func = (send_type)objc_msgSend;
func(anItem.callback_object, NSSelectorFromString(anItem.selector), dict);
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/24922913/too-many-arguments-to-function-call-expected-0-have-3">http://stackoverflow.com/questions/24922913/too-many-arguments-to-function-call-expected-0-have-3</a></p>

<h3>8. Why do we need Base64?</h3>

<p>A:Base64 is a group of similar binary-to-text encoding schemes that represent binary data in an ASCII string format by translating it into a radix-64 representation.
A binary-to-text encoding is encoding of data in plain text. More precisely, it is an encoding of binary data in a sequence of characters. <strong>These encodings are necessary for transmission of data when the channel does not allow binary data (such as email or NNTP) or is not 8-bit clean.</strong></p>

<p>Reference:<a href="https://en.wikipedia.org/wiki/Base64">https://en.wikipedia.org/wiki/Base64</a>
<a href="https://en.wikipedia.org/wiki/Binary-to-text_encoding">https://en.wikipedia.org/wiki/Binary-to-text_encoding</a></p>

<h3>9. 360° panorama libraries for ios</h3>

<p>A:<a href="https://code.google.com/archive/p/panoramagl/">panoramagl</a></p>

<p>Reference:<a href="http://stackoverflow.com/questions/3763978/360-panorama-libraries-for-ios">http://stackoverflow.com/questions/3763978/360-panorama-libraries-for-ios</a></p>

<h3>10. When should we use macro in iOS?</h3>

<p>A: As we known, macro has many disatanges:1.lack type info;2.can be redfine. Since its a keyword in C, when should we use it?</p>

<p>There are occasions where macros provide functionality not available through other means.</p>

<p>For example, I have a simple macro I sometimes use when debugging Objective-C to log when certain methods are called. This can be done like so:</p>

<p><code>NSLog(@"%@: %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd));</code>
This can’t be moved into an Objective-C method because it will always log the name of that method. (Obviously it can’t be moved into a C method, as there is no self and no _cmd variables available.) Creating a macro for this is straightforward, however:</p>

<p><code>#define LOG_SELECTOR()  NSLog(@"%@: %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd));</code></p>

<p>Reference:<a href="http://weblog.highorderbit.com/post/11656225202/appropriate-use-of-c-macros-for-objective-c">Appropriate Use of C Macros for Objective-C Developers</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（七）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-7.html"/>
    <updated>2016-05-03T17:00:04+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-7</id>
    <content type="html"><![CDATA[<h3>1.如何设置透明的导航栏并且去掉其底部灰色的分隔线？</h3>

<p>A:可以通过设置导航栏的背景图和阴隐图为透明的图片来实现。</p>

<pre><code>- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];

    self.translucent = self.navigationController.navigationBar.isTranslucent;
    self.navigationController.navigationBar.translucent = YES;

    self.previousImage = [self.navigationController.navigationBar backgroundImageForBarMetrics:UIBarMetricsDefault];

    UIImage *newImage = [UIImage imageNamed:@"TransparentPixel"];
    [self.navigationController.navigationBar setBackgroundImage:newImage forBarMetrics:UIBarMetricsDefault];

    self.previousShadowImage = self.navigationController.navigationBar.shadowImage;
    self.navigationController.navigationBar.shadowImage = newImage;
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];

    self.navigationController.navigationBar.translucent = self.translucent;

    [self.navigationController.navigationBar setBackgroundImage:self.previousImage forBarMetrics:UIBarMetricsDefault];
    self.navigationController.navigationBar.shadowImage = self.previousShadowImage;
}
</code></pre>

<p>Reference:Apple&rsquo;s sample code Customizing UINavigationBar<br/>
<a href="http://stackoverflow.com/questions/18921082/separator-between-navigation-bar-and-view-ios-7">http://stackoverflow.com/questions/18921082/separator-between-navigation-bar-and-view-ios-7</a></p>

<!-- more -->


<h3>2. 自定义的View设置cornerRadius不生效</h3>

<h3>3. CocoaPods 升级到1.0，Xcode 一直报 header file not found.</h3>

<p>A: 仔细查看了 Xcode 的编译过程，头文件的路径是包含了的，于是怀疑是Xcode的自身可能存在问题。经过实验，可以用下面的方法解决：</p>

<ol>
<li>Clean project</li>
<li>Window > Projects > Your Project > Delete Derived Data</li>
<li>Build</li>
</ol>


<h3>4. No codesigning identities (i.e. certificate and private key pairs) that match the team ID: xxx</h3>

<p>A:</p>

<ul>
<li>Go to Xcode preferences, view details of the Apple ID, and delete the provisioning file that&rsquo;s complaining, redownload.</li>
<li>Go to the Keychain Access, and delete the development certificate that&rsquo;s related to the provisioning file you just deleted.</li>
</ul>


<p>Reference:<a href="http://stackoverflow.com/questions/19197497/ios-7-0-no-code-signing-identities-found">http://stackoverflow.com/questions/19197497/ios-7-0-no-code-signing-identities-found</a></p>

<h3>5. How to load image from CocoaPods resource bundle ?</h3>

<p>A:</p>

<pre><code>  s.resource_bundles = {
    'DMLSelector' =&gt; ['DMLSelector/Assets/*.png']
  }

  NSBundle *bundle = [NSBundle bundleForClass:[self class]];
  self.imageView.image = [UIImage imageNamed:@"DMLSelector.bundle/Checked" inBundle:bundle compatibleWithTraitCollection:nil];
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/23835052/load-image-from-cocoapods-resource-bundle">http://stackoverflow.com/questions/23835052/load-image-from-cocoapods-resource-bundle</a></p>

<h3>6. How to specify NSLineBreakMode in boundingRectWithSize?</h3>

<p>A: Use NSParagraphStyleAttributeName &amp; NSParagraphStyle:</p>

<pre><code>NSMutableParagraphStyle *paragraph = [[NSMutableParagraphStyle alloc] init];
paragraph.lineBreakMode = NSLineBreakByWordWrapping; //e.g.

CGSize size = [label.text boundingRectWithSize: constrainedSize options:NSStringDrawingUsesLineFragmentOrigin attributes: @{ NSFontAttributeName: label.font, NSParagraphStyleAttributeName: paragraph } context: nil].size;
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/20631464/how-to-specify-nslinebreakmode-in-boundingrectwithsize">http://stackoverflow.com/questions/20631464/how-to-specify-nslinebreakmode-in-boundingrectwithsize</a></p>

<h3>7.</h3>

<pre><code>INFO [2016-06-01 15:42:30.78]: ---------------------------------------------------------------------
INFO [2016-06-01 15:42:30.78]: --- Step: fir p ../BBCApp.ipa -T token ---
INFO [2016-06-01 15:42:30.78]: ---------------------------------------------------------------------
INFO [2016-06-01 15:42:30.78]: $ fir p ../BBCApp.ipa -T c977500277789d01cc67d82750057858
INFO [2016-06-01 15:42:34.31]: ▸ /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/dependency.rb:296:in `to_specs': Could not find 'fir-cli' (&gt;= 0) among 206 total gem(s) (Gem::LoadError)
INFO [2016-06-01 15:42:34.31]: ▸ from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/dependency.rb:307:in `to_spec'
INFO [2016-06-01 15:42:34.31]: ▸ from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_gem.rb:47:in `gem'
INFO [2016-06-01 15:42:34.31]: ▸ from /usr/local/bin/fir:22:in `&lt;main&gt;'
</code></pre>

<p>A: 问题的原因是找不到fir这个命令，可以直接指定绝对路径解决。</p>

<pre><code>sh "/Library/Ruby/Gems/2.0.0/gems/fir-cli-1.5.0/bin/fir p ../BBCApp.ipa -T token"
</code></pre>

<h3>8. 怎么获取iPhone上已安装App的ipa文件？</h3>

<p>A: 可以利用iTunes下载已购的功能。</p>

<p>You can redownload apps on your iPhone or iPod touch, iPad, Mac or PC, or Apple TV (4th generation). You can also redownload some in-app purchases.</p>

<p>On a Mac or PC
From iTunes
1. Open iTunes.
2. Click Sign In, and then enter your Apple ID and password.
3. Click your name and select Purchased from the menu.
4. From the upper-right corner of the screen, click Apps.
5. Click &ldquo;Not in My Library&rdquo; to view purchased content that isn&rsquo;t on your computer.
6. Scroll to find the item that you want to download.
7. Click the Download icon  in the upper-right corner of the item that you want to download. Your app downloads to your library.</p>

<p>下载需要点时间，所以点开My Apps tab面不能马上看到刚下载的App,右上角有个下载进度提示，点击可以看详情。</p>

<p>Reference:<a href="https://support.apple.com/en-qa/HT201272">https://support.apple.com/en-qa/HT201272</a></p>

<h3>9. UICollectionView&rsquo;s cellForItemAtIndexPath is not being called</h3>

<p>A:</p>

<pre><code>self.automaticallyAdjustsScrollViewInsets = NO;
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/14668781/uicollectionviews-cellforitematindexpath-is-not-being-called?rq=1">http://stackoverflow.com/questions/14668781/uicollectionviews-cellforitematindexpath-is-not-being-called?rq=1</a></p>

<h3>10. iOS supported audio formats?</h3>

<p>A:</p>

<pre><code>@"aac",@"adts",@"ac3",@"aif",@"aiff",@"aifc",@"caf",@"mp3",@"mp4",@"m4a",@"snd",@"au",@"sd2",@"wav"
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/1761460/supported-audio-file-formats-in-iphone">http://stackoverflow.com/questions/1761460/supported-audio-file-formats-in-iphone</a>
<a href="https://www.raywenderlich.com/69365/audio-tutorial-ios-file-data-formats-2014-edition">https://www.raywenderlich.com/69365/audio-tutorial-ios-file-data-formats-2014-edition</a></p>

<h3>11. How do I put the image on the right side of the text in a UIButton?</h3>

<p>A:</p>

<pre><code>CGFloat spacing          = 3;
    CGFloat insetAmount      = 0.5 * spacing;

    // First set overall size of the button:
    button.contentEdgeInsets = UIEdgeInsetsMake(0, insetAmount, 0, insetAmount);
    [button sizeToFit];

    // Then adjust title and image insets so image is flipped to the right and there is spacing between title and image:
    button.titleEdgeInsets   = UIEdgeInsetsMake(0, -button.imageView.frame.size.width - insetAmount, 0,  button.imageView.frame.size.width  + insetAmount);
    button.imageEdgeInsets   = UIEdgeInsetsMake(0, button.titleLabel.frame.size.width + insetAmount, 0, -button.titleLabel.frame.size.width - insetAmount);
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/7100976/how-do-i-put-the-image-on-the-right-side-of-the-text-in-a-uibutton">http://stackoverflow.com/questions/7100976/how-do-i-put-the-image-on-the-right-side-of-the-text-in-a-uibutton</a></p>

<h3>12. duplicate symbol _iToastDuration</h3>

<pre><code>enum iToastDuration {
    iToastDurationLong = 10000,
    iToastDurationShort = 1000,
    iToastDurationNormal = 3000
}iToastDuration;
</code></pre>

<p>A:</p>

<pre><code>typedef enum iToastDuration {
    iToastDurationLong = 10000,
    iToastDurationShort = 1000,
    iToastDurationNormal = 3000
}iToastDuration;
</code></pre>

<h3>13. Detecting taps on attributed text in a UITextView in iOS</h3>

<p>A:</p>

<pre><code>import UIKit
class ViewController: UIViewController, UIGestureRecognizerDelegate {

    @IBOutlet weak var textView: UITextView!

    override func viewDidLoad() {
        super.viewDidLoad()

        // Create an attributed string
        let myString = NSMutableAttributedString(string: "Swift attributed text")

        // Set an attribute on part of the string
        let myRange = NSRange(location: 0, length: 5) // range of "Swift"
        let myCustomAttribute = [ "MyCustomAttributeName": "some value"]
        myString.addAttributes(myCustomAttribute, range: myRange)

        textView.attributedText = myString

        // Add tap gesture recognizer to Text View
        let tap = UITapGestureRecognizer(target: self, action: #selector(myMethodToHandleTap(_:)))
        tap.delegate = self
        textView.addGestureRecognizer(tap)
    }

    func myMethodToHandleTap(sender: UITapGestureRecognizer) {

        let myTextView = sender.view as! UITextView
        let layoutManager = myTextView.layoutManager

        // location of tap in myTextView coordinates and taking the inset into account
        var location = sender.locationInView(myTextView)
        location.x -= myTextView.textContainerInset.left;
        location.y -= myTextView.textContainerInset.top;

        // character index at tap location
        let characterIndex = layoutManager.characterIndexForPoint(location, inTextContainer: myTextView.textContainer, fractionOfDistanceBetweenInsertionPoints: nil)

        // if index is valid then do something.
        if characterIndex &lt; myTextView.textStorage.length {

            // print the character index
            print("character index: \(characterIndex)")

            // print the character at the index
            let myRange = NSRange(location: characterIndex, length: 1)
            let substring = (myTextView.attributedText.string as NSString).substringWithRange(myRange)
            print("character at index: \(substring)")

            // check if the tap location has a certain attribute
            let attributeName = "MyCustomAttributeName"
            let attributeValue = myTextView.attributedText.attribute(attributeName, atIndex: characterIndex, effectiveRange: nil) as? String
            if let value = attributeValue {
               print("You tapped on \(attributeName) and the value is: \(value)")
            }

        }
    }
}
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/19332283/detecting-taps-on-attributed-text-in-a-uitextview-in-ios?rq=1">http://stackoverflow.com/questions/19332283/detecting-taps-on-attributed-text-in-a-uitextview-in-ios?rq=1</a></p>

<h3>14. iOS 开发中如何获取农历？</h3>

<p>A: iOS 8 以后 Apple 内置了农历支持，可以得到类似<strong>2016丙申年五月十七星期二</strong>的信息，如果你只需要这些信息就够了，那使用内置的农历就可以了。如果还想获取类似<strong>壬辰年癸卯月庚辰日</strong>，那可以用<a href="https://github.com/autopear/LunarCalendar">LunarCalendar</a>。</p>

<pre><code>    NSCalendar *chineseCalendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSCalendarIdentifierChinese];

    NSDateFormatter *dateFormatter = [NSDateFormatter new];
    dateFormatter.locale = [NSLocale localeWithLocaleIdentifier:@"zh_Hans_CN"];
    dateFormatter.dateStyle = NSDateFormatterFullStyle;
    dateFormatter.calendar = chineseCalendar;

    NSLog(@"%@", [dateFormatter stringFromDate:[NSDate date]]);

    // Output:2016丙申年五月十七星期二
</code></pre>

<p>Reference:<a href="https://www.quora.com/What-does-Apple-mean-when-it-says-iOS-8-will-include-lunar-calendar-support">https://www.quora.com/What-does-Apple-mean-when-it-says-iOS-8-will-include-lunar-calendar-support</a>
<a href="http://stackoverflow.com/questions/27878696/nscalendaridentifierrepublicofchina-vs-nscalendaridentifierchinese">http://stackoverflow.com/questions/27878696/nscalendaridentifierrepublicofchina-vs-nscalendaridentifierchinese</a></p>

<h3>15. How to fix tableView&rsquo;s tableHeaderView overlap first cell?</h3>

<p>A: The core of solution is when you change the frame of tableHeaderView, you need reassign it to tableView.</p>

<pre><code>    UIView *headerView = self.tableHeaderView;

    [headerView setNeedsLayout];
    [headerView layoutIfNeeded];
    CGFloat height = [headerView systemLayoutSizeFittingSize:UILayoutFittingCompressedSize].height;

    headerView.frame = ({
        CGRect headerFrame = headerView.frame;
        headerFrame.size.height = height;
        headerFrame;
    });

    self.tableHeaderView = headerView;
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/28782319/tableheaderview-on-top-of-first-cell">http://stackoverflow.com/questions/28782319/tableheaderview-on-top-of-first-cell</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（六）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-6.html"/>
    <updated>2016-03-28T20:14:53+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-6</id>
    <content type="html"><![CDATA[<h3>1. The data couldn’t be read because it isn’t in the correct format.</h3>

<p>A:项目是2014年开发的，打包导出 Ad-hoc 时报上面的错误，Build Setting > Enable Bitcode > NO 之后再试成功了。</p>

<p>Reference:<a href="http://stackoverflow.com/questions/33995769/ipatool-fails-to-build-with-bitcode-xcode-7-1-1">http://stackoverflow.com/questions/33995769/ipatool-fails-to-build-with-bitcode-xcode-7-1-1</a></p>

<h3>2.setNeedsLayout vs. setNeedsUpdateConstraints and layoutIfNeeded vs updateConstraintsIfNeeded</h3>

<p>A:</p>

<ul>
<li>If you manipulated constraints directly, call setNeedsLayout.</li>
<li>If you changed some conditions (like offsets or smth) which would change constraints in your overridden updateConstraints method (a recommended way to change constraints, btw), call setNeedsUpdateConstraints, and most of the time, setNeedsLayout after that.</li>
<li>If you need any of the actions above to have immediate effect—e.g. when your need to learn new frame height after a layout pass—append it with a layoutIfNeeded.</li>
</ul>


<p>Reference:<a href="http://stackoverflow.com/questions/20609206/setneedslayout-vs-setneedsupdateconstraints-and-layoutifneeded-vs-updateconstra">http://stackoverflow.com/questions/20609206/setneedslayout-vs-setneedsupdateconstraints-and-layoutifneeded-vs-updateconstra</a></p>

<h3>3.父类如何关联子类通过nib初始化的属性？</h3>

<p>A: Select xib > Show Utilities > Show The Connection In Inspector > + > Connect to View</p>

<!-- more -->


<h3>4. Failed to load test bundle from file</h3>

<pre><code>Failed to load test bundle from file:///Users/dongmeiliang/Library/Developer/Xcode/DerivedData/JSQMessages-axyqhmblkssajpgcyzizcquhltft/Build/Products/Debug-iphonesimulator/JSQMessages.app/PlugIns/JSQMessagesTests.xctest/../JSQMessagesTests.xctest/: Error Domain=NSCocoaErrorDomain Code=4 "The bundle “$(PRODUCT_NAME)” couldn’t be loaded because its executable couldn’t be located." UserInfo={NSLocalizedFailureReason=The bundle’s executable couldn’t be located., NSLocalizedRecoverySuggestion=Try reinstalling the bundle., NSBundlePath=/Users/dongmeiliang/Library/Developer/Xcode/DerivedData/JSQMessages-axyqhmblkssajpgcyzizcquhltft/Build/Products/Debug-iphonesimulator/JSQMessages.app/PlugIns/JSQMessagesTests.xctest, NSLocalizedDescription=The bundle “$(PRODUCT_NAME)” couldn’t be loaded because its executable couldn’t be located.}
</code></pre>

<p>A:Tests target > info.plist > delete the row <code>Bundle name $(PRODUCT_NAME)</code>;</p>

<h3>5. pathForResource:ofType:inDirectory:方法有时找不到图片？</h3>

<p>A:原因是这个方法必须要指定完整的名字，比如图片的名称为fail_indicator@2x.png，放在JSQMessagesAssets.bundle的images目录下，那可以用如下代码来获取这张图片：</p>

<pre><code>+ (NSBundle *)jsq_messagesBundle
{
    return [NSBundle bundleForClass:[JSQMessagesViewController class]];
}

+ (NSBundle *)jsq_messagesAssetBundle
{
    NSString *bundleResourcePath = [NSBundle jsq_messagesBundle].resourcePath;
    NSString *assetPath = [bundleResourcePath stringByAppendingPathComponent:@"JSQMessagesAssets.bundle"];
    return [NSBundle bundleWithPath:assetPath];
}

+ (UIImage *)jsq_imageFromMessagesAssetBundleWithName:(NSString *)name
{
    NSBundle *bundle = [NSBundle jsq_messagesAssetBundle];
    NSString *path = [bundle pathForResource:name ofType:@"png" inDirectory:@"Images"];
    return [UIImage imageWithContentsOfFile:path];
}

[UIImage jsq_imageFromMessagesAssetBundleWithName:@"fail_indicator@2x"];
</code></pre>

<h3>6.自动布局的视图加上遮罩不生效而且视图上UIImageView的图片也不显示了,具体方法如下：</h3>

<pre><code>- (void)jsq_maskView:(UIView *)view withImage:(UIImage *)image
{
    NSParameterAssert(view != nil);
    NSParameterAssert(image != nil);

    UIImageView *imageViewMask = [[UIImageView alloc] initWithImage:image];
    imageViewMask.frame = CGRectInset(view.frame, 2.0f, 2.0f);

    view.layer.mask = imageViewMask.layer;
}
</code></pre>

<p>A:先设置视图的frame。</p>

<h3>7. 设置视图的frame后，视图最终的坐标和设置的坐标不一致</h3>

<p>A:问题的原因是将translatesAutoresizingMaskIntoConstraints设置NO，然后再去设置视图的坐标，这样修改的坐标不会生效，解决办法就是使用坐标是不要将translatesAutoresizingMaskIntoConstraints设置为NO.</p>

<h3>8.设置视图遮罩时，遮罩以宿主视图的origin为原点，所以当宿主视图的origin不是(0, 0)时，设置遮罩的frame时要考虑将宿主视图的origin设置为(0, 0)之后再进行伸缩，最终得到遮罩的frame。</h3>

<p>A:</p>

<pre><code>- (void)jsq_maskView:(UIView *)view withImage:(UIImage *)image
{
    NSParameterAssert(view != nil);
    NSParameterAssert(image != nil);

    CGRect baseFrameForMask = view.frame;
    baseFrameForMask.origin = CGPointZero;

    UIImageView *imageViewMask = [[UIImageView alloc] initWithImage:image];
    imageViewMask.frame = CGRectInset(baseFrameForMask, 2.0f, 2.0f);

    view.layer.mask = imageViewMask.layer;
}
</code></pre>

<h3>9.先调用方法二，然后调用方法一，最终的得到图片并没有水平翻转。</h3>

<pre><code>// 1.
- (UIImage *)jsq_imageMaskedWithColor:(UIColor *)maskColor
{
    NSParameterAssert(maskColor != nil);

    CGRect imageRect = CGRectMake(0.0f, 0.0f, self.size.width, self.size.height);
    UIImage *newImage = nil;

    UIGraphicsBeginImageContextWithOptions(imageRect.size, NO, self.scale);
    {
        CGContextRef context = UIGraphicsGetCurrentContext();

        CGContextScaleCTM(context, 1.0f, -1.0f);
        CGContextTranslateCTM(context, 0.0f, -(imageRect.size.height));

        CGContextClipToMask(context, imageRect, self.CGImage);
        CGContextSetFillColorWithColor(context, maskColor.CGColor);
        CGContextFillRect(context, imageRect);

        newImage = UIGraphicsGetImageFromCurrentImageContext();
    }
    UIGraphicsEndImageContext();

    return newImage;
}

// 2.
+ (UIImage *)imageWithCGImage:(CGImageRef)imageRef
                        scale:(CGFloat)scale
                  orientation:(UIImageOrientation)orientation
</code></pre>

<p>Code Listing:</p>

<pre><code>UIImage *originImage = /* Get origin image*/

UIImage *upMirroredImage = [UIImage imageWithCGImage:originImage.CGImage scale:originImage.scale orientation:UIImageOrientationUpMirrored];

UIImage *upMirroredImageWithMaskedColor = [upMirroredImage jsq_imageMaskedWithColor:[UIColor grayColor]];
</code></pre>

<p>A:调试中发现<code>+ (UIImage *)imageWithCGImage:(CGImageRef)imageRef scale:(CGFloat)scale orientation:(UIImageOrientation)orientation</code> 方法应该没有直接操作图片，而是更改了图片的metadata, 然后<code>- (UIImage *)jsq_imageMaskedWithColor:(UIColor *)maskColor</code>是直接操作图片时没有考虑图片的metadata,于是最终得到是原图加上指定颜色遮罩的图片。</p>

<h3>10. How to determine if an NSDate is today(Prior iOS 8)?</h3>

<p>A:</p>

<pre><code>NSDate *today = nil;
NSDate *beginningOfOtherDate = nil;

NSDate *now = [NSDate date];
[[NSCalendar currentCalendar] rangeOfUnit:NSDayCalendarUnit startDate:&amp;today interval:NULL forDate:now];
[[NSCalendar currentCalendar] rangeOfUnit:NSDayCalendarUnit startDate:&amp;beginningOfOtherDate interval:NULL forDate:otherDate];

if([today compare:beginningOfOtherDate] == NSOrderedSame) {
    //otherDate is a date in the current day
}
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/2331129/how-to-determine-if-an-nsdate-is-today">http://stackoverflow.com/questions/2331129/how-to-determine-if-an-nsdate-is-today</a></p>

<h3>11. How do you resize an image?</h3>

<p>A:</p>

<ul>
<li>UIKit, Core Graphics, and Image I/O all perform well for scaling operations on most images.</li>
<li>Core Image is outperformed for image scaling operations. In fact, it is specifically recommended in the Performance Best Practices section of the Core Image Programming Guide to use Core Graphics or Image I/O functions to crop or downsample images beforehand.</li>
<li>For general image scaling without any additional functionality, UIGraphicsBeginImageContextWithOptions is probably the best option.</li>
<li>If image quality is a consideration, consider using CGBitmapContextCreate in combination with CGContextSetInterpolationQuality.</li>
<li>When scaling images with the intent purpose of displaying thumbnails, CGImageSourceCreateThumbnailAtIndex offers a compelling solution for both rendering and caching.</li>
<li>Unless you’re already working with vImage, the extra work to use the low-level Accelerate framework for resizing doesn’t pay off.</li>
</ul>


<p>Reference:<a href="http://nshipster.com/image-resizing/">http://nshipster.com/image-resizing/</a></p>

<h3>12. How can I deal with this warning: hash mismatch?</h3>

<pre><code>warning: hash mismatch: this object file was built against a different version of the module /Users/dongmeiliang/Library/Developer/Xcode/DerivedData/ModuleCache/1ZNHC044GWHJS/SystemConfiguration-1U17T3939DDG.pcm
</code></pre>

<p>A:Clean > Build
Reference:<a href="http://stackoverflow.com/questions/36467348/how-can-i-deal-with-this-warning-hash-mismatch">http://stackoverflow.com/questions/36467348/how-can-i-deal-with-this-warning-hash-mismatch</a></p>

<h3>13. Cocoa Coding Style Enforcement</h3>

<p>A:<a href="http://emlyn.net/posts/cocoa-coding-style-enforcement/">http://emlyn.net/posts/cocoa-coding-style-enforcement/</a></p>

<h3>14. Importing Swift into Objective-C Within the Same App Target</h3>

<p>A:</p>

<blockquote><p>When you import Swift code into Objective-C, you rely on an Xcode-generated header file to expose those files to Objective-C. This automatically generated file is an Objective-C header that declares the Swift interfaces in your target. It can be thought of as an umbrella header for your Swift code. The name of this header is your product module name followed by adding &ldquo;-Swift.h&rdquo;. (You’ll learn more about the product module name later, in Naming Your Product Module.)</p></blockquote>

<p>在同一个 App Target 中， 导入 Swift 到 Objective-C 只需要 <code>#import "ProductModuleName-Swift.h"</code>, 需要注意 ProductModuleName-Swift.h 是 Xcode 生成的文件，所以在工程中看不到，只需要在用到 Swift 的 Objective-C 文件中引用这个文件就好了。</p>

<p>Reference:<a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html#//apple_ref/doc/uid/TP40014216-CH10-ID138">https://developer.apple.com/library/ios/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html#//apple_ref/doc/uid/TP40014216-CH10-ID138</a></p>

<h3>15. Swift 中对应 Objectie-C 中的class 类方法</h3>

<p>A:</p>

<pre><code>tableView.registerClass(UITableViewCell.self, forCellReuseIdentifier: cellIdentifier)
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Notes Of Using Debian]]></title>
    <link href="http://DamianSheldon.github.io/blog/notes-of-using-debian.html"/>
    <updated>2016-02-29T21:46:20+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/notes-of-using-debian</id>
    <content type="html"><![CDATA[<h3>1. Install pear on Debian</h3>

<p>A:</p>

<pre><code>$ wget http://pear.php.net/go-pear.phar
$ sudo php go-pear.phar

Below is a suggested file layout for your new PEAR installation.  To
change individual locations, type the number in front of the
directory.  Type 'all' to change all of them or simply press Enter to
accept these locations.

 1. Installation base ($prefix)                   : /home/meiliang/pear
 2. Temporary directory for processing            : /tmp/pear/install
 3. Temporary directory for downloads             : /tmp/pear/install
 4. Binaries directory                            : /home/meiliang/pear/bin
 5. PHP code directory ($php_dir)                 : /home/meiliang/pear/share/pear
 6. Documentation directory                       : /home/meiliang/pear/docs
 7. Data directory                                : /home/meiliang/pear/data
 8. User-modifiable configuration files directory : /home/meiliang/pear/cfg
 9. Public Web Files directory                    : /home/meiliang/pear/www
10. System manual pages directory                 : /home/meiliang/pear/man
11. Tests directory                               : /home/meiliang/pear/tests
12. Name of configuration file                    : /home/meiliang/.pearrc

1-12, 'all' or Enter to continue: 1
(Use $prefix as a shortcut for '/home/meiliang/pear', etc.)
Installation base ($prefix) [/home/meiliang/pear] : /usr/local/bin/pear

$ vim .bashrc
# Append the /usr/local/bin/pear directory in the user's home directory onto the PATH environment variable
export PATH=$PATH:/usr/local/bin/pear/bin

// Reload bash configure file
$ source .bashrc

$ echo $PATH
/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/bin/pear/bin

// Check wether it works
$ pear version
PEAR Version: 1.10.1
PHP Version: 5.6.17-0+deb8u1
Zend Engine Version: 2.6.0
Running on: Linux Debian 3.16.0-4-amd64 #1 SMP Debian 3.16.7-ckt11-1 (2015-05-24) x86_64
</code></pre>

<!-- more -->


<h3>2. Install PHP GD extension on Debian</h3>

<p>A:</p>

<pre><code>$ sudo aptitude install php5-gd

// How do I verify that php5-gd support loaded or not?
// Type the following command at a shell prompt:
$ php5 -m | grep -i gd

Sample outputs:

gd
</code></pre>

<p>Reference:<a href="http://www.cyberciti.biz/faq/ubuntu-linux-install-or-add-php-gd-support-to-apache/">http://www.cyberciti.biz/faq/ubuntu-linux-install-or-add-php-gd-support-to-apache/</a></p>

<h3>3. Install PHP cURL extension on Debian</h3>

<p>A:</p>

<pre><code>$ sudo aptitude install php5-curl
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/20073676/how-do-i-install-php-curl-on-linux-debian">http://stackoverflow.com/questions/20073676/how-do-i-install-php-curl-on-linux-debian</a></p>

<h3>4. Install PHP mCrypt extension on Debian</h3>

<p>A:</p>

<pre><code>$ aptitude search mCrypt
p   libmcrypt-dev                                                                    - De-/Encryption Library development files
p   libmcrypt4                                                                       - De-/Encryption Library
p   libtomcrypt-dev                                                                  - static library, header files and documentation for libtomcrypt
p   libtomcrypt0                                                                     - public domain open source cryptographic toolkit
p   mcrypt                                                                           - Replacement for old unix crypt(1)
p   php5-mcrypt                                                                      - MCrypt module for php5

$ sudo aptitude install php5-mcrypt
$ sudo service apache2 restart
</code></pre>

<h3>5. Default installation layouts for Apache HTTPD on Debian</h3>

<p>A:</p>

<pre><code>ServerRoot              ::      /etc/apache2
DocumentRoot            ::      /var/www
Apache Config Files     ::      /etc/apache2/apache2.conf
                        ::      /etc/apache2/ports.conf
Default VHost Config    ::      /etc/apache2/sites-available/default, /etc/apache2/sites-enabled/000-default
Module Locations        ::      /etc/apache2/mods-available, /etc/apache2/mods-enabled
ErrorLog                ::      /var/log/apache2/error.log
AccessLog               ::      /var/log/apache2/access.log
cgi-bin                 ::      /usr/lib/cgi-bin
binaries (apachectl)    ::      /usr/sbin
start/stop              ::      /etc/init.d/apache2 (start|stop|restart|reload|force-reload|start-htcacheclean|stop-htcacheclean)
</code></pre>

<p>Notes:</p>

<ol>
<li>The Debian/Ubuntu layout is fully documented in /usr/share/doc/apache2/README.Debian</li>
<li>Debian/Ubuntu use symlinks to configure vhosts and load modules. Configuration files are created in their respective sites-available and mods-available directories. To activate vhosts and modules, symlinks are created in the respective sites-enabled and mods-enabled directories to the config files in either sites-available and mods-available. Debian provides scripts to handle this process called &lsquo;a2ensite&rsquo; and &lsquo;a2enmod&rsquo; which activates vhosts and modules.</li>
<li>The default vhost is defined in /etc/apache2/sites-available/default, and overrides the DocumentRoot set in the server context.</li>
</ol>


<p>Reference:<a href="http://wiki.apache.org/httpd/DistrosDefaultLayout#Debian.2C_Ubuntu_.28Apache_httpd_2.x.29:">http://wiki.apache.org/httpd/DistrosDefaultLayout#Debian.2C_Ubuntu_.28Apache_httpd_2.x.29:</a></p>

<h3>6. Can&rsquo;t connect to PPTP VPN with ufw enabled on Debian 3.16.7-ckt11-1 with kernel 3.16.0-4-amd64</h3>

<p>A: Allow Port 1723 on UFW</p>

<pre><code># ufw allow 1723
</code></pre>

<p>This is caused by a change for security reason in kernel 3.18 [1]. There are two ways to fix this.</p>

<p>First approach is adding this rule to the file /etc/ufw/before.rules before the line # drop INVALID packets &hellip;</p>

<p>-A ufw-before-input -p 47 -j ACCEPT
Second approach is manually loading the nf_conntrack_pptp module. You can do this by running</p>

<p>sudo modprobe nf_conntrack_pptp
To load this module on every boot on Ubuntu, add it to the file /etc/modules.</p>

<p>Reference:<a href="http://askubuntu.com/questions/572497/cant-connect-to-pptp-vpn-with-ufw-enabled-on-ubuntu-14-04-with-kernel-3-18">http://askubuntu.com/questions/572497/cant-connect-to-pptp-vpn-with-ufw-enabled-on-ubuntu-14-04-with-kernel-3-18</a></p>

<p><a href="http://silverlinux.blogspot.com/2012/05/how-to-pptp-vpn-on-ubuntu-1204-pptpd.html">http://silverlinux.blogspot.com/2012/05/how-to-pptp-vpn-on-ubuntu-1204-pptpd.html</a></p>

<h2>7.OpenVPN server configure correct, but client can&rsquo;t brower web site block by GTW.</h2>

<p>A:There is a crue the the log of VPN client issue client DNS be used. So I think this may be the problem. YES, client can brower all web site after remove all client DNS settings.</p>

<pre><code>192.168.8.1
202.103.96.112
8.8.8.8
208.67.222.222
208.67.220.220
</code></pre>

<p>Reference:<a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-debian-8">https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-debian-8</a>
<a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-ubuntu-14-04#step-5---installing-the-client-profile">https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-ubuntu-14-04#step-5---installing-the-client-profile</a></p>
]]></content>
  </entry>
  
</feed>
