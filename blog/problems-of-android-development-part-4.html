
<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <title>Android 开发问题汇总(四)  | Hello World</title>

        <meta name="author" content="Sheldon"> 
        
        <meta name="description" content="Problems of android development."> <meta name="keywords" content="Android, development">

        <meta name="viewport" content="width=device-width">
        
        
        <link rel="canonical" href="http://DamianSheldon.github.io/blog/problems-of-android-development-part-4.html">

        <link href="/atom.xml" rel="alternate" title="Hello World" type="application/atom+xml">
        <link href="/favicon.png" rel="icon">
        <link href="/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
        
        <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
        <script src="/javascripts/navigation-toggle.js" type="text/javascript"></script>
        
    </head>



<body>
	<header id="header" class="inner"><h1><a href="/">Hello World</a></h1>
<h4>Here's where it all happens for me.</h4>

<!-- Navigation -->

<nav role="navigation">
    <div class="inner">
        <a href="#nav" class="nav-collapse" id="nav-collapse">Navigation</a>
        <ul class="nav" id="nav">
    <li class="active"><a href="/">Blog</a></li>
    <li><a href="/archives">Archive</a></li>
    <li><a href="/ios-development">iOS</a></li>
    <li><a href="/android">Android</a></li>
    <li><a href="/web-development">Web</a></li>
    <li><a href="/english">English</a></li>
    <li><a href="/about">About</a></li>
    
    <form action="https://www.bing.com/search" method="get" accept-charset="utf-8" target="_blank">
        <input type="text" name="q" maxlength="255" placeholder="Search">
        <input type="hidden" name="q1" value="site:DamianSheldon.github.io">
    </form>
</ul>
    </div>
</nav>

<a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a>
</header>

	<div id="content" class="inner"><article class="post">
	<h2 class="title">Android 开发问题汇总(四)</h2>
        
    <div class="meta">
	   <div class="date">









  



<time datetime="2017-05-14T16:56:19+08:00" pubdate data-updated="true">14 May 2017</time></div>
	   

<div class="tags">

	<a class='category' href='/blog/categories/android/'>android</a>, <a class='category' href='/blog/categories/archives/'>archives</a>

</div>


    </div>
    
	<div class="entry-content"><h3>1.怎么给 Button 加上圆角?</h3>

<p>A:Create an xml inside Drawable Folder with below code. Name it rounded_red_border.xml</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="utf-8"?&gt;
</span><span class='line'>&lt;shape xmlns:android="http://schemas.android.com/apk/res/android"
</span><span class='line'>    android:shape="rectangle"&gt;
</span><span class='line'> 
</span><span class='line'>// The width and color of the border   
</span><span class='line'> &lt;stroke
</span><span class='line'>        android:width="4dp"
</span><span class='line'>        android:color="#de3d3d" /&gt;
</span><span class='line'> 
</span><span class='line'>// The desired corner radius. reduce it to keep it less rounded
</span><span class='line'>    &lt;corners android:radius="360dp" /&gt;
</span><span class='line'> 
</span><span class='line'>// Add your desired padding
</span><span class='line'>    &lt;padding
</span><span class='line'>        android:left="20dp"
</span><span class='line'>        android:top="10dp"
</span><span class='line'>        android:right="20dp"
</span><span class='line'>        android:bottom="10dp"    &gt;
</span><span class='line'>    &lt;/padding&gt;
</span><span class='line'> 
</span><span class='line'>&lt;/shape&gt;</span></code></pre></td></tr></table></div></figure>


<p>Applying the border to a Layout or View</p>

<p>Set the above drawable as a background to your Layout or View like LinearLayout, FrameLayout, TextView, Button etc.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="utf-8"?&gt;
</span><span class='line'>&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
</span><span class='line'>android:layout_width="match_parent"
</span><span class='line'>android:layout_height="match_parent"&gt;
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>// Apply as the background of TextView
</span><span class='line'>&lt;TextView
</span><span class='line'>    android:layout_width="wrap_content"
</span><span class='line'>    android:layout_height="wrap_content"
</span><span class='line'>    android:text="YOUR TEXT"
</span><span class='line'>    android:textSize="20dp"
</span><span class='line'>    android:textStyle="bold"
</span><span class='line'>    android:background="@drawable/rounded_red_border"
</span><span class='line'>    android:textColor="#000"
</span><span class='line'>    android:layout_centerInParent="true"/&gt;
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>&lt;/RelativeLayout&gt;</span></code></pre></td></tr></table></div></figure>


<!--more-->


<p>Reference:<a href="http://www.gadgetsaint.com/tips/rounded-corners-views-layouts-android/#.WRgR3FOGORt">Add Rounded Corners to Views and Layouts Android</a></p>

<h3>2.Error:All flavors must now belong to a named flavor dimension.</h3>

<p>A:在主app的build.gradle里面的</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> defaultConfig {
</span><span class='line'>     targetSdkVersion：***
</span><span class='line'>  minSdkVersion ：***
</span><span class='line'>  versionCode：***
</span><span class='line'>     versionName ：***
</span><span class='line'>  // 版本名后面添加一句话，意思就是flavor dimension
</span><span class='line'>  // 它的维度就是该版本号，这样维度就是都是统一的了
</span><span class='line'>  flavorDimensions "versionCode"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="https://blog.csdn.net/SYIF88/article/details/75009663">解决Error:All flavors must now belong to a named flavor dimension.</a></p>

<h3>3.error: resource android:attr/fontVariationSettings not found.</h3>

<p>A:This is caused by an incompatibility with the android support library that changed to version 28 in the last day or so. Add follow contents to build.gradle:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>configurations.all {
</span><span class='line'>    resolutionStrategy {
</span><span class='line'>        force 'com.android.support:support-v4:27.1.0'
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="https://github.com/crosswalk-project/cordova-plugin-crosswalk-webview/issues/205#issuecomment-371669478">Problem Isolated - Need Solution</a></p>

<h3>4.Application error. The connection to the server was unsuccessful</h3>

<p>A:Add the next line into the config.xml in side the tag.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;preference name="loadUrlTimeoutValue" value="700000" /&gt;</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="https://forum.ionicframework.com/t/application-error-the-connection-to-the-server-was-unsuccessful/67584/3">Application error. The connection to the server was unsuccessful</a></p>

<h3>5.How to get SQLite database from Android real device?</h3>

<p>A:Device File Explorer can archive this goal. We can open it this way:</p>

<p>View -> Tool Windows -> Device File Explorer</p>

<p>Once you have Device File Explorer window open, use your mouse to navigate to the following path:</p>

<p>data -> data -> your.package.name -> databases</p>

<p>Inside the databases folder you should see the database you want to explore, do a right click and Save As&hellip; select your desired computer destination folder.</p>

<p>Reference:<a href="https://stackoverflow.com/questions/21062187/get-sqlite-database-from-android-app">Get SQLite database from Android app</a></p>

<h3>6.AAPT: error: file failed to compile</h3>

<p>A:一个旧的工程编译报错，错误和 nine-patch 图片资源相关，详细的错误为:AAPT: error: file failed to compile，搜索了一圈没找到有效的解决办法。既然错误是和 aapt 相关，于是尝试使用 Android Studio 的命令行工具 aapt 来输出更多错误信息。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ /Users/meiliang/Library/Android/sdk/build-tools/28.0.3/aapt2 compile ~/Documents/AndroidProjects/LocationAware/app/src/main/res/drawable-mdpi/button_on.9.png -o /tmp/compiled/ -v
</span><span class='line'>/Users/meiliang/Documents/AndroidProjects/LocationAware/app/src/main/res/drawable-mdpi/button_on.9.png: note: compiling PNG.
</span><span class='line'>error: found an invalid color.</span></code></pre></td></tr></table></div></figure>


<p>得到了无效的颜色的错误信息，但还是不知道如何解决。只能继续啃 Android Studio 用户指南的<a href="https://developer.android.google.cn/studio/write/draw9patch?hl=en">Create resizable bitmaps (9-Patch files)</a>, 及从中引申出来的 <a href="https://developer.android.google.cn/guide/topics/graphics/drawables#nine-patch">NinePatch drawables</a> ,看完之后对 nine-patch 有了进一步的认识，但是还是不知道如何创建，先尝试用 GIMP 来设置可以拉伸区域，失败了，于是上 Google 搜索相关视频教程，原来是拖动来设置拉伸区域而不是官方文档上面的点击，难怪点击一直没有效果，设置好拉伸区域后就能成功编译了。</p>

<h3>7.Android 工程设置 <code>svn:global-ignores, svn:ignore</code></h3>

<p>A:公司是使用 svn 来管理源代码，所以需要为 android 工程设置 svn ignore 规则。 svn 主要通过 <code>svn:global-ignores, svn:ignore</code> 来设置忽略规则。global-ignores 从名称可以看出它是全局相关的，ignore 则是和特定代码库相关的。</p>

<p>svn 的 ignore 规则是面向文件的，所以 global-ignores 可以忽略整个目录，但如果想忽略目录中部分文件则需要设置 ignore，例如可以配置 global-ignores 它可以忽略 <code>.idea</code> 目录，但如果想忽略 <code>.idea</code> 目录中部分文件则需要设置 ignore。个人觉得它不如 git ignore 方便。 下面我们参考 github 的 Android.gitignore 来为工程设置 svn global-ignores, ignore。</p>

<p>主要是使用 <code>$svn propedit svn:global-ignores .</code> 和 <code>$ svn propedit svn:ignore .idea</code>。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$svn propedit svn:global-ignores .
</span><span class='line'># Built application files
</span><span class='line'>*.apk
</span><span class='line'>*.aar
</span><span class='line'>*.ap_
</span><span class='line'>*.aab
</span><span class='line'>
</span><span class='line'># Files for the ART/Dalvik VM
</span><span class='line'>*.dex
</span><span class='line'>
</span><span class='line'># Java class files
</span><span class='line'>*.dex
</span><span class='line'>
</span><span class='line'># Generated files
</span><span class='line'>bin
</span><span class='line'>gen
</span><span class='line'>out
</span><span class='line'>release
</span><span class='line'>
</span><span class='line'># Gradle files
</span><span class='line'>.gradle
</span><span class='line'>build
</span><span class='line'>
</span><span class='line'># Local configuration file (sdk path, etc)
</span><span class='line'>local.properties
</span><span class='line'>
</span><span class='line'># Proguard folder generated by Eclipse
</span><span class='line'>proguard
</span><span class='line'>
</span><span class='line'># Log Files
</span><span class='line'>*.log
</span><span class='line'>
</span><span class='line'># Android Studio Navigation editor temp files
</span><span class='line'>.navigation
</span><span class='line'>
</span><span class='line'># Android Studio captures folder
</span><span class='line'>captures
</span><span class='line'>
</span><span class='line'># IntelliJ
</span><span class='line'>*.iml
</span><span class='line'>
</span><span class='line'># Keystore files
</span><span class='line'># Uncomment the following lines if you do not want to check your keystore files in.
</span><span class='line'>*.jks
</span><span class='line'>*.keystore
</span><span class='line'>
</span><span class='line'># External native build folder generated in Android Studio 2.2 and later
</span><span class='line'>.externalNativeBuild
</span><span class='line'>.cxx
</span><span class='line'>
</span><span class='line'># Version control
</span><span class='line'>vcs.xml
</span><span class='line'>
</span><span class='line'>$ svn propedit svn:ignore .idea
</span><span class='line'>workspace.xml
</span><span class='line'>tasks.xml
</span><span class='line'>gradle.xml
</span><span class='line'>assetWizardSettings.xml
</span><span class='line'>dictionaries
</span><span class='line'>libraries
</span><span class='line'># Android Studio 3 in .gitignore file.
</span><span class='line'>caches
</span><span class='line'>modules.xml
</span><span class='line'># Comment next line if keeping position of elements in Navigation Editor is relevant for you
</span><span class='line'>navEditor.xml</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Reference: <a href="http://svnbook.red-bean.com/en/1.8/svn.advanced.props.special.ignore.html">Ignoring Unversioned Items</a></li>
</ul>


<h3>8.<code>.aidl</code> 文件的目标位置</h3>

<p>A:当我们使用 AIDL 调用方法时需要包含 <code>.aidl</code> 文件，官方文档上是说 <code>Include the .aidl file in the project src/ directory.</code> 我实际测试下来发现要包含在 <code>src/main/</code> 目录下才会生效。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ls app/src/main/
</span><span class='line'>AndroidManifest.xml        assets/                    ic_launcher-playstore.png  libs/
</span><span class='line'>aidl/                      com/                       java/                      res/</span></code></pre></td></tr></table></div></figure>


<h3>9.Activity did not call finish() prior to onResume() completing</h3>

<p>A:It was workaround by using Theme.Translucent instead of Theme.NoDisplay in the manifest.</p>

<p>Reference:</p>

<ul>
<li><a href="https://stackoverflow.com/questions/32169303/activity-did-not-call-finish-api-23">Activity did not call finish? (API 23)</a></li>
<li><a href="https://web.archive.org/web/20151116170752/https://code.google.com/p/android-developer-preview/issues/detail?id=2353">Activity crash with @android:style/Theme.NoDisplay</a></li>
</ul>


<h3>10.DownLoadManager failed with ERROR_UNKOWN</h3>

<p>A:First check your url, http schema is disable by default on API level 27 or higher. If this is your case, you can change to https schema or enable http via <a href="https://developer.android.google.cn/training/articles/security-config?hl=en#CleartextTrafficPermitted">network security configuration</a>.</p>

<p>Second, you can find clue in logcat, remind change it to No Filter, search with DownLoadManager, I find file permission exception from here.</p>

<h3>11.Logcat to file</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$adb shell
</span><span class='line'>$logcat -b main,system,crash -f /mnt/sdcard/logs/logcat.log -r 32 -n 65535 &</span></code></pre></td></tr></table></div></figure>


<h3>12.将 ionic 的 android 工程单独提交到 svn 仓库</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir RAWApp
</span><span class='line'>$ svn import RAWApp http://url/svn/jwt_v3/ydjwv3/trunk/working/projects/client/cssj/RAWApp 
</span><span class='line'>$ rm -rf RAWApp
</span><span class='line'>$ svn checkout http://url/svn/jwt_v3/ydjwv3/trunk/working/projects/client/cssj/RAWApp
</span><span class='line'>$ rsync -avuz platforms/android/ RAWApp
</span><span class='line'>$ cd RAWApp
</span><span class='line'>$ svn add --force .
</span><span class='line'>$ svn commit</span></code></pre></td></tr></table></div></figure>



</div>


        
</article>

	<div class="share">
	<div>
	
	
	
    
    
        

    
    
	</div>
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2014 - 2022

    Sheldon

<br>
<p>Powered by <a href="http://octopress.org">Octopress</p>
</footer>
	



<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-52345084-1');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->




</body>
</html>
