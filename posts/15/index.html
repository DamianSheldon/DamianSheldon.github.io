
<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <title>Here's where it all happens for me.  | Hello World</title>

        <meta name="author" content="Sheldon"> 
        
        <meta name="description" content="Sheldon's personal technology blog about iOS, Android, Back-end, Web and English."> <meta name="keywords" content="iOS, Objective-C, Swift, Xcode, Java, Android Studio, Eclipse, Web, HTML, Javascript, CSS, PHP, English">

        <meta name="viewport" content="width=device-width">
        
        
        <link rel="canonical" href="http://DamianSheldon.github.io/posts/15/index.html">

        <link href="/atom.xml" rel="alternate" title="Hello World" type="application/atom+xml">
        <link href="/favicon.png" rel="icon">
        <link href="/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
        
        <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
        <script src="/javascripts/navigation-toggle.js" type="text/javascript"></script>
        
    </head>



<body>
	<header id="header" class="inner"><h1><a href="/">Hello World</a></h1>
<h4>Here's where it all happens for me.</h4>

<!-- Navigation -->

<nav role="navigation">
    <div class="inner">
        <a href="#nav" class="nav-collapse" id="nav-collapse">Navigation</a>
        <ul class="nav" id="nav">
    <li class="active"><a href="/">Blog</a></li>
    <li><a href="/archives">Archive</a></li>
    <li><a href="/ios-development">iOS</a></li>
    <li><a href="/android">Android</a></li>
    <li><a href="/web-development">Web</a></li>
    <li><a href="/english">English</a></li>
    <li><a href="/about">About</a></li>
    
    <form action="https://www.bing.com/search" method="get" accept-charset="utf-8" target="_blank">
        <input type="text" name="q" maxlength="255" placeholder="Search">
        <input type="hidden" name="q1" value="site:DamianSheldon.github.io">
    </form>
</ul>
    </div>
</nav>

<a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a>
</header>

	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/capturing-android-physic-device-traffic-on-tcpdump.html">
		
			Android 真机抓包</a>
	</h2>
        
    <div class="meta">
	   <div class="date">









  



<time datetime="2017-03-11T17:04:33+08:00" pubdate data-updated="true">11 Mar 2017</time></div>
	   

<div class="tags">

	<a class='category' href='/blog/categories/android/'>android</a>, <a class='category' href='/blog/categories/archives/'>archives</a>

</div>


    </div>
        
	<div class="entry-content">
		<p>在 Android 开发过程中，可能会遇到和服务端交互有问题的情况，这时候就得拿出证据来和服务端撕逼, 而最有力的证据自然是抓取的网络数据包；又或者是遇到很诡异的网络问题，这时候就可以借助抓包来分析和定位问题。</p>

<p>如果我们和服务端的交互没有通过 VPN, 而且也不是视频流这种网络性能要求苛刻的情况，我们可以通过 tPacketCapture 这种应用来抓包；</p>

<p>其他情况我们可以通过 root 手机，然后安装 tcpdump 来抓包。</p>

<p>下面我们详细介绍下 通过 tcpdump 抓包这种方法：</p>

<ul>
<li>Root 手机</li>
</ul>


<p>Root 手机的原理是利用系统存在的漏洞来获得 root 权限，<a href="https://forum.xda-developers.com/">XDA Developers</a> 上有不少 root 工具，很多手机都可以用它们 root。</p>

<ul>
<li>安装 tcpdump</li>
</ul>


<p>可以到网上搜索为 Android 编译好的 tcpdump 二进制包，例如<a href="http://www.strazzere.com/android/tcpdump">这里</a>就有一个。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Copy tcpdump to device
</span><span class='line'>$ adb -d push /path/to/tcpdump /sdcard/tcpdump
</span><span class='line'>
</span><span class='line'>// Device shell
</span><span class='line'>$ adb -d shell
</span><span class='line'>
</span><span class='line'>// Switch to root
</span><span class='line'>$ su
</span><span class='line'>
</span><span class='line'>// Copy tcpdump to /data/local/
</span><span class='line'># cat /sdcard/tcpdump /data/local/tcpdump</span></code></pre></td></tr></table></div></figure>



		
		<a href="/blog/capturing-android-physic-device-traffic-on-tcpdump.html" class="more-link">继续阅读</a>
	</div>


        
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/how-to-set-up-a-postfix-e-mail-server-with-dovecot.html">
		
			如何搭建一个带 Dovecot 的 Postfix 邮件服务器</a>
	</h2>
        
    <div class="meta">
	   <div class="date">









  



<time datetime="2017-02-15T16:29:42+08:00" pubdate data-updated="true">15 Feb 2017</time></div>
	   

<div class="tags">

	<a class='category' href='/blog/categories/archivies/'>archivies</a>

</div>


    </div>
        
	<div class="entry-content">
		<p>作为一个软件开发人员，我们可能需要一个自己的 VPS ，在上面可以跑我们的 side project，或者做一些实验。VPS 在运行过程中可能会遇到问题，这时我们可能希望在发生问题时能收到通知。使用邮件通知是个不错的方式，这样我们的服务挂掉了能及时处理，所以学会搭建邮件服务器还是很有价值。另外我一直觉得软件技术人员有个自己域名的邮箱很酷，所以我决定自己动手搭建一个邮件服务器。本文记录了如何搭建一个自己域名的邮件服务器，并让这个邮箱可以通过 Mac 和 iPhone 自由收发邮件(测试过 sina 和 QQ)。</p>

<h2>邮件系统是怎么工作</h2>

<p>开始之前我觉得有必要了解下邮件系统是怎么工作的，鸟哥在他的博文：<a href="http://linux.vbird.org/linux_server/0380mail.php">第二十二章、郵件伺服器： Postfix</a>作了很详细的介绍，建议熟读之后再开始。</p>

<h2>准备材料</h2>

<ul>
<li>VPS</li>
<li>域名</li>
</ul>


<p>我服务器跑的是 CentOS 8。</p>


		
		<a href="/blog/how-to-set-up-a-postfix-e-mail-server-with-dovecot.html" class="more-link">继续阅读</a>
	</div>


        
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/photos-framework-usage.html">
		
			Photos 框架的基本使用</a>
	</h2>
        
    <div class="meta">
	   <div class="date">









  



<time datetime="2016-12-23T14:23:33+08:00" pubdate data-updated="true">23 Dec 2016</time></div>
	   

<div class="tags">

	<a class='category' href='/blog/categories/archives/'>archives</a>, <a class='category' href='/blog/categories/ios-development/'>ios development</a>

</div>


    </div>
        
	<div class="entry-content">
		<p>从 iOS 9 开始 Apple 把 Asset Library 标记为废弃状态，并建议开发者使用 Photos 框架。</p>

<blockquote><p>The Assets Library framework is deprecated as of iOS 9.0. Instead, use the Photos framework instead, which in iOS 8.0 and later provides more features and better performance for working with a user’s photo library.</p></blockquote>

<p>不幸的是 Apple 并没有发布相关的使用指导文档，只有一个相关 Demo。使用的时候固然可以回头参考这个 Demo，但这样的效率不是很高，很多概念也容易忘记，所以这里做个简单的总结。</p>

<p>Photos 中有不少类，其中几个犹为关键。PHPhotoLibary 是我们操作 Photo Library 里面资源的入口对象，所有的操作都通过它完成。PHCollectionList 表示相册中的专题列表；PHAssetCollection 表示专题；PHAsset 表示资源，如 images, videos, and Live Photos.</p>

<p>我们基本的需求就是 CRUD, 这些操作是需要用户授权的，记得先获取权限再操作， 下面我们展示相关的代码片段。</p>

<h3>Create</h3>

<ol>
<li>创建一个资源</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PHPhotoLibrary.shared().performChanges({
</span><span class='line'>            PHAssetChangeRequest.creationRequestForAsset(from: image)
</span><span class='line'>        }, completionHandler: {success, error in
</span><span class='line'>            if !success { print("error creating asset: \(error)") }
</span><span class='line'>        })</span></code></pre></td></tr></table></div></figure>


<ol>
<li>创建一个资源到指定的专题</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PHPhotoLibrary.shared().performChanges({
</span><span class='line'>            let creationRequest = PHAssetChangeRequest.creationRequestForAsset(from: image)
</span><span class='line'>            if let assetCollection = self.assetCollection {
</span><span class='line'>            let addAssetRequest = PHAssetCollectionChangeRequest(for: assetCollection)
</span><span class='line'>            addAssetRequest?.addAssets([creationRequest.placeholderForCreatedAsset!] as NSArray)
</span><span class='line'>            }
</span><span class='line'>        }, completionHandler: {success, error in
</span><span class='line'>            if !success { print("error creating asset: \(error)") }
</span><span class='line'>        })</span></code></pre></td></tr></table></div></figure>



		
		<a href="/blog/photos-framework-usage.html" class="more-link">继续阅读</a>
	</div>


        
</article>


<nav id="pagenavi">
    
        <a href="/posts/14" class="prev">Prev</a>
    
    
        <a href="/posts/16" class="next">Next</a>
    
    
</nav>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2014 - 2022

    Sheldon

<br>
<p>Powered by <a href="http://octopress.org">Octopress</p>
</footer>
	



<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-52345084-1');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->




</body>
</html>
