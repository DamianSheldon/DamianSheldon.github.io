<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: ios development | Hello World]]></title>
  <link href="http://DamianSheldon.github.io/blog/categories/ios-development/atom.xml" rel="self"/>
  <link href="http://DamianSheldon.github.io/"/>
  <updated>2016-08-16T10:29:46+08:00</updated>
  <id>http://DamianSheldon.github.io/</id>
  <author>
    <name><![CDATA[Sheldon]]></name>
    <email><![CDATA[dongmeilianghy@sina.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（八）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-8.html"/>
    <updated>2016-06-24T15:54:30+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-8</id>
    <content type="html"><![CDATA[<h3>1.Detect hash tags #, mention tags @, in iOS like in Twitter App</h3>

<p>A:You can use <a href="https://github.com/Krelborn/KILabel">https://github.com/Krelborn/KILabel</a> this library. It also detect user taps on hashtags Like this:</p>

<pre><code>label.hashtagLinkTapHandler = ^(KILabel *label, NSString *string, NSRange range) {
  NSLog(@"Hashtag tapped %@", string);
};
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/24359972/detect-hash-tags-mention-tags-in-ios-like-in-twitter-app">http://stackoverflow.com/questions/24359972/detect-hash-tags-mention-tags-in-ios-like-in-twitter-app</a></p>

<h3>2.如何给应用重签名？</h3>

<p>A：利用用途广泛的命令行工具 security快速地显示出你的系统中能用来对代码进行签名的认证的方法：</p>

<pre><code>$ security find-identity -v -p codesigning                       
  1) 01C8E9712E9632E6D84EC533827B4478938A3B15 "iPhone Developer: Thomas Kollbach (7TPNXN7G6K)"
</code></pre>

<p>用<a href="https://github.com/fastlane/fastlane/tree/master/sigh">sign</a>给应用重签名</p>

<pre><code>$ sigh resign ./path/app.ipa --signing_identity "iPhone Distribution: Felix Krause" -p "my.mobileprovision"
</code></pre>

<p>Reference:<a href="http://objccn.io/issue-17-2/">http://objccn.io/issue-17-2/</a></p>

<!--more-->


<h3>3. It report BAD_ACCESS when set delegate for AVAudioPlayer.</h3>

<p>A: The reason is I instance AVAuidoPlayer without content like this:</p>

<pre><code>AVAudioPlayer *audioPlayer = [AVAudioPlayer new];
audioPlayer.delegate = self;
</code></pre>

<p>We should instance it with content:</p>

<pre><code>_audioPlayer = [[AVAudioPlayer alloc] initWithData:_audioData error:nil];
[_audioPlayer prepareToPlay];
_audioPlayer.delegate = self;
</code></pre>

<h3>4.  How can I show my own app icon at the bottom-left corner of iPhone lock screen?</h3>

<p>Solution: 1. This is iOS 8 new feature called Handoff more info <a href="http://www.macrumors.com/2014/06/03/ios-8-apps-quick-access/">here</a>.</p>

<ol>
<li>You can&rsquo;t control what app appears in the bottom-left corner of the lock screen. Neither can you add code to your app to make your app appear there whenever you want. These are called Suggested Apps and it&rsquo;s a feature of iOS.</li>
</ol>


<p>iOS controls what app appears there based on several factors, including your location, the apps on your device, and your history of where &amp; when you use those apps. Together, iOS trys to present you with the app you would most-likely use at a given time, location, and history.</p>

<p>If you don&rsquo;t like this feature, it can be turned off in Settings -> General -> Handoff &amp; Suggested Apps.</p>

<p>Reference:<a href="http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen">http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen</a></p>

<p><a href="http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen">http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen</a></p>

<h3>5.</h3>

<pre><code> Class AJXorEncryptor is implemented in both /Users/dongmeiliang/Library/Developer/CoreSimulator/Devices/71988A60-BE7B-425A-BDE4-AAE4D098A516/data/Containers/Bundle/Application/051ED3F9-A920-41C8-9D96-41EED06DE618/AJFrameDevApp.app/AJFrameDevApp and /Users/dongmeiliang/Library/Developer/Xcode/DerivedData/AJFrameDevApp-fwmhocnqvmbmzkftzzdryfyigyzs/Build/Products/Debug-iphonesimulator/AJFrameDevApp.app/PlugIns/AJFrameDevAppTests.xctest/AJFrameDevAppTests. One of the two will be used. Which one is undefined.
</code></pre>

<p> A:问题的原因是AJFrameDevApp和AJFrameDevAppTests这两个target都链接了一个相同的静态库。
 于是我将Podfile的内容由</p>

<pre><code>target 'AJFrameDevApp' do
    pod 'AJFrame', :path =&gt; '../'
end

target 'AJFrameDevAppTests' do
    pod 'AJFrame', :path =&gt; '../'
end
</code></pre>

<p>改为：</p>

<pre><code>target 'AJFrameDevApp' do
    pod 'AJFrame', :path =&gt; '../'

    target 'AJFrameDevAppTests' do
        inherit! :search_paths

    end
end
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/30581884/class-is-implemented-in-both-one-of-the-two-will-be-used/30582486">http://stackoverflow.com/questions/30581884/class-is-implemented-in-both-one-of-the-two-will-be-used/30582486</a></p>

<h3>6. 如何调用私有类的私有方法？真实的场景是开发了一个库，库中A持有一个私有类的属性，那么如何对私有类进行相应的单元测试呢？</h3>

<p>A：Objective-C的runtime可以帮我们做到，</p>

<pre><code>#include &lt;objc/message.h&gt;

NSString *originalString = @"testEncryptMethod";

NSData *originalData = [originalString dataUsingEncoding:NSUTF8StringEncoding];

AJBinaryChannel *binaryChannel = [AJBinaryChannel new];
binaryChannel.encryptKey = @"xorkey";

id wrapperEncryptor = (id)(binaryChannel.encryptor);

typedef NSData* (*send_type)(id, SEL, id);

send_type func = (send_type)objc_msgSend;

NSData *encryptData = func(wrapperEncryptor, @selector(encrypt:), originalData);

NSString *encryptString = [[NSString alloc] initWithData:encryptData encoding:NSUTF8StringEncoding];

XCTAssertNotEqualObjects(originalString, encryptString);

NSData *decryptData = func(wrapperEncryptor, @selector(decrypt:), encryptData);

NSString *decryptString = [[NSString alloc] initWithData:decryptData encoding:NSUTF8StringEncoding];

XCTAssertEqualObjects(originalString, decryptString);
</code></pre>

<h3>7.Too many arguments to function call, expected 0, have 3</h3>

<p>A:The answer is you need to strong type objc_msgSend for the compiler to build it:</p>

<pre><code>typedef void (*send_type)(void*, SEL, void*);
send_type func = (send_type)objc_msgSend;
func(anItem.callback_object, NSSelectorFromString(anItem.selector), dict);
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/24922913/too-many-arguments-to-function-call-expected-0-have-3">http://stackoverflow.com/questions/24922913/too-many-arguments-to-function-call-expected-0-have-3</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（七）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-7.html"/>
    <updated>2016-05-03T17:00:04+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-7</id>
    <content type="html"><![CDATA[<h3>1.如何设置透明的导航栏并且去掉其底部灰色的分隔线？</h3>

<p>A:可以通过设置导航栏的背景图和阴隐图为透明的图片来实现。</p>

<pre><code>- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];

    self.translucent = self.navigationController.navigationBar.isTranslucent;
    self.navigationController.navigationBar.translucent = YES;

    self.previousImage = [self.navigationController.navigationBar backgroundImageForBarMetrics:UIBarMetricsDefault];

    UIImage *newImage = [UIImage imageNamed:@"TransparentPixel"];
    [self.navigationController.navigationBar setBackgroundImage:newImage forBarMetrics:UIBarMetricsDefault];

    self.previousShadowImage = self.navigationController.navigationBar.shadowImage;
    self.navigationController.navigationBar.shadowImage = newImage;
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];

    self.navigationController.navigationBar.translucent = self.translucent;

    [self.navigationController.navigationBar setBackgroundImage:self.previousImage forBarMetrics:UIBarMetricsDefault];
    self.navigationController.navigationBar.shadowImage = self.previousShadowImage;
}
</code></pre>

<p>Reference:Apple&rsquo;s sample code Customizing UINavigationBar<br/>
<a href="http://stackoverflow.com/questions/18921082/separator-between-navigation-bar-and-view-ios-7">http://stackoverflow.com/questions/18921082/separator-between-navigation-bar-and-view-ios-7</a></p>

<!-- more -->


<h3>2. 自定义的View设置cornerRadius不生效</h3>

<h3>3. CocoaPods 升级到1.0，Xcode 一直报 header file not found.</h3>

<p>A: 仔细查看了 Xcode 的编译过程，头文件的路径是包含了的，于是怀疑是Xcode的自身可能存在问题。经过实验，可以用下面的方法解决：</p>

<ol>
<li>Clean project</li>
<li>Window > Projects > Your Project > Delete Derived Data</li>
<li>Build</li>
</ol>


<h3>4. No codesigning identities (i.e. certificate and private key pairs) that match the team ID: xxx</h3>

<p>A:</p>

<ul>
<li>Go to Xcode preferences, view details of the Apple ID, and delete the provisioning file that&rsquo;s complaining, redownload.</li>
<li>Go to the Keychain Access, and delete the development certificate that&rsquo;s related to the provisioning file you just deleted.</li>
</ul>


<p>Reference:<a href="http://stackoverflow.com/questions/19197497/ios-7-0-no-code-signing-identities-found">http://stackoverflow.com/questions/19197497/ios-7-0-no-code-signing-identities-found</a></p>

<h3>5. How to load image from CocoaPods resource bundle ?</h3>

<p>A:</p>

<pre><code>  s.resource_bundles = {
    'DMLSelector' =&gt; ['DMLSelector/Assets/*.png']
  }

  NSBundle *bundle = [NSBundle bundleForClass:[self class]];
  self.imageView.image = [UIImage imageNamed:@"DMLSelector.bundle/Checked" inBundle:bundle compatibleWithTraitCollection:nil];
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/23835052/load-image-from-cocoapods-resource-bundle">http://stackoverflow.com/questions/23835052/load-image-from-cocoapods-resource-bundle</a></p>

<h3>6. How to specify NSLineBreakMode in boundingRectWithSize?</h3>

<p>A: Use NSParagraphStyleAttributeName &amp; NSParagraphStyle:</p>

<pre><code>NSMutableParagraphStyle *paragraph = [[NSMutableParagraphStyle alloc] init];
paragraph.lineBreakMode = NSLineBreakByWordWrapping; //e.g.

CGSize size = [label.text boundingRectWithSize: constrainedSize options:NSStringDrawingUsesLineFragmentOrigin attributes: @{ NSFontAttributeName: label.font, NSParagraphStyleAttributeName: paragraph } context: nil].size;
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/20631464/how-to-specify-nslinebreakmode-in-boundingrectwithsize">http://stackoverflow.com/questions/20631464/how-to-specify-nslinebreakmode-in-boundingrectwithsize</a></p>

<h3>7.</h3>

<pre><code>INFO [2016-06-01 15:42:30.78]: ---------------------------------------------------------------------
INFO [2016-06-01 15:42:30.78]: --- Step: fir p ../BBCApp.ipa -T token ---
INFO [2016-06-01 15:42:30.78]: ---------------------------------------------------------------------
INFO [2016-06-01 15:42:30.78]: $ fir p ../BBCApp.ipa -T c977500277789d01cc67d82750057858
INFO [2016-06-01 15:42:34.31]: ▸ /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/dependency.rb:296:in `to_specs': Could not find 'fir-cli' (&gt;= 0) among 206 total gem(s) (Gem::LoadError)
INFO [2016-06-01 15:42:34.31]: ▸ from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/dependency.rb:307:in `to_spec'
INFO [2016-06-01 15:42:34.31]: ▸ from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_gem.rb:47:in `gem'
INFO [2016-06-01 15:42:34.31]: ▸ from /usr/local/bin/fir:22:in `&lt;main&gt;'
</code></pre>

<p>A: 问题的原因是找不到fir这个命令，可以直接指定绝对路径解决。</p>

<pre><code>sh "/Library/Ruby/Gems/2.0.0/gems/fir-cli-1.5.0/bin/fir p ../BBCApp.ipa -T token"
</code></pre>

<h3>8. 怎么获取iPhone上已安装App的ipa文件？</h3>

<p>A: 可以利用iTunes下载已购的功能。</p>

<p>You can redownload apps on your iPhone or iPod touch, iPad, Mac or PC, or Apple TV (4th generation). You can also redownload some in-app purchases.</p>

<p>On a Mac or PC
From iTunes
1. Open iTunes.
2. Click Sign In, and then enter your Apple ID and password.
3. Click your name and select Purchased from the menu.
4. From the upper-right corner of the screen, click Apps.
5. Click &ldquo;Not in My Library&rdquo; to view purchased content that isn&rsquo;t on your computer.
6. Scroll to find the item that you want to download.
7. Click the Download icon  in the upper-right corner of the item that you want to download. Your app downloads to your library.</p>

<p>下载需要点时间，所以点开My Apps tab面不能马上看到刚下载的App,右上角有个下载进度提示，点击可以看详情。</p>

<p>Reference:<a href="https://support.apple.com/en-qa/HT201272">https://support.apple.com/en-qa/HT201272</a></p>

<h3>9. UICollectionView&rsquo;s cellForItemAtIndexPath is not being called</h3>

<p>A:</p>

<pre><code>self.automaticallyAdjustsScrollViewInsets = NO;
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/14668781/uicollectionviews-cellforitematindexpath-is-not-being-called?rq=1">http://stackoverflow.com/questions/14668781/uicollectionviews-cellforitematindexpath-is-not-being-called?rq=1</a></p>

<h3>10. iOS supported audio formats?</h3>

<p>A:</p>

<pre><code>@"aac",@"adts",@"ac3",@"aif",@"aiff",@"aifc",@"caf",@"mp3",@"mp4",@"m4a",@"snd",@"au",@"sd2",@"wav"
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/1761460/supported-audio-file-formats-in-iphone">http://stackoverflow.com/questions/1761460/supported-audio-file-formats-in-iphone</a>
<a href="https://www.raywenderlich.com/69365/audio-tutorial-ios-file-data-formats-2014-edition">https://www.raywenderlich.com/69365/audio-tutorial-ios-file-data-formats-2014-edition</a></p>

<h3>11. How do I put the image on the right side of the text in a UIButton?</h3>

<p>A:</p>

<pre><code>CGFloat spacing          = 3;
    CGFloat insetAmount      = 0.5 * spacing;

    // First set overall size of the button:
    button.contentEdgeInsets = UIEdgeInsetsMake(0, insetAmount, 0, insetAmount);
    [button sizeToFit];

    // Then adjust title and image insets so image is flipped to the right and there is spacing between title and image:
    button.titleEdgeInsets   = UIEdgeInsetsMake(0, -button.imageView.frame.size.width - insetAmount, 0,  button.imageView.frame.size.width  + insetAmount);
    button.imageEdgeInsets   = UIEdgeInsetsMake(0, button.titleLabel.frame.size.width + insetAmount, 0, -button.titleLabel.frame.size.width - insetAmount);
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/7100976/how-do-i-put-the-image-on-the-right-side-of-the-text-in-a-uibutton">http://stackoverflow.com/questions/7100976/how-do-i-put-the-image-on-the-right-side-of-the-text-in-a-uibutton</a></p>

<h3>12. duplicate symbol _iToastDuration</h3>

<pre><code>enum iToastDuration {
    iToastDurationLong = 10000,
    iToastDurationShort = 1000,
    iToastDurationNormal = 3000
}iToastDuration;
</code></pre>

<p>A:</p>

<pre><code>typedef enum iToastDuration {
    iToastDurationLong = 10000,
    iToastDurationShort = 1000,
    iToastDurationNormal = 3000
}iToastDuration;
</code></pre>

<h3>13. Detecting taps on attributed text in a UITextView in iOS</h3>

<p>A:</p>

<pre><code>import UIKit
class ViewController: UIViewController, UIGestureRecognizerDelegate {

    @IBOutlet weak var textView: UITextView!

    override func viewDidLoad() {
        super.viewDidLoad()

        // Create an attributed string
        let myString = NSMutableAttributedString(string: "Swift attributed text")

        // Set an attribute on part of the string
        let myRange = NSRange(location: 0, length: 5) // range of "Swift"
        let myCustomAttribute = [ "MyCustomAttributeName": "some value"]
        myString.addAttributes(myCustomAttribute, range: myRange)

        textView.attributedText = myString

        // Add tap gesture recognizer to Text View
        let tap = UITapGestureRecognizer(target: self, action: #selector(myMethodToHandleTap(_:)))
        tap.delegate = self
        textView.addGestureRecognizer(tap)
    }

    func myMethodToHandleTap(sender: UITapGestureRecognizer) {

        let myTextView = sender.view as! UITextView
        let layoutManager = myTextView.layoutManager

        // location of tap in myTextView coordinates and taking the inset into account
        var location = sender.locationInView(myTextView)
        location.x -= myTextView.textContainerInset.left;
        location.y -= myTextView.textContainerInset.top;

        // character index at tap location
        let characterIndex = layoutManager.characterIndexForPoint(location, inTextContainer: myTextView.textContainer, fractionOfDistanceBetweenInsertionPoints: nil)

        // if index is valid then do something.
        if characterIndex &lt; myTextView.textStorage.length {

            // print the character index
            print("character index: \(characterIndex)")

            // print the character at the index
            let myRange = NSRange(location: characterIndex, length: 1)
            let substring = (myTextView.attributedText.string as NSString).substringWithRange(myRange)
            print("character at index: \(substring)")

            // check if the tap location has a certain attribute
            let attributeName = "MyCustomAttributeName"
            let attributeValue = myTextView.attributedText.attribute(attributeName, atIndex: characterIndex, effectiveRange: nil) as? String
            if let value = attributeValue {
               print("You tapped on \(attributeName) and the value is: \(value)")
            }

        }
    }
}
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/19332283/detecting-taps-on-attributed-text-in-a-uitextview-in-ios?rq=1">http://stackoverflow.com/questions/19332283/detecting-taps-on-attributed-text-in-a-uitextview-in-ios?rq=1</a></p>

<h3>14. iOS 开发中如何获取农历？</h3>

<p>A: iOS 8 以后 Apple 内置了农历支持，可以得到类似<strong>2016丙申年五月十七星期二</strong>的信息，如果你只需要这些信息就够了，那使用内置的农历就可以了。如果还想获取类似<strong>壬辰年癸卯月庚辰日</strong>，那可以用<a href="https://github.com/autopear/LunarCalendar">LunarCalendar</a>。</p>

<pre><code>    NSCalendar *chineseCalendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSCalendarIdentifierChinese];

    NSDateFormatter *dateFormatter = [NSDateFormatter new];
    dateFormatter.locale = [NSLocale localeWithLocaleIdentifier:@"zh_Hans_CN"];
    dateFormatter.dateStyle = NSDateFormatterFullStyle;
    dateFormatter.calendar = chineseCalendar;

    NSLog(@"%@", [dateFormatter stringFromDate:[NSDate date]]);

    // Output:2016丙申年五月十七星期二
</code></pre>

<p>Reference:<a href="https://www.quora.com/What-does-Apple-mean-when-it-says-iOS-8-will-include-lunar-calendar-support">https://www.quora.com/What-does-Apple-mean-when-it-says-iOS-8-will-include-lunar-calendar-support</a>
<a href="http://stackoverflow.com/questions/27878696/nscalendaridentifierrepublicofchina-vs-nscalendaridentifierchinese">http://stackoverflow.com/questions/27878696/nscalendaridentifierrepublicofchina-vs-nscalendaridentifierchinese</a></p>

<h3>15. How to fix tableView&rsquo;s tableHeaderView overlap first cell?</h3>

<p>A: The core of solution is when you change the frame of tableHeaderView, you need reassign it to tableView.</p>

<pre><code>    UIView *headerView = self.tableHeaderView;

    [headerView setNeedsLayout];
    [headerView layoutIfNeeded];
    CGFloat height = [headerView systemLayoutSizeFittingSize:UILayoutFittingCompressedSize].height;

    headerView.frame = ({
        CGRect headerFrame = headerView.frame;
        headerFrame.size.height = height;
        headerFrame;
    });

    self.tableHeaderView = headerView;
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/28782319/tableheaderview-on-top-of-first-cell">http://stackoverflow.com/questions/28782319/tableheaderview-on-top-of-first-cell</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（六）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-6.html"/>
    <updated>2016-03-28T20:14:53+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-6</id>
    <content type="html"><![CDATA[<h3>1. The data couldn’t be read because it isn’t in the correct format.</h3>

<p>A:项目是2014年开发的，打包导出 Ad-hoc 时报上面的错误，Build Setting > Enable Bitcode > NO 之后再试成功了。</p>

<p>Reference:<a href="http://stackoverflow.com/questions/33995769/ipatool-fails-to-build-with-bitcode-xcode-7-1-1">http://stackoverflow.com/questions/33995769/ipatool-fails-to-build-with-bitcode-xcode-7-1-1</a></p>

<h3>2.setNeedsLayout vs. setNeedsUpdateConstraints and layoutIfNeeded vs updateConstraintsIfNeeded</h3>

<p>A:</p>

<ul>
<li>If you manipulated constraints directly, call setNeedsLayout.</li>
<li>If you changed some conditions (like offsets or smth) which would change constraints in your overridden updateConstraints method (a recommended way to change constraints, btw), call setNeedsUpdateConstraints, and most of the time, setNeedsLayout after that.</li>
<li>If you need any of the actions above to have immediate effect—e.g. when your need to learn new frame height after a layout pass—append it with a layoutIfNeeded.</li>
</ul>


<p>Reference:<a href="http://stackoverflow.com/questions/20609206/setneedslayout-vs-setneedsupdateconstraints-and-layoutifneeded-vs-updateconstra">http://stackoverflow.com/questions/20609206/setneedslayout-vs-setneedsupdateconstraints-and-layoutifneeded-vs-updateconstra</a></p>

<h3>3.父类如何关联子类通过nib初始化的属性？</h3>

<p>A: Select xib > Show Utilities > Show The Connection In Inspector > + > Connect to View</p>

<!-- more -->


<h3>4. Failed to load test bundle from file</h3>

<pre><code>Failed to load test bundle from file:///Users/dongmeiliang/Library/Developer/Xcode/DerivedData/JSQMessages-axyqhmblkssajpgcyzizcquhltft/Build/Products/Debug-iphonesimulator/JSQMessages.app/PlugIns/JSQMessagesTests.xctest/../JSQMessagesTests.xctest/: Error Domain=NSCocoaErrorDomain Code=4 "The bundle “$(PRODUCT_NAME)” couldn’t be loaded because its executable couldn’t be located." UserInfo={NSLocalizedFailureReason=The bundle’s executable couldn’t be located., NSLocalizedRecoverySuggestion=Try reinstalling the bundle., NSBundlePath=/Users/dongmeiliang/Library/Developer/Xcode/DerivedData/JSQMessages-axyqhmblkssajpgcyzizcquhltft/Build/Products/Debug-iphonesimulator/JSQMessages.app/PlugIns/JSQMessagesTests.xctest, NSLocalizedDescription=The bundle “$(PRODUCT_NAME)” couldn’t be loaded because its executable couldn’t be located.}
</code></pre>

<p>A:Tests target > info.plist > delete the row <code>Bundle name $(PRODUCT_NAME)</code>;</p>

<h3>5. pathForResource:ofType:inDirectory:方法有时找不到图片？</h3>

<p>A:原因是这个方法必须要指定完整的名字，比如图片的名称为fail_indicator@2x.png，放在JSQMessagesAssets.bundle的images目录下，那可以用如下代码来获取这张图片：</p>

<pre><code>+ (NSBundle *)jsq_messagesBundle
{
    return [NSBundle bundleForClass:[JSQMessagesViewController class]];
}

+ (NSBundle *)jsq_messagesAssetBundle
{
    NSString *bundleResourcePath = [NSBundle jsq_messagesBundle].resourcePath;
    NSString *assetPath = [bundleResourcePath stringByAppendingPathComponent:@"JSQMessagesAssets.bundle"];
    return [NSBundle bundleWithPath:assetPath];
}

+ (UIImage *)jsq_imageFromMessagesAssetBundleWithName:(NSString *)name
{
    NSBundle *bundle = [NSBundle jsq_messagesAssetBundle];
    NSString *path = [bundle pathForResource:name ofType:@"png" inDirectory:@"Images"];
    return [UIImage imageWithContentsOfFile:path];
}

[UIImage jsq_imageFromMessagesAssetBundleWithName:@"fail_indicator@2x"];
</code></pre>

<h3>6.自动布局的视图加上遮罩不生效而且视图上UIImageView的图片也不显示了,具体方法如下：</h3>

<pre><code>- (void)jsq_maskView:(UIView *)view withImage:(UIImage *)image
{
    NSParameterAssert(view != nil);
    NSParameterAssert(image != nil);

    UIImageView *imageViewMask = [[UIImageView alloc] initWithImage:image];
    imageViewMask.frame = CGRectInset(view.frame, 2.0f, 2.0f);

    view.layer.mask = imageViewMask.layer;
}
</code></pre>

<p>A:先设置视图的frame。</p>

<h3>7. 设置视图的frame后，视图最终的坐标和设置的坐标不一致</h3>

<p>A:问题的原因是将translatesAutoresizingMaskIntoConstraints设置NO，然后再去设置视图的坐标，这样修改的坐标不会生效，解决办法就是使用坐标是不要将translatesAutoresizingMaskIntoConstraints设置为NO.</p>

<h3>8.设置视图遮罩时，遮罩以宿主视图的origin为原点，所以当宿主视图的origin不是(0, 0)时，设置遮罩的frame时要考虑将宿主视图的origin设置为(0, 0)之后再进行伸缩，最终得到遮罩的frame。</h3>

<p>A:</p>

<pre><code>- (void)jsq_maskView:(UIView *)view withImage:(UIImage *)image
{
    NSParameterAssert(view != nil);
    NSParameterAssert(image != nil);

    CGRect baseFrameForMask = view.frame;
    baseFrameForMask.origin = CGPointZero;

    UIImageView *imageViewMask = [[UIImageView alloc] initWithImage:image];
    imageViewMask.frame = CGRectInset(baseFrameForMask, 2.0f, 2.0f);

    view.layer.mask = imageViewMask.layer;
}
</code></pre>

<h3>9.先调用方法二，然后调用方法一，最终的得到图片并没有水平翻转。</h3>

<pre><code>// 1.
- (UIImage *)jsq_imageMaskedWithColor:(UIColor *)maskColor
{
    NSParameterAssert(maskColor != nil);

    CGRect imageRect = CGRectMake(0.0f, 0.0f, self.size.width, self.size.height);
    UIImage *newImage = nil;

    UIGraphicsBeginImageContextWithOptions(imageRect.size, NO, self.scale);
    {
        CGContextRef context = UIGraphicsGetCurrentContext();

        CGContextScaleCTM(context, 1.0f, -1.0f);
        CGContextTranslateCTM(context, 0.0f, -(imageRect.size.height));

        CGContextClipToMask(context, imageRect, self.CGImage);
        CGContextSetFillColorWithColor(context, maskColor.CGColor);
        CGContextFillRect(context, imageRect);

        newImage = UIGraphicsGetImageFromCurrentImageContext();
    }
    UIGraphicsEndImageContext();

    return newImage;
}

// 2.
+ (UIImage *)imageWithCGImage:(CGImageRef)imageRef
                        scale:(CGFloat)scale
                  orientation:(UIImageOrientation)orientation
</code></pre>

<p>Code Listing:</p>

<pre><code>UIImage *originImage = /* Get origin image*/

UIImage *upMirroredImage = [UIImage imageWithCGImage:originImage.CGImage scale:originImage.scale orientation:UIImageOrientationUpMirrored];

UIImage *upMirroredImageWithMaskedColor = [upMirroredImage jsq_imageMaskedWithColor:[UIColor grayColor]];
</code></pre>

<p>A:调试中发现<code>+ (UIImage *)imageWithCGImage:(CGImageRef)imageRef scale:(CGFloat)scale orientation:(UIImageOrientation)orientation</code> 方法应该没有直接操作图片，而是更改了图片的metadata, 然后<code>- (UIImage *)jsq_imageMaskedWithColor:(UIColor *)maskColor</code>是直接操作图片时没有考虑图片的metadata,于是最终得到是原图加上指定颜色遮罩的图片。</p>

<h3>10. How to determine if an NSDate is today(Prior iOS 8)?</h3>

<p>A:</p>

<pre><code>NSDate *today = nil;
NSDate *beginningOfOtherDate = nil;

NSDate *now = [NSDate date];
[[NSCalendar currentCalendar] rangeOfUnit:NSDayCalendarUnit startDate:&amp;today interval:NULL forDate:now];
[[NSCalendar currentCalendar] rangeOfUnit:NSDayCalendarUnit startDate:&amp;beginningOfOtherDate interval:NULL forDate:otherDate];

if([today compare:beginningOfOtherDate] == NSOrderedSame) {
    //otherDate is a date in the current day
}
</code></pre>

<p>Reference:<a href="http://stackoverflow.com/questions/2331129/how-to-determine-if-an-nsdate-is-today">http://stackoverflow.com/questions/2331129/how-to-determine-if-an-nsdate-is-today</a></p>

<h3>11. How do you resize an image?</h3>

<p>A:</p>

<ul>
<li>UIKit, Core Graphics, and Image I/O all perform well for scaling operations on most images.</li>
<li>Core Image is outperformed for image scaling operations. In fact, it is specifically recommended in the Performance Best Practices section of the Core Image Programming Guide to use Core Graphics or Image I/O functions to crop or downsample images beforehand.</li>
<li>For general image scaling without any additional functionality, UIGraphicsBeginImageContextWithOptions is probably the best option.</li>
<li>If image quality is a consideration, consider using CGBitmapContextCreate in combination with CGContextSetInterpolationQuality.</li>
<li>When scaling images with the intent purpose of displaying thumbnails, CGImageSourceCreateThumbnailAtIndex offers a compelling solution for both rendering and caching.</li>
<li>Unless you’re already working with vImage, the extra work to use the low-level Accelerate framework for resizing doesn’t pay off.</li>
</ul>


<p>Reference:<a href="http://nshipster.com/image-resizing/">http://nshipster.com/image-resizing/</a></p>

<h3>12. How can I deal with this warning: hash mismatch?</h3>

<pre><code>warning: hash mismatch: this object file was built against a different version of the module /Users/dongmeiliang/Library/Developer/Xcode/DerivedData/ModuleCache/1ZNHC044GWHJS/SystemConfiguration-1U17T3939DDG.pcm
</code></pre>

<p>A:Clean > Build
Reference:<a href="http://stackoverflow.com/questions/36467348/how-can-i-deal-with-this-warning-hash-mismatch">http://stackoverflow.com/questions/36467348/how-can-i-deal-with-this-warning-hash-mismatch</a></p>

<h3>13. Cocoa Coding Style Enforcement</h3>

<p>A:<a href="http://emlyn.net/posts/cocoa-coding-style-enforcement/">http://emlyn.net/posts/cocoa-coding-style-enforcement/</a></p>

<h3>14. Importing Swift into Objective-C Within the Same App Target</h3>

<p>A:</p>

<blockquote><p>When you import Swift code into Objective-C, you rely on an Xcode-generated header file to expose those files to Objective-C. This automatically generated file is an Objective-C header that declares the Swift interfaces in your target. It can be thought of as an umbrella header for your Swift code. The name of this header is your product module name followed by adding &ldquo;-Swift.h&rdquo;. (You’ll learn more about the product module name later, in Naming Your Product Module.)</p></blockquote>

<p>在同一个 App Target 中， 导入 Swift 到 Objective-C 只需要 <code>#import "ProductModuleName-Swift.h"</code>, 需要注意 ProductModuleName-Swift.h 是 Xcode 生成的文件，所以在工程中看不到，只需要在用到 Swift 的 Objective-C 文件中引用这个文件就好了。</p>

<p>Reference:<a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html#//apple_ref/doc/uid/TP40014216-CH10-ID138">https://developer.apple.com/library/ios/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html#//apple_ref/doc/uid/TP40014216-CH10-ID138</a></p>

<h3>15. Swift 中对应 Objectie-C 中的class 类方法</h3>

<p>A:</p>

<pre><code>tableView.registerClass(UITableViewCell.self, forCellReuseIdentifier: cellIdentifier)
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS Technical Interview Part 3]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-technical-interview-part-3.html"/>
    <updated>2016-02-25T18:43:44+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-technical-interview-part-3</id>
    <content type="html"><![CDATA[<h3>1.Difference between categories and extensions?</h3>

<p>A:There are two difference beween categories and extensions:</p>

<ol>
<li>The extension has no name;</li>
<li>The implementation of the extension must be in the main @implementation block of the file.</li>
</ol>


<p>Reference:<a href="http://stackoverflow.com/questions/3499704/difference-between-category-and-class-extension">http://stackoverflow.com/questions/3499704/difference-between-category-and-class-extension</a></p>

<h3>2.What is advantage of category?</h3>

<p>A:</p>

<ul>
<li>You can add method to existing class even to that class whose source is not available to you.</li>
<li>You can extend functionality of a class without subclassing.</li>
<li>You can split implementation in multiple classes.</li>
</ul>


<p>Reference:<a href="http://psri13.blogspot.com/2014/07/what-is-advantage-of-categories-what-is.html">http://psri13.blogspot.com/2014/07/what-is-advantage-of-categories-what-is.html</a></p>

<h3>3.What are KVO and KVC?</h3>

<p>A:</p>

<blockquote><p>Key-value observing is a mechanism that enables an object to be notified directly when a property of another object changes.
Key-value coding is a mechanism for indirectly accessing an object’s attributes and relationships using string identifiers.</p></blockquote>

<p>Reference:Cocoa Core Competencies</p>

<!-- more -->


<h3>4.Difference between shallow copy and deep copy?</h3>

<p>A:
The difference between shallow and deep copying is only relevant for compound objects (objects that contain other objects, like lists or class instances):</p>

<p>A shallow copy constructs a new compound object and then (to the extent possible) inserts references into it to the objects found in the original.
A deep copy constructs a new compound object and then, recursively, inserts copies into it of the objects found in the original.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/17246693/what-exactly-is-the-difference-between-shallow-copy-deepcopy-and-normal-assignm">http://stackoverflow.com/questions/17246693/what-exactly-is-the-difference-between-shallow-copy-deepcopy-and-normal-assignm</a></p>

<h3>5.When retain count increase?</h3>

<p>A:</p>

<ul>
<li>When you create an object;</li>
<li>When you send an object retain message;</li>
</ul>


<p>Reference:<a href="http://stackoverflow.com/questions/4254346/conditions-in-which-retaincount-increases-or-decreases">http://stackoverflow.com/questions/4254346/conditions-in-which-retaincount-increases-or-decreases</a></p>

<h3>6.If we don’t create any autorelease pool in our application then is there any autorelease pool already provided to us?</h3>

<p>A: Yes, there is a autorelease pool already provided to us.</p>

<h3>7.When you will create an autorelease pool in your application?</h3>

<p>A:There are three occasions when you might use your own autorelease pool blocks:</p>

<ul>
<li>If you are writing a program that is not based on a UI framework, such as a command-line tool.</li>
<li><p>If you write a loop that creates many temporary objects.
You may use an autorelease pool block inside the loop to dispose of those objects   before the next iteration. Using an autorelease pool block in the loop helps to  reduce the maximum memory footprint of the application.</p></li>
<li><p>If you spawn a secondary thread.
You must create your own autorelease pool block as soon as the thread begins executing; otherwise, your application will leak objects.</p></li>
</ul>


<h3>8.How many autorelease pool you can create in your application? Is there any limit?</h3>

<p>A: You can create autorelease pool as much as possible, there is no limit.</p>

<h3>9.What is purpose of delegates?</h3>

<p>A:Delegation is a simple and powerful pattern in which one object in a program acts on behalf of, or in coordination with, another object.</p>

<h3>10.What is difference between NSNotification and protocol?</h3>

<p>A:</p>

<ul>
<li>Protocol is To-one Relationships; NSNotification is To-many Relationships.</li>
<li>Protocol support bidirectional data-transfer between two classes.</li>
</ul>


<h3>11.Polymorphism？</h3>

<p>A: The ability of different objects to respond, each in its own way, to identical messages is called polymorphism.</p>

<h3>12.Singleton?</h3>

<p>A:A singleton class returns the same instance no matter how many times an application requests it.</p>

<h3>13.Give us example of what are delegate methods and what are data source methods of UITableView?</h3>

<p>A:</p>

<pre><code>// Delegate methods
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions;
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex;
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex;

 // Data source methods
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView;
 - (NSInteger)tableView:(UITalbleView *)tableView numberOfRowsInSections:(NSInteger)section;
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath;
</code></pre>

<h3>14.What are mutable and immutable types in Objective C?</h3>

<p>A:A mutable object can be mutated or changed. An immutable object cannot.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/7071096/what-is-difference-between-mutable-and-immutable">http://stackoverflow.com/questions/7071096/what-is-difference-between-mutable-and-immutable</a></p>

<h3>15.When to use NSMutableArray and when to use NSArray?</h3>

<p>A:When collection will mutable you should use NSMutableArray, otherwise use NSArray.</p>

<h3>16.What is convenience constructor?</h3>

<p>A:A convenience constructor is one that performs object allocation &amp; initialization in one step &amp; returns an autoreleased object to the caller.</p>

<p>Reference:<a href="https://www.quora.com/Objective-C-programming-language/What-is-a-convenience-constructor">https://www.quora.com/Objective-C-programming-language/What-is-a-convenience-constructor</a></p>

<h3>17.What is responder chain?</h3>

<p>A:The responder chain is a series of linked responder objects.</p>

<h3>18.What is push notification?</h3>

<p>A:Apple Push Notification service (APNs for short) is the centerpiece of the remote notifications feature. It is a robust and highly efficient service for propagating information to iOS and OS X devices. Each device establishes an accredited and encrypted IP connection with the service and receives notifications over this persistent connection. If a notification for an app arrives when that app is not running, the device alerts the user that the app has data waiting for it.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS Technical Interview Part 2]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-technical-interview-part-2.html"/>
    <updated>2016-02-25T16:54:55+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-technical-interview-part-2</id>
    <content type="html"><![CDATA[<ol>
<li><p>@property中有哪些属性关键字？/ @property 后面可以有哪些修饰符？
 A:</p>

<ul>
<li>Write Serialization(not general thread safety): nonatomic atomic (default)</li>
<li>Mutability: readonly readwrite (default)</li>
<li>API Contron :getter = methodname setter = mehtodname:</li>
<li>Memory Management: copy strong (default) weak unsafe_unretained assign</li>
</ul>
</li>
<li><p>ARC下，不显式指定任何属性关键字时，默认的关键字都有哪些？
 A:</p>

<ul>
<li>Write Serialization: atomic</li>
<li>Mutability: readwrite</li>
<li>Memory Management: assign(non-object) strong(object)</li>
</ul>
</li>
<li><p>什么情况使用 weak 关键字，相比 assign 有什么不同？
 A:
 什么情况使用 weak 关键字？</p>

<ul>
<li>强引用关系的对象会发生循环引用时用weak关键字；</li>
<li>已经被强引用的对象，如Interface Builder创建的视图被声明为weak。</li>
</ul>


<p> weak 相比 assign 有什么不同？</p>

<ul>
<li>weak 必须修饰对象，assign还可以修饰非对象；</li>
<li>weak 修饰的属性所指向的对象销毁后，该属性会被置为nil，而assign修改的属性所指向的对象销毁后，属性仍然指向对象分配的内存地址成为野指针。</li>
</ul>
</li>
</ol>


<!-- more -->


<ol>
<li><p>weak属性需要在dealloc中置nil么？
 A: 不需要，因为 weak 属性不影响对象的引用计数。</p></li>
<li><p>用@property声明的NSString（或NSArray，NSDictionary）经常使用copy关键字，为什么？如果改用strong关键字，可能造成什么问题？</p>

<ul>
<li>对非集合类对象的copy操作</li>
<li>集合类对象的copy与mutableCopy</li>
</ul>


<p> A:
 为什么？
 因为父类指针可以指向子类对象,而使用 copy 可以让本对象的属性不受外界影响,无论给我传入是一个可变对象还是不可对象,我本身持有的就是一个不可变的副本.</p>

<p> 如果改用strong关键字，可能造成什么问题？
 如果我们使用是 strong ,那么这个属性就有可能指向一个可变对象,如果这个可变对象在外部被修改了,那么会影响该属性.</p>

<p> 非集合类对象的copy与mutableCopy：
 对 immutable 对象进行 copy 操作，是指针复制，mutableCopy 操作时内容复制；对 mutable 对象进行 copy 和 mutableCopy 都是内容复制。用代码简单表示如下：</p>

<pre><code class="`"> [immutableObject copy] // 浅复制
 [immutableObject mutableCopy] //深复制
 [mutableObject copy] //深复制
 [mutableObject mutableCopy] //深复制
</code></pre>

<p> 实例验证：</p>

<pre><code class="`"> NSMutableString *string = [NSMutableString stringWithString:@"origin"];//copy
 NSString *stringCopy = [string copy];

 // 查看内存，会发现 string、stringCopy 内存地址都不一样，说明此时都是做内容拷贝、深拷贝。即使你进行如下操作：
 [string appendString:@"origion!"]

 // stringCopy 的值也不会因此改变，但是如果不使用 copy，stringCopy 的值就会被改变。
</code></pre>

<p> 集合类对象的copy与mutableCopy:
 对 immutable 对象进行 copy，是指针复制， mutableCopy 是内容复制；对 mutable 对象进行 copy 和 mutableCopy 都是内容复制。但是：集合对象的内容复制仅限于对象本身，对象元素仍然是指针复制。用代码简单表示如下：</p>

<pre><code class="`"> [immutableObject copy] // 浅复制
 [immutableObject mutableCopy] //单层深复制
 [mutableObject copy] //单层深复制
 [mutableObject mutableCopy] //单层深复制
</code></pre>

<p> 实例验证：</p>

<pre><code class="`"> // 下面先看集合类immutable对象使用 copy 和 mutableCopy 的一个例子：
 NSArray *array = @[@[@"a", @"b"], @[@"c", @"d"]];
 NSArray *copyArray = [array copy];
 NSMutableArray *mCopyArray = [array mutableCopy];
 // 查看内容，可以看到 copyArray 和 array 的地址是一样的，而 mCopyArray 和 array 的地址   是不同的。说明 copy 操作进行了指针拷贝，mutableCopy 进行了内容拷贝。但需要强调的是：此处的内   容拷贝，仅仅是拷贝 array 这个对象，array 集合内部的元素仍然是指针拷贝。这和上面的非集合    immutable 对象的拷贝还是挺相似的，那么mutable对象的拷贝会不会类似呢？我们继续往下，看     mutable 对象拷贝的例子：

 NSMutableArray *array = [NSMutableArray arrayWithObjects:[NSMutableString   stringWithString:@"a"],@"b",@"c",nil];
 NSArray *copyArray = [array copy];
 NSMutableArray *mCopyArray = [array mutableCopy];

 // 查看内存，如我们所料，copyArray、mCopyArray和 array 的内存地址都不一样，说明    copyArray、mCopyArray 都对 array 进行了内容拷贝。
</code></pre></li>
<li><p>这个写法会出什么问题： @property (copy) NSMutableArray *array?
 A:问题一：由于属性声明为 copy, 所以它最终指向的是一个 NSArray，对它调用 NSMutableArray 中定义的方法会导致应用奔溃；
 问题二：如果是开发 iOS 程序，这会影响性能。</p></li>
<li><p>怎么用 copy 关键字？
 A:声明为属性的类遵守 NSCopying 协议，而且我们希望设置新值时保存一份自己的拷贝。</p></li>
<li><p>如何让自己的类用 copy 修饰符？如何重写带 copy 关键字的 setter？
 A:</p>

<blockquote><p>Any object that you wish to set for a copy property must support NSCopying, which means that it should conform to the NSCopying protocol.
Only classes that define an “immutable vs. mutable” distinction should adopt this protocol.</p></blockquote></li>
<li><p>protocol 和 category 中如何使用 @property?
 A:</p>

<ul>
<li>protocol 使用 property 和 class 类似，只是 protocol 的 property 只会生成相应 getter 和 setter 方法声明，遵守协议的类需要实现相应的 getter 和 setter 方法；</li>
<li>category 使用 property 和 class 有点区别，主要原因是 category 不支持添加实例变量，所以 category 中可以声明组合已有类 property 的 readonly 修饰的便捷 property；或者通过关联引用来辅助实现 getter 和 setter 方法。</li>
</ul>
</li>
<li><p>@property 的本质是什么？ivar、getter、setter 是如何生成并添加到这个类中的?
A:@property 的本质是什么？
    @property = ivar + getter + setter;</p>

<p>ivar、getter、setter 是如何生成并添加到这个类中的?
“自动合成”( autosynthesis)
完成属性定义后，编译器会自动编写访问这些属性所需的方法，此过程叫做“自动合成”(autosynthesis)。需要强调的是，这个过程由编译器在编译期执行，所以编辑器里看不到这些“合成方法”(synthesized method)的源代码。除了生成方法代码 getter、setter 之外，编译器还要自动向类中添加适当类型的实例变量，并且在属性名前面加下划线，以此作为实例变量的名字。</p></li>
<li><p>@synthesize和@dynamic分别有什么作用？
A:</p>

<ul>
<li>@synthesize 是告诉编译器怎么去合成相应属性的 getter 和 setter 方法；</li>
<li>@dynamic 告诉编译器属性的 setter 与 getter 方法由用户自己实现，不自动合成。</li>
</ul>
</li>
<li><p>在有了自动合成属性实例变量之后，@synthesize还有哪些使用场景？
A:</p>

<ul>
<li>自定义自动合成的实例变量的名称；</li>
<li>自动合成协议中声明 getter 和 setter 方法。</li>
</ul>
</li>
<li><p>@synthesize合成实例变量的规则是什么？假如property名为foo，存在一个名为<em>foo的实例变量，那么还会自动合成新变量么？
A:
@synthesize合成实例变量的规则是什么？
假设声明了propertyname的属性，默认会合成</em>propertyname的实例变量，也可以自定义合成实例变量的名称，如果目标合成实例变量已经存在则不再合成。</p>

<p>假如property名为foo，存在一个名为_foo的实例变量，那么还会自动合成新变量么？
不会。</p></li>
<li><p>ARC通过什么方式帮助开发者管理内存？
A:</p>

<blockquote><p>ARC works by adding code at compile time to ensure that objects live as long as necessary, but no longer.</p></blockquote></li>
<li><p>objc使用什么机制管理对象内存？
A: 引用计数机制。</p></li>
<li><p>不手动指定autoreleasepool的前提下，一个autorealese对象在什么时刻释放？（比如在一个vc的viewDidLoad中创建）
A: Autorelease对象出了作用域之后，会被添加到最近一次创建的自动释放池中，并会在当前的 runloop 迭代结束时释放。如果在一个vc的viewDidLoad中创建一个 Autorelease对象，那么该对象会在 viewDidAppear 方法执行前就被销毁了。</p></li>
<li><p>苹果是如何实现autoreleasepool的？
A:</p></li>
<li><p>使用block时什么情况会发生引用循环，如何解决？
A:一个对象中强引用了block，在block中又使用了该对象，就会发生循环引用。
解决方法是将该对象使用<strong>weak或者</strong>block修饰符修饰之后再在block中使用。</p></li>
<li><p>id weak weakSelf = self，或者 weak __typeof(self)weakSelf = self</p></li>
<li><p>id __block weakSelf = self;</p></li>
<li><p>在block内如何修改block外部变量？
A:使用 _block 存储类型修饰外部变量。</p></li>
<li><p>使用系统的某些block api（如UIView的block版本写动画时），是否也考虑引用循环问题？
A:使用系统的block api要不要考虑引用循环问题取决于它会不会造成引用循环，如果不会造成引用循环则不需要考虑，反之则需要考虑。UIView的block版本写动画时不需要考虑引用循环问题。</p></li>
<li><p>IBOutlet连出来的视图属性为什么可以被设置成weak?
A:IBOutlet 连出来的视图是视图层级的组成部分，对它已经有一个强引用，所以它可以被设置为 weak。</p></li>
<li><p>IB中User Defined Runtime Attributes如何使用？
A:</p>

<blockquote><p>Add initialization of custom runtime attributes to objects that do not have a corresponding Interface Builder inspector.</p></blockquote></li>
<li><p>若一个类有实例变量 NSString *<em>foo ，调用setValue:forKey:时，可以以foo还是 </em>foo 作为key？
A:都可以。</p></li>
<li><p>KVC的keyPath中的集合运算符如何使用？
A:</p>

<ul>
<li>必须是集合对象</li>
<li>KVC支持的集合运算符</li>
<li>正确的  Operator key path 格式</li>
</ul>
</li>
<li><p>KVC和KVO的keyPath一定是属性么？
A:KVO支持实例变量。</p></li>
<li><p>addObserver:forKeyPath:options:context:各个参数的作用分别是什么，observer中需要实现哪个方法才能获得KVO回调？
A:</p>

<table>
<thead>
<tr>
<th> Parameter </th>
<th> Function </th>
</tr>
</thead>
<tbody>
<tr>
<td> anObserver </td>
<td> The object to register for KVO notifications. The observer must implement the key-value observing method observeValueForKeyPath:ofObject:change:context:. </td>
</tr>
<tr>
<td> keyPath </td>
<td> The key path, relative to the receiver, of the property to observe. This value must not be nil. </td>
</tr>
<tr>
<td> options </td>
<td> A combination of the NSKeyValueObservingOptions values that specifies what is included in observation notifications. For possible values, see NSKeyValueObservingOptions. </td>
</tr>
<tr>
<td> context </td>
<td> Arbitrary data that is passed to anObserver in observeValueForKeyPath:ofObject:change:context:. </td>
</tr>
</tbody>
</table>
</li>
</ol>


<p>observer中需要实现- observeValueForKeyPath:ofObject:change:context:才能获得KVO回调。</p>

<ol>
<li><p>如何手动触发一个value的KVO?
A:改变值之前调用 willChangeValueForKey:，改变值之后调用 didChangeValueForKey:。</p></li>
<li><p>如何关闭默认的KVO的默认实现，并进入自定义的KVO实现？
A:</p>

<ul>
<li>A class that implements manual notification must override the NSObject implementation of automaticallyNotifiesObserversForKey:.For properties that perform manual notification, the subclass implementation of automaticallyNotifiesObserversForKey: should return NO.</li>
<li>To implement manual observer notification, you invoke willChangeValueForKey: before changing the value, and didChangeValueForKey: after changing the value.</li>
</ul>
</li>
<li><p>apple用什么方式实现对一个对象的KVO？
A:</p>

<blockquote><p>Automatic key-value observing is implemented using a technique called isa-swizzling.</p></blockquote></li>
<li><p>GCD的队列（dispatch_queue_t）分哪两种类型？
A:</p>

<ul>
<li>DISPATCH_QUEUE_SERIAL</li>
<li>DISPATCH_QUEUE_CONCURRENT</li>
</ul>
</li>
<li><p>如何用GCD同步若干个异步调用？（如根据若干个url异步加载多张图片，然后在都下载完成后合成一张整图）
A:</p>

<blockquote><p>Dispatch groups are a way to block a thread until one or more tasks finish executing.</p></blockquote>

<pre><code>    dispatch_queue_t queue =        dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    dispatch_group_t group = dispatch_group_create();
    dispatch_group_async(group, queue, ^{ /*加载图片1 */ });
    dispatch_group_async(group, queue, ^{ /*加载图片2 */ });
    dispatch_group_async(group, queue, ^{ /*加载图片3 */ }); 
    dispatch_group_notify(group, dispatch_get_main_queue(), ^{
            // 合并图片
    });
</code></pre></li>
<li><p>dispatch_barrier_async的作用是什么？
A:</p>

<blockquote><p>Submits a barrier block for asynchronous execution and returns immediately.
A dispatch barrier allows you to create a synchronization point within a concurrent dispatch queue. When it encounters a barrier, a concurrent queue delays the execution of the barrier block (or any further blocks) until all blocks submitted before the barrier finish executing. At that point, the barrier block executes by itself. Upon completion, the queue resumes its normal execution behavior.</p></blockquote></li>
<li><p>苹果为什么要废弃dispatch_get_current_queue？
A:dispatch_get_current_queue 容易造成死锁。</p></li>
<li><p>以下代码运行结果如何？</p></li>
</ol>


<pre><code>- (void)viewDidLoad
{
    [super viewDidLoad];
    NSLog(@"1");
    dispatch_sync(dispatch_get_main_queue(), ^{
        NSLog(@"2");
    });
    NSLog(@"3");
}
</code></pre>

<p>A: 只输出：1 。发生主线程锁死。</p>

<ol>
<li><p>runloop和线程有什么关系？
A:</p>

<blockquote><p>Run loops are intended for situations where you want more interactivity with the thread.</p></blockquote>

<p>当我们和线程有很多交互时，可以为线程配置一个 RunLoop.</p>

<pre><code>- (void)networkRunLoopThreadEntry
// This thread runs all of our network operation run loop callbacks.
{
assert( ! [NSThread isMainThread] );
while (YES) {
    NSAutoreleasePool * pool;

    pool = [[NSAutoreleasePool alloc] init];
    assert(pool != nil);

    [[NSRunLoop currentRunLoop] run];

    [pool drain];
}
assert(NO);
}
</code></pre></li>
<li><p>runloop的mode作用是什么？
A:</p>

<blockquote><p>A run loop mode is a collection of input sources and timers to be monitored and a collection of run loop observers to be notified.
Each time you run your run loop, you specify (either explicitly or implicitly) a particular “mode” in which to run. During that pass of the run loop, only sources associated with that mode are monitored and allowed to deliver their events. (Similarly, only observers associated with that mode are notified of the run loop’s progress.) Sources associated with other modes hold on to any new events until subsequent passes through the loop in the appropriate mode.</p></blockquote></li>
</ol>


<p>mode的作用是设置好需要监控的 input sources 和 timers，以及需要通知的 run loop observers。</p>

<ol>
<li>以+ scheduledTimerWithTimeInterval&hellip;的方式触发的timer，在滑动页面上的列表时，timer会暂定回调，为什么？如何解决？
A:滑动页面的列表时 RunLoop 会从 NSDefaultRunLoopMode 切换到 NSEventTrackingRunLoopMode，而以+ scheduledTimerWithTimeInterval&hellip;的方式触发的timer默认是在 NSDefaultRunLoopMode 下被监控，所以会出现暂停回调。</li>
</ol>


<p>如何解决？
解决办法自然是希望 timer 触发的事件不被限制，也就是说在 NSEventTrackingRunLoopMode 下也能被监控，可以通过把 timer 加入到 NSRunLoopCommonModes 中，因为关联到它的 timer 也会被相应关联到 NSEventTrackingRunLoopMode 中。</p>

<blockquote><p>NSRunLoopCommonModes (Cocoa)
kCFRunLoopCommonModes (Core Foundation)
This is a configurable group of commonly used modes. Associating an input source with this mode also associates it with each of the modes in the group. For Cocoa applications, this set includes the default, modal, and event tracking modes by default. Core Foundation includes just the default mode initially. You can add custom modes to the set using the CFRunLoopAddCommonMode function.</p></blockquote>

<pre><code>//将timer添加到NSDefaultRunLoopMode中
[NSTimer scheduledTimerWithTimeInterval:1.0
     target:self
     selector:@selector(timerTick:)
     userInfo:nil
     repeats:YES];
//然后再添加到NSRunLoopCommonModes里
NSTimer *timer = [NSTimer timerWithTimeInterval:1.0
     target:self
     selector:@selector(timerTick:)
     userInfo:nil
     repeats:YES];
[[NSRunLoop currentRunLoop] addTimer:timer forMode:NSRunLoopCommonModes];
</code></pre>

<ol>
<li><p>猜想runloop内部是如何实现的？
A:</p>

<blockquote><p>It is a loop your thread enters and uses to run event handlers in response to incoming events.</p></blockquote></li>
<li><p>runtime 如何实现 weak 属性?/runtime如何实现weak变量的自动置nil？
A:runtime 对注册的类， 会进行布局，对于 weak 对象会放入一个 hash 表中。 用 weak 指向的对象内存地址作为 key，当此对象的引用计数为0的时候会 dealloc，假如 weak 指向的对象内存地址是a，那么就会以a为键， 在这个 weak 表中搜索，找到所有以a为键的 weak 对象，从而设置为 nil。</p></li>
<li><p>objc中向一个对象发送消息[obj foo]和objc_msgSend()函数之间有什么关系？
A:</p>

<blockquote><p>In Objective-C, messages aren’t bound to method implementations until runtime.
The compiler converts a message expression,</p></blockquote></li>
</ol>


<blockquote><p>[receiver message]
into a call on a messaging function, objc_msgSend.</p></blockquote>

<p>编译器会把向一个对象发送的消息转化成一次objc_msgSend()函数调用。</p>

<ol>
<li><p>objc中向一个nil对象发送消息将会发生什么？
A:</p>

<ul>
<li>如果一个方法返回值是一个对象，那么发送给nil的消息将返回nil;</li>
<li>如果方法返回值为指针类型，其指针大小为小于或者等于sizeof(void*)，float，double，long double 或者 long long 的整型标量，发送给 nil 的消息将返回0;</li>
<li>如果方法返回值为结构体,发送给 nil 的消息将返回0。结构体中各个字段的值将都是0</li>
<li>如果方法的返回值不是上述提到的几种情况，那么发送给 nil 的消息的返回值将是未定义的</li>
</ul>
</li>
<li><p><em>objc_msgForward 函数是做什么的，直接调用它将会发生什么？
A:当向一个对象发送一条消息，但它并没有实现的时候，</em>objc_msgForward会尝试做消息转发。直接调用_objc_msgForward是非常危险的事，如果用不好会直接导致程序Crash，但是如果用得好，能做很多非常酷的事。</p></li>
<li><p>能否向编译后得到的类中增加实例变量？能否向运行时创建的类中添加实例变量？为什么？
A:</p></li>
<li><p>不能向编译后得到的类中增加实例变量；</p></li>
<li>能向运行时创建的类中添加实例变量；</li>
</ol>


<p>解释:</p>

<ul>
<li>因为编译后的类已经注册在 runtime 中，类结构体中的 objc_ivar_list 实例变量的链表 和 instance_size 实例变量的内存大小已经确定，同时runtime 会调用 class_setIvarLayout 或 class_setWeakIvarLayout 来处理 strong weak 引用。所以不能向存在的类中添加实例变量；</li>
<li><p>运行时创建的类是可以添加实例变量，调用 class_addIvar 函数。但是得在调用 objc_allocateClassPair 之后，objc_registerClassPair 之前，原因同上。</p></li>
<li><p>一个objc对象如何进行内存布局？（考虑有父类的情况）
A:
Objective-C 对象的结构图
ISA指针
根类的实例变量
倒数第二层父类的实例变量
&hellip;
父类的实例变量
类的实例变量</p></li>
<li><p>一个objc对象的isa的指针指向什么？有什么作用？
A:</p>

<blockquote><p>The isa pointer, as the name suggests, points to the object&rsquo;s class which maintains a dispatch table.</p></blockquote></li>
</ul>


<p>指向对象的类。</p>

<ol>
<li>下面的代码输出什么？</li>
</ol>


<pre><code>@implementation Son : Father
- (id)init
{
    self = [super init];
    if (self) {
        NSLog(@"%@", NSStringFromClass([self class]));
        NSLog(@"%@", NSStringFromClass([super class]));
    }
    return self;
}
@end
</code></pre>

<p>A:都输出 Son.
super 是一个 Magic Keyword， 它本质是一个编译器标示符，和 self 是指向的同一个消息接受者！他们两个的不同点在于：super 会告诉编译器，调用 class 这个方法时，要去父类的方法，而不是本类里的。</p>

<ol>
<li><p>什么时候会报unrecognized selector的异常？
A:当调用该对象上某个方法,而该对象上没有实现这个方法的时候。</p></li>
<li><p>BAD_ACCESS在什么情况下出现？
A:</p></li>
<li>访问了野指针，比如对一个已经释放的对象执行了release、访问已经释放对象的成员变量或者发消息。</li>
<li><p>死循环</p></li>
<li><p>如何调试BAD_ACCESS错误?
A:</p></li>
<li><p>Enable Zombie Objects</p></li>
<li>Enable Address Sanitizer</li>
<li><p>重写object的respondsToSelector方法，显示出现EXEC_BAD_ACCESS前访问的最后一个object</p></li>
<li><p>lldb（gdb）常用的调试命令？
A:</p></li>
</ol>


<pre><code>lldb po
lldb p
lldb expression
lldb bt
lldb c
</code></pre>

<ol>
<li><p>使用runtime Associate方法关联的对象，需要在主对象dealloc的时候释放么？
A:不需要。</p></li>
<li><p>runtime如何通过selector找到对应的IMP地址？（分别考虑类方法和实例方法）
A:每一个类对象或对象中有一个方法列表,方法列表中记录着方法的名称,方法实现,以及参数类型,其实selector本质就是方法名称,通过这个方法名称就可以在方法列表中找到对应的方法实现.</p></li>
<li><p>objc中的类方法和实例方法有什么本质区别和联系？
A:
类方法：</p></li>
</ol>


<p>类方法是属于类对象的
类方法只能通过类对象调用
类方法中的self是类对象
类方法可以调用其他的类方法
类方法中不能访问成员变量
类方法中不定直接调用对象方法
实例方法：</p>

<p>实例方法是属于实例对象的
实例方法只能通过实例对象调用
实例方法中的self是实例对象
实例方法中可以访问成员变量
实例方法中直接调用实例方法
实例方法中也可以调用类方法(通过类名)</p>

<p>扩展阅读：
o <a href="http://onevcat.com/2013/04/ios-interview/">上级向的十个iOS面试问题</a>
o <a href="http://studentdeng.github.io/blog/2014/02/11/baidu-interview/">百度面试</a></p>

<p>Reference:
o <a href="http://blog.sunnyxx.com/2015/07/04/ios-interview/">http://blog.sunnyxx.com/2015/07/04/ios-interview/</a>
o <a href="https://github.com/ChenYilong/iOSInterviewQuestions">https://github.com/ChenYilong/iOSInterviewQuestions</a></p>
]]></content>
  </entry>
  
</feed>
