<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Hello World]]></title>
  <link href="http://DamianSheldon.github.io/atom.xml" rel="self"/>
  <link href="http://DamianSheldon.github.io/"/>
  <updated>2016-10-12T16:23:39+08:00</updated>
  <id>http://DamianSheldon.github.io/</id>
  <author>
    <name><![CDATA[Sheldon]]></name>
    <email><![CDATA[dongmeilianghy@sina.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[iOS Technical Interview Part 4]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-technical-interview-part-4.html"/>
    <updated>2016-08-30T10:43:36+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-technical-interview-part-4</id>
    <content type="html"><![CDATA[<h3>1.熟悉 CocoaPods 么？能大概讲一下工作原理么？</h3>

<p>A:熟悉，项目中的 Podfile 文件指定了使用的第三方库，根据它可以找到对应的 podspec 。 podspec 文件存储着第三方库的基本信息：包含哪些文件，静态库，资源文件，信赖哪些其他第三方库、系统框架，之后 pod 会创建一个工程，把这个库以 target 的形式包含进来，应用则依赖这个 pod 工程。</p>

<h3>2.最常用的版本控制工具是什么，能大概讲讲原理么？</h3>

<p>A: Git</p>

<h3>3.你一般是怎么用 Instruments 的？</h3>

<p>A:根据想要分析的问题，选择对应的　instruments　，同时参考　Instruments　User　Guide．</p>

<h3>4.你一般是如何调试 Bug 的</h3>

<p>A:复现 bug，之后单步调试定位。</p>

<h3>5.你在你的项目中用到了哪些设计模式？</h3>

<p>A:</p>

<pre><code>* 单例
* 委托
* Target-Action
* MVC
* 观察者
* 工厂方法
* 信息流
* 类簇
</code></pre>

<!-- more -->


<h3>6.如何实现单例，单例会有什么弊端？</h3>

<p>A：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>+ (instancetype)sharedInstance
</span><span class='line'>{
</span><span class='line'>    static dispatch_once_t once;
</span><span class='line'>    static id sharedInstance;
</span><span class='line'>    dispatch_once(&once, ^{
</span><span class='line'>        sharedInstance = [[self alloc] init];
</span><span class='line'>    });
</span><span class='line'>    return sharedInstance;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<ul>
<li>单例相当于全局变量，因此存在强藕合，不利于扩展和应对变化；</li>
<li>单例违背单一设计原则；</li>
</ul>


<h3>7.如何把一个包含自定义对象的数组序列化到磁盘？</h3>

<p>A:自定义对象需要实现 NSCoding 协议，然后可以调用 NSKeyedArchiver 的<code>+ (BOOL)archiveRootObject:(id)rootObject toFile:(NSString *)path</code>方法将它序列化到磁盘。</p>

<h3>8.iOS 的沙盒目录结构是怎样的？ App Bundle 里面都有什么？</h3>

<p>A:</p>

<p>App Bundle 里面有 Info.plist, Executeable, Resource files and Other support files.</p>

<h3>9.iOS 7的多任务添加了哪两个新的 API? 各自的使用场景是什么？</h3>

<p>A:</p>

<ul>
<li>Apps that regularly update their content by contacting a server can register with the system and be launched periodically to retrieve that content in the background. To register, include the UIBackgroundModes key with the fetch value in your app’s Info.plist file. Then, when your app is launched, call the setMinimumBackgroundFetchInterval: method to determine how often it receives update messages. Finally, you must also implement the application:performFetchWithCompletionHandler: method in your app delegate.</li>
<li>Apps that use push notifications to notify the user that new content is available can fetch the content in the background. To support this mode, include the UIBackgroundModes key with the remote-notification value in your app’s Info.plist file. You must also implement the application:didReceiveRemoteNotification:fetchCompletionHandler: method in your app delegate.</li>
</ul>


<p>Reference: What&rsquo;s New in iOS</p>

<h3>10.Objective-C 的 class 是如何实现的？Selector 是如何被转化为 C 语言的函数调用的？</h3>

<p>A:</p>

<p>[receiver message]</p>

<p>=> objc_msgSend(receiver, selector);</p>

<h3>11.UIScrollView 大概是如何实现的，它是如何捕捉、响应手势的？</h3>

<h3>12.Objective-C 如何对已有的方法，添加自己的功能代码以实现类似记录日志这样的功能？</h3>

<p>A: Method Swizzle.</p>

<h3>13.<code>+load</code> 和 <code>+initialize</code> 的区别是什么？</h3>

<p>A:</p>

<ul>
<li>load:Invoked whenever a class or category is added to the Objective-C runtime; implement this method to perform class-specific behavior upon loading.</li>
<li>initialize:Initializes the class before it receives its first message.</li>
</ul>


<h3>14.NSOperation 相比于 GCD 有哪些优势？</h3>

<p>A:</p>

<ul>
<li>可以取消操作；</li>
<li>可以添加依赖；</li>
<li>可以 KVO 属性;</li>
<li>可以添加优先级;</li>
<li>可以复用;</li>
</ul>


<h3>15.strong / weak / unsafe_unretained 的区别</h3>

<p>A:</p>

<ul>
<li>strong:对象的引用计数加一;</li>
<li>weak:对象的引用计数不变，对象销毁时 weak 属性自动置为nil;</li>
<li>unsafe_unretained:对象的引用计数不变，对象销毁时 unsafe_unretained 属性成为野指针;</li>
</ul>


<p>你可能会奇怪，有了 weak 还要 unsafe_unretained 干什么？ 原因是 weak 是 iOS 5 才可用的，所以当你要兼容 iOS 5, 或者将 iOS 5 时代之前 MRC 代码迁移到 ARC 时会用它，除些之外我们应该使用 weak.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/15968198/what-is-the-use-of-unsafe-unretained-attribute">http://stackoverflow.com/questions/15968198/what-is-the-use-of-unsafe-unretained-attribute</a></p>

<h3>16.Objective-C 中，meta-class 指的是什么</h3>

<p>A:类对象的类称为 meta-class.</p>

<h3>17.UIView 和 CALayer 之间的关系？</h3>

<p>A: UIView 会持有至少一个 CALayer 实例，CALayer 是 UIView 的骨架，它将 UIView 的内容绘制出来并提供动画支持。</p>

<h3>18.<code>+[UIView animateWithDuration:animations:completion:]</code> 内部大概是如何实现的？</h3>

<p>A:我觉得<code>+[UIView animateWithDuration:animations:completion:]</code> 内部应该是先使能 CALayer 实例的隐式动画，之后对 UIView animatable properties 的设置会传递到 CALayer 对应属性的 setter 方法，CALayer 的 setter 方法会触发对应的隐式动画，最后禁止 CALayer 实例的隐式动画。</p>

<p>Reference:</p>

<ul>
<li><a href="https://www.quora.com/How-is-UIViews-+animateWithDuration-animations-implemented">https://www.quora.com/How-is-UIViews-+animateWithDuration-animations-implemented</a></li>
<li><a href="http://stackoverflow.com/questions/15175750/how-uiview-animations-with-blocks-work-under-the-hood">http://stackoverflow.com/questions/15175750/how-uiview-animations-with-blocks-work-under-the-hood</a></li>
</ul>


<h3>19.什么时候会发生「隐式动画」？</h3>

<p>A: CALayer 的实例是支持隐式动画的，所以修改 CALayer Animatable Properties 里面的属性都可以触发隐式动画。UIView 默认禁止了 CALayer 的隐式动画，在动画块中又使能了，所以和 UIView 关联的 CALayer 实例只能在动画块中修改 Animatable UIView properties 里的属性也可以触发隐式动画。</p>

<p>Reference:<a href="http://stackoverflow.com/questions/4749343/when-exactly-do-implicit-animations-take-place-in-ios">http://stackoverflow.com/questions/4749343/when-exactly-do-implicit-animations-take-place-in-ios</a></p>

<h3>20.如何把一张大图缩小为1/4大小的缩略图？</h3>

<p>A:</p>

<ul>
<li>UIGraphicsBeginImageContextWithOptions &amp; UIImage -drawInRect:(UIKit)</li>
<li>CGBitmapContextCreate &amp; CGContextDrawImage(Core Graphics)</li>
<li>CGImageSourceCreateThumbnailAtIndex(Image IO)</li>
<li>Lanczos Resampling with Core Image(Core Image)</li>
<li>vImage in Accelerate(vImage)</li>
</ul>


<p>Reference:<a href="http://nshipster.com/image-resizing/">http://nshipster.com/image-resizing/</a></p>

<h3>21.Toll-Free Bridging 是什么？什么情况下会使用？</h3>

<p>A:</p>

<blockquote><p>There are a number of data types in the Core Foundation framework and the Foundation framework that can be used interchangeably. Data types that can be used interchangeably are also referred to as toll-free bridged data types. This means that you can use the same data structure as the argument to a Core Foundation function call or as the receiver of an Objective-C message invocation.</p></blockquote>

<h3>22.当系统出现内存警告时会发生什么？</h3>

<p>A:系统会杀死后台内存占用量大的应用释放内存给当前运行的应用，当前的应用也会收到内存警告的通知。</p>

<h3>23.什么是 Protocol，Delegate 一般是怎么用的？</h3>

<p>A:Protocol是一份消息合约。Delegate 是我们改变一个对象行为方式，这种方式不需要对类做继承。</p>

<h3>24.UIWebView 有哪些性能问题？有没有可替代的方案。</h3>

<p>A:</p>

<ul>
<li><strong>线程阻塞问题</strong>&ndash;当在 native 层调用 stringByEvaluatingJavaScriptFromString 方法时，可能由于 javascript 是单线程的原因，会阻塞原有 js 代码的执行。这里我们的解决办法是在 js 端用 defer 将 iframe 的插入延后执行。</li>
<li><strong>主线程的问题</strong>&ndash;UIWebView 的 stringByEvaluatingJavaScriptFromString 方法必须是主线程中执行，而主线程的执行时间过长就会 block UI 的更新。所以我们应该尽量让 stringByEvaluatingJavaScriptFromString 方法执行的时间短。</li>
</ul>


<p>Reference:<a href="http://blog.devtang.com/2012/03/24/talk-about-uiwebview-and-phonegap/">关于UIWebView的总结</a></p>

<h3>25.为什么 NotificationCenter 要 removeObserver? 如何实现自动 remove?</h3>

<p>A:因为之后产生了 Observer 感兴趣的通知 NotificationCenter 会调用 Observer 对应的处理方法，如果 Observer 销毁之后不从 NotificationCenter remove,那么会导致应用崩溃。</p>

<p>想要实现自动 remove，如果 NotificationCenter 对 Observer 的引用在 Observer 销毁后能自动置为 nil，类似 weak 的效果，那么问题就解决了。我们不能去修改 NotificationCenter 的内部实现，所以只能用其他的办法。有一个想法是在 Observer 销毁时调用 remove，可以利用 Objective-C 的 runtime 来帮助我们实现。具体思路是混写 addObserver 的方法，在这个混写方法中创建一个对象和 Observer 的生命周期关联起来，然后在这个关联对象的销毁方法中调用 removeObserver。</p>

<p>Reference:<a href="http://merowing.info/2012/03/automatic-removal-of-nsnotificationcenter-or-kvo-observers/">Automatic removal of NSNotificationCenter or KVO observers</a></p>

<h3>26.当 TableView 的 Cell 改变时，如何让这些改变以动画的形式呈现？</h3>

<p>A:You can also use beginUpdates method followed by the endUpdates method to animate the change in the row heights without reloading the cell.</p>

<h3>27.什么是 Method Swizzle，什么情况下会使用？</h3>

<p>A:Method Swizzle 是一种改变已存在方法实现的技术。当我们有改变已存在方法实现的需求是使用。</p>

<h3>28.为什么当 Core Animation 完成时，layer 又会恢复到原先的状态？</h3>

<p>A: Layer 有两个独立的图层: 1.modelLayer;2.presentationLayer. 动画是在 presentationLayer 上，所以当动画完成时， layer 又恢复到原先的状态。</p>

<h3>29.你会如何存储用户的一些敏感信息，如登录的 token。</h3>

<p>A:KeyChain services</p>

<h3>30.什么时候会使用 Core Graphics，有什么注意事项么？</h3>

<p>A:当需要绘制的内容不能用 UIKit 实现时，会使用 Core Graphics。</p>

<p>注意事项：</p>

<pre><code>* 坐标系统
* 线条的宽度尽量使用整数
* 缓存代价昂贵的数据
</code></pre>

<h3>31.使用 Block 时需要注意哪些问题？</h3>

<p>A:</p>

<ul>
<li>循环引用</li>
<li>对象的生命周期会延长</li>
</ul>


<h3>32.performSelector:withObject:afterDelay: 内部大概是怎么实现的，有什么注意事项么？</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (void)eoc_performSelector:(SEL)aSelector
</span><span class='line'>withObject:(id)anArgument
</span><span class='line'>afterDelay:(NSTimeInterval)delay
</span><span class='line'>{
</span><span class='line'>    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delay * NSEC_PER_SEC)), dispatch_get_global_queue(QOS_CLASS_UTILITY, 0), ^{
</span><span class='line'>            typedef void (*send_type)(id, SEL, id);
</span><span class='line'>
</span><span class='line'>            send_type func = (send_type)objc_msgSend;
</span><span class='line'>            func(self, aSelector, anArgument);
</span><span class='line'>            });
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>注意事项：
可能会导致内存泄露。因为不确定调用的方法，所以编译器不能插入合适的内存管理方法调用。例如newObject，copy之类的方法调用就会导致内存泄露。</p>

<h3>33.如何播放 GIF 图片，有什么优化方案么？</h3>

<p>A: 用 ImageIO 框架为每一帧动画创建一个 UIImage 对象，把这些对象聚合成一个 animatedImages 赋给 UIImageView，然后根据 GIF 的文件信息设置好 animationDuration 和 animationRepeatCount，最后调用 startAnimating。</p>

<p>优化方案：</p>

<ul>
<li>variable frame delays &ndash; One approach to support variable frame delays with UIImageView is to find the greatest common divisor of all frame delays and slot longer frames multiple times in a row into the animatedImages array.</li>
<li>memory implications &ndash; Whenever memory is the constraint, instead of storing the solution to a problem one has to recalculate it. In our case we needed a way to load and decode the frames just in time before they were displayed, and to purge the ones that were no longer on screen.</li>
</ul>


<p>Reference:</p>

<ul>
<li><a href="http://engineering.flipboard.com/2014/05/animated-gif/">How FlipBoard Play Animated GIFs On iOS</a></li>
</ul>


<h3>34.有哪几种方式可以对图片进行缩放，使用 CoreGraphics 缩放时有什么注意事项？</h3>

<p>A:</p>

<ul>
<li>UIGraphicsBeginImageContextWithOptions &amp; UIImage -drawInRect:(UIKit)</li>
<li>CGBitmapContextCreate &amp; CGContextDrawImage(Core Graphics)</li>
<li>CGImageSourceCreateThumbnailAtIndex(Image IO)</li>
<li>Lanczos Resampling with Core Image(Core Image)</li>
<li>vImage in Accelerate(vImage)</li>
</ul>


<h3>35.哪些途径可以让 ViewController 瘦下来？</h3>

<p>A: 我们的 App 基本都是使用类 MVC 架构，要想让 ViewController 瘦下来，基本的想法肯定是把和 ViewController 弱相关的代码移出去，移到哪？要么是称多 MV 中， 要么移到一个辅助对象中。所以基本做法应该是把弱业务代码移到 Model 中，和 View 相关的代码移到 View 中；甚至引入一个辅助对象来分担可以分离出去的职责。</p>

<p>Reference: <a href="https://objccn.io/issue-1-1/">更轻量的 View Controllers</a></p>

<h3>36.有哪些常见的 Crash 场景？</h3>

<p>A:</p>

<ul>
<li>数组越界</li>
<li>向数组或字典中插入的对象为 nil</li>
<li>向已经销毁的对象发送消息</li>
<li>内存管理出错</li>
<li>调用一个对象不支持的方法</li>
<li>看门狗超时</li>
<li>在非主线程操作 UI</li>
</ul>


<h3>37.设计一套大文件（如上百M的视频）下载方案。</h3>

<p>A:
<a href="https://github.com/thibaultcha/TCBlobDownload">TCBlobDownload</a></p>

<h3>38.如果让你来实现 dispatch_once，你会怎么做？</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>void SpinlockOnce(dispatch_once_t *predicate, dispatch_block_t block) {
</span><span class='line'>        static OSSpinLock lock = OS_SPINLOCK_INIT;
</span><span class='line'>
</span><span class='line'>        OSSpinLockLock(&lock);
</span><span class='line'>        if(!*predicate) {
</span><span class='line'>            block();
</span><span class='line'>            *predicate = 1;
</span><span class='line'>        }
</span><span class='line'>        OSSpinLockUnlock(&lock);
</span><span class='line'>    }</span></code></pre></td></tr></table></div></figure>


<p>Reference:
<a href="https://www.mikeash.com/pyblog/friday-qa-2014-06-06-secrets-of-dispatch_once.html">Friday Q&amp;A 2014-06-06: Secrets of dispatch_once</a></p>

<p>Reference:<a href="https://github.com/lzyy/iOS-Developer-Interview-Questions">https://github.com/lzyy/iOS-Developer-Interview-Questions</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（八）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-8.html"/>
    <updated>2016-06-24T15:54:30+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-8</id>
    <content type="html"><![CDATA[<h3>1.Detect hash tags #, mention tags @, in iOS like in Twitter App</h3>

<p>A:You can use <a href="https://github.com/Krelborn/KILabel">https://github.com/Krelborn/KILabel</a> this library. It also detect user taps on hashtags Like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>label.hashtagLinkTapHandler = ^(KILabel *label, NSString *string, NSRange range) {
</span><span class='line'>  NSLog(@"Hashtag tapped %@", string);
</span><span class='line'>};</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/24359972/detect-hash-tags-mention-tags-in-ios-like-in-twitter-app">http://stackoverflow.com/questions/24359972/detect-hash-tags-mention-tags-in-ios-like-in-twitter-app</a></p>

<h3>2.如何给应用重签名？</h3>

<p>A：利用用途广泛的命令行工具 security快速地显示出你的系统中能用来对代码进行签名的认证的方法：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ security find-identity -v -p codesigning                       
</span><span class='line'>  1) 01C8E9712E9632E6D84EC533827B4478938A3B15 "iPhone Developer: Thomas Kollbach (7TPNXN7G6K)"</span></code></pre></td></tr></table></div></figure>


<p>用<a href="https://github.com/fastlane/fastlane/tree/master/sigh">sign</a>给应用重签名</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sigh resign ./path/app.ipa --signing_identity "iPhone Distribution: Felix Krause" -p "my.mobileprovision"</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://objccn.io/issue-17-2/">http://objccn.io/issue-17-2/</a></p>

<!--more-->


<h3>3. It report BAD_ACCESS when set delegate for AVAudioPlayer.</h3>

<p>A: The reason is I instance AVAuidoPlayer without content like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>AVAudioPlayer *audioPlayer = [AVAudioPlayer new];
</span><span class='line'>audioPlayer.delegate = self;</span></code></pre></td></tr></table></div></figure>


<p>We should instance it with content:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>_audioPlayer = [[AVAudioPlayer alloc] initWithData:_audioData error:nil];
</span><span class='line'>[_audioPlayer prepareToPlay];
</span><span class='line'>_audioPlayer.delegate = self;</span></code></pre></td></tr></table></div></figure>


<h3>4.  How can I show my own app icon at the bottom-left corner of iPhone lock screen?</h3>

<p>Solution: 1. This is iOS 8 new feature called Handoff more info <a href="http://www.macrumors.com/2014/06/03/ios-8-apps-quick-access/">here</a>.</p>

<ol>
<li>You can&rsquo;t control what app appears in the bottom-left corner of the lock screen. Neither can you add code to your app to make your app appear there whenever you want. These are called Suggested Apps and it&rsquo;s a feature of iOS.</li>
</ol>


<p>iOS controls what app appears there based on several factors, including your location, the apps on your device, and your history of where &amp; when you use those apps. Together, iOS trys to present you with the app you would most-likely use at a given time, location, and history.</p>

<p>If you don&rsquo;t like this feature, it can be turned off in Settings -> General -> Handoff &amp; Suggested Apps.</p>

<p>Reference:<a href="http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen">http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen</a></p>

<p><a href="http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen">http://apple.stackexchange.com/questions/166983/how-did-a-calendar-icon-make-it-to-my-lock-screen</a></p>

<h3>5.</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> Class AJXorEncryptor is implemented in both /Users/dongmeiliang/Library/Developer/CoreSimulator/Devices/71988A60-BE7B-425A-BDE4-AAE4D098A516/data/Containers/Bundle/Application/051ED3F9-A920-41C8-9D96-41EED06DE618/AJFrameDevApp.app/AJFrameDevApp and /Users/dongmeiliang/Library/Developer/Xcode/DerivedData/AJFrameDevApp-fwmhocnqvmbmzkftzzdryfyigyzs/Build/Products/Debug-iphonesimulator/AJFrameDevApp.app/PlugIns/AJFrameDevAppTests.xctest/AJFrameDevAppTests. One of the two will be used. Which one is undefined.
</span><span class='line'> </span></code></pre></td></tr></table></div></figure>


<p> A:问题的原因是AJFrameDevApp和AJFrameDevAppTests这两个target都链接了一个相同的静态库。
 于是我将Podfile的内容由</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>target 'AJFrameDevApp' do
</span><span class='line'>    pod 'AJFrame', :path =&gt; '../'
</span><span class='line'>end
</span><span class='line'>
</span><span class='line'>target 'AJFrameDevAppTests' do
</span><span class='line'>    pod 'AJFrame', :path =&gt; '../'
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>改为：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>target 'AJFrameDevApp' do
</span><span class='line'>    pod 'AJFrame', :path =&gt; '../'
</span><span class='line'>    
</span><span class='line'>    target 'AJFrameDevAppTests' do
</span><span class='line'>        inherit! :search_paths
</span><span class='line'>        
</span><span class='line'>    end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/30581884/class-is-implemented-in-both-one-of-the-two-will-be-used/30582486">http://stackoverflow.com/questions/30581884/class-is-implemented-in-both-one-of-the-two-will-be-used/30582486</a></p>

<h3>6. 如何调用私有类的私有方法？真实的场景是开发了一个库，库中A持有一个私有类的属性，那么如何对私有类进行相应的单元测试呢？</h3>

<p>A：Objective-C的runtime可以帮我们做到，</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#include &lt;objc/message.h&gt;
</span><span class='line'>
</span><span class='line'>NSString *originalString = @"testEncryptMethod";
</span><span class='line'>    
</span><span class='line'>NSData *originalData = [originalString dataUsingEncoding:NSUTF8StringEncoding];
</span><span class='line'>    
</span><span class='line'>AJBinaryChannel *binaryChannel = [AJBinaryChannel new];
</span><span class='line'>binaryChannel.encryptKey = @"xorkey";
</span><span class='line'>    
</span><span class='line'>id wrapperEncryptor = (id)(binaryChannel.encryptor);
</span><span class='line'>    
</span><span class='line'>typedef NSData* (*send_type)(id, SEL, id);
</span><span class='line'>    
</span><span class='line'>send_type func = (send_type)objc_msgSend;
</span><span class='line'>    
</span><span class='line'>NSData *encryptData = func(wrapperEncryptor, @selector(encrypt:), originalData);
</span><span class='line'>    
</span><span class='line'>NSString *encryptString = [[NSString alloc] initWithData:encryptData encoding:NSUTF8StringEncoding];
</span><span class='line'>
</span><span class='line'>XCTAssertNotEqualObjects(originalString, encryptString);
</span><span class='line'>    
</span><span class='line'>NSData *decryptData = func(wrapperEncryptor, @selector(decrypt:), encryptData);
</span><span class='line'>    
</span><span class='line'>NSString *decryptString = [[NSString alloc] initWithData:decryptData encoding:NSUTF8StringEncoding];
</span><span class='line'>
</span><span class='line'>XCTAssertEqualObjects(originalString, decryptString);</span></code></pre></td></tr></table></div></figure>


<h3>7.Too many arguments to function call, expected 0, have 3</h3>

<p>A:The answer is you need to strong type objc_msgSend for the compiler to build it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>typedef void (*send_type)(void*, SEL, void*);
</span><span class='line'>send_type func = (send_type)objc_msgSend;
</span><span class='line'>func(anItem.callback_object, NSSelectorFromString(anItem.selector), dict);</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/24922913/too-many-arguments-to-function-call-expected-0-have-3">http://stackoverflow.com/questions/24922913/too-many-arguments-to-function-call-expected-0-have-3</a></p>

<h3>8. Why do we need Base64?</h3>

<p>A:Base64 is a group of similar binary-to-text encoding schemes that represent binary data in an ASCII string format by translating it into a radix-64 representation.
A binary-to-text encoding is encoding of data in plain text. More precisely, it is an encoding of binary data in a sequence of characters. <strong>These encodings are necessary for transmission of data when the channel does not allow binary data (such as email or NNTP) or is not 8-bit clean.</strong></p>

<p>Reference:<a href="https://en.wikipedia.org/wiki/Base64">https://en.wikipedia.org/wiki/Base64</a>
<a href="https://en.wikipedia.org/wiki/Binary-to-text_encoding">https://en.wikipedia.org/wiki/Binary-to-text_encoding</a></p>

<h3>9. 360° panorama libraries for ios</h3>

<p>A:<a href="https://code.google.com/archive/p/panoramagl/">panoramagl</a></p>

<p>Reference:<a href="http://stackoverflow.com/questions/3763978/360-panorama-libraries-for-ios">http://stackoverflow.com/questions/3763978/360-panorama-libraries-for-ios</a></p>

<h3>10. When should we use macro in iOS?</h3>

<p>A: As we known, macro has many disatanges:1.lack type info;2.can be redfine. Since its a keyword in C, when should we use it?</p>

<p>There are occasions where macros provide functionality not available through other means.</p>

<p>For example, I have a simple macro I sometimes use when debugging Objective-C to log when certain methods are called. This can be done like so:</p>

<p><code>NSLog(@"%@: %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd));</code>
This can’t be moved into an Objective-C method because it will always log the name of that method. (Obviously it can’t be moved into a C method, as there is no self and no _cmd variables available.) Creating a macro for this is straightforward, however:</p>

<p><code>#define LOG_SELECTOR()  NSLog(@"%@: %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd));</code></p>

<p>Reference:<a href="http://weblog.highorderbit.com/post/11656225202/appropriate-use-of-c-macros-for-objective-c">Appropriate Use of C Macros for Objective-C Developers</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（七）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-7.html"/>
    <updated>2016-05-03T17:00:04+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-7</id>
    <content type="html"><![CDATA[<h3>1.如何设置透明的导航栏并且去掉其底部灰色的分隔线？</h3>

<p>A:可以通过设置导航栏的背景图和阴隐图为透明的图片来实现。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (void)viewDidAppear:(BOOL)animated
</span><span class='line'>{
</span><span class='line'>    [super viewDidAppear:animated];
</span><span class='line'>    
</span><span class='line'>    self.translucent = self.navigationController.navigationBar.isTranslucent;
</span><span class='line'>    self.navigationController.navigationBar.translucent = YES;
</span><span class='line'>    
</span><span class='line'>    self.previousImage = [self.navigationController.navigationBar backgroundImageForBarMetrics:UIBarMetricsDefault];
</span><span class='line'>    
</span><span class='line'>    UIImage *newImage = [UIImage imageNamed:@"TransparentPixel"];
</span><span class='line'>    [self.navigationController.navigationBar setBackgroundImage:newImage forBarMetrics:UIBarMetricsDefault];
</span><span class='line'>    
</span><span class='line'>    self.previousShadowImage = self.navigationController.navigationBar.shadowImage;
</span><span class='line'>    self.navigationController.navigationBar.shadowImage = newImage;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>- (void)viewWillDisappear:(BOOL)animated
</span><span class='line'>{
</span><span class='line'>    [super viewWillDisappear:animated];
</span><span class='line'>    
</span><span class='line'>    self.navigationController.navigationBar.translucent = self.translucent;
</span><span class='line'>    
</span><span class='line'>    [self.navigationController.navigationBar setBackgroundImage:self.previousImage forBarMetrics:UIBarMetricsDefault];
</span><span class='line'>    self.navigationController.navigationBar.shadowImage = self.previousShadowImage;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Reference:Apple&rsquo;s sample code Customizing UINavigationBar<br/>
<a href="http://stackoverflow.com/questions/18921082/separator-between-navigation-bar-and-view-ios-7">http://stackoverflow.com/questions/18921082/separator-between-navigation-bar-and-view-ios-7</a></p>

<!-- more -->


<h3>2. 自定义的View设置cornerRadius不生效</h3>

<h3>3. CocoaPods 升级到1.0，Xcode 一直报 header file not found.</h3>

<p>A: 仔细查看了 Xcode 的编译过程，头文件的路径是包含了的，于是怀疑是Xcode的自身可能存在问题。经过实验，可以用下面的方法解决：</p>

<ol>
<li>Clean project</li>
<li>Window > Projects > Your Project > Delete Derived Data</li>
<li>Build</li>
</ol>


<h3>4. No codesigning identities (i.e. certificate and private key pairs) that match the team ID: xxx</h3>

<p>A:</p>

<ul>
<li>Go to Xcode preferences, view details of the Apple ID, and delete the provisioning file that&rsquo;s complaining, redownload.</li>
<li>Go to the Keychain Access, and delete the development certificate that&rsquo;s related to the provisioning file you just deleted.</li>
</ul>


<p>Reference:<a href="http://stackoverflow.com/questions/19197497/ios-7-0-no-code-signing-identities-found">http://stackoverflow.com/questions/19197497/ios-7-0-no-code-signing-identities-found</a></p>

<h3>5. How to load image from CocoaPods resource bundle ?</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  s.resource_bundles = {
</span><span class='line'>    'DMLSelector' =&gt; ['DMLSelector/Assets/*.png']
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  NSBundle *bundle = [NSBundle bundleForClass:[self class]];
</span><span class='line'>  self.imageView.image = [UIImage imageNamed:@"DMLSelector.bundle/Checked" inBundle:bundle compatibleWithTraitCollection:nil];</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/23835052/load-image-from-cocoapods-resource-bundle">http://stackoverflow.com/questions/23835052/load-image-from-cocoapods-resource-bundle</a></p>

<h3>6. How to specify NSLineBreakMode in boundingRectWithSize?</h3>

<p>A: Use NSParagraphStyleAttributeName &amp; NSParagraphStyle:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>NSMutableParagraphStyle *paragraph = [[NSMutableParagraphStyle alloc] init];
</span><span class='line'>paragraph.lineBreakMode = NSLineBreakByWordWrapping; //e.g.
</span><span class='line'>
</span><span class='line'>CGSize size = [label.text boundingRectWithSize: constrainedSize options:NSStringDrawingUsesLineFragmentOrigin attributes: @{ NSFontAttributeName: label.font, NSParagraphStyleAttributeName: paragraph } context: nil].size;</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/20631464/how-to-specify-nslinebreakmode-in-boundingrectwithsize">http://stackoverflow.com/questions/20631464/how-to-specify-nslinebreakmode-in-boundingrectwithsize</a></p>

<h3>7.</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>INFO [2016-06-01 15:42:30.78]: ---------------------------------------------------------------------
</span><span class='line'>INFO [2016-06-01 15:42:30.78]: --- Step: fir p ../BBCApp.ipa -T token ---
</span><span class='line'>INFO [2016-06-01 15:42:30.78]: ---------------------------------------------------------------------
</span><span class='line'>INFO [2016-06-01 15:42:30.78]: $ fir p ../BBCApp.ipa -T c977500277789d01cc67d82750057858
</span><span class='line'>INFO [2016-06-01 15:42:34.31]: ▸ /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/dependency.rb:296:in `to_specs': Could not find 'fir-cli' (&gt;= 0) among 206 total gem(s) (Gem::LoadError)
</span><span class='line'>INFO [2016-06-01 15:42:34.31]: ▸ from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/dependency.rb:307:in `to_spec'
</span><span class='line'>INFO [2016-06-01 15:42:34.31]: ▸ from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_gem.rb:47:in `gem'
</span><span class='line'>INFO [2016-06-01 15:42:34.31]: ▸ from /usr/local/bin/fir:22:in `&lt;main&gt;'</span></code></pre></td></tr></table></div></figure>


<p>A: 问题的原因是找不到fir这个命令，可以直接指定绝对路径解决。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh "/Library/Ruby/Gems/2.0.0/gems/fir-cli-1.5.0/bin/fir p ../BBCApp.ipa -T token"</span></code></pre></td></tr></table></div></figure>


<h3>8. 怎么获取iPhone上已安装App的ipa文件？</h3>

<p>A: 可以利用iTunes下载已购的功能。</p>

<p>You can redownload apps on your iPhone or iPod touch, iPad, Mac or PC, or Apple TV (4th generation). You can also redownload some in-app purchases.</p>

<p>On a Mac or PC
From iTunes
1. Open iTunes.
2. Click Sign In, and then enter your Apple ID and password.
3. Click your name and select Purchased from the menu.
4. From the upper-right corner of the screen, click Apps.
5. Click &ldquo;Not in My Library&rdquo; to view purchased content that isn&rsquo;t on your computer.
6. Scroll to find the item that you want to download.
7. Click the Download icon  in the upper-right corner of the item that you want to download. Your app downloads to your library.</p>

<p>下载需要点时间，所以点开My Apps tab面不能马上看到刚下载的App,右上角有个下载进度提示，点击可以看详情。</p>

<p>Reference:<a href="https://support.apple.com/en-qa/HT201272">https://support.apple.com/en-qa/HT201272</a></p>

<h3>9. UICollectionView&rsquo;s cellForItemAtIndexPath is not being called</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>self.automaticallyAdjustsScrollViewInsets = NO;</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/14668781/uicollectionviews-cellforitematindexpath-is-not-being-called?rq=1">http://stackoverflow.com/questions/14668781/uicollectionviews-cellforitematindexpath-is-not-being-called?rq=1</a></p>

<h3>10. iOS supported audio formats?</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@"aac",@"adts",@"ac3",@"aif",@"aiff",@"aifc",@"caf",@"mp3",@"mp4",@"m4a",@"snd",@"au",@"sd2",@"wav"</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/1761460/supported-audio-file-formats-in-iphone">http://stackoverflow.com/questions/1761460/supported-audio-file-formats-in-iphone</a>
<a href="https://www.raywenderlich.com/69365/audio-tutorial-ios-file-data-formats-2014-edition">https://www.raywenderlich.com/69365/audio-tutorial-ios-file-data-formats-2014-edition</a></p>

<h3>11. How do I put the image on the right side of the text in a UIButton?</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CGFloat spacing          = 3;
</span><span class='line'>    CGFloat insetAmount      = 0.5 * spacing;
</span><span class='line'>
</span><span class='line'>    // First set overall size of the button:
</span><span class='line'>    button.contentEdgeInsets = UIEdgeInsetsMake(0, insetAmount, 0, insetAmount);
</span><span class='line'>    [button sizeToFit];
</span><span class='line'>
</span><span class='line'>    // Then adjust title and image insets so image is flipped to the right and there is spacing between title and image:
</span><span class='line'>    button.titleEdgeInsets   = UIEdgeInsetsMake(0, -button.imageView.frame.size.width - insetAmount, 0,  button.imageView.frame.size.width  + insetAmount);
</span><span class='line'>    button.imageEdgeInsets   = UIEdgeInsetsMake(0, button.titleLabel.frame.size.width + insetAmount, 0, -button.titleLabel.frame.size.width - insetAmount);</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/7100976/how-do-i-put-the-image-on-the-right-side-of-the-text-in-a-uibutton">http://stackoverflow.com/questions/7100976/how-do-i-put-the-image-on-the-right-side-of-the-text-in-a-uibutton</a></p>

<h3>12. duplicate symbol _iToastDuration</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum iToastDuration {
</span><span class='line'>  iToastDurationLong = 10000,
</span><span class='line'>  iToastDurationShort = 1000,
</span><span class='line'>  iToastDurationNormal = 3000
</span><span class='line'>}iToastDuration;</span></code></pre></td></tr></table></div></figure>


<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>typedef enum iToastDuration {
</span><span class='line'>  iToastDurationLong = 10000,
</span><span class='line'>  iToastDurationShort = 1000,
</span><span class='line'>  iToastDurationNormal = 3000
</span><span class='line'>}iToastDuration;</span></code></pre></td></tr></table></div></figure>


<h3>13. Detecting taps on attributed text in a UITextView in iOS</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>import UIKit
</span><span class='line'>class ViewController: UIViewController, UIGestureRecognizerDelegate {
</span><span class='line'>
</span><span class='line'>    @IBOutlet weak var textView: UITextView!
</span><span class='line'>
</span><span class='line'>    override func viewDidLoad() {
</span><span class='line'>        super.viewDidLoad()
</span><span class='line'>
</span><span class='line'>        // Create an attributed string
</span><span class='line'>        let myString = NSMutableAttributedString(string: "Swift attributed text")
</span><span class='line'>
</span><span class='line'>        // Set an attribute on part of the string
</span><span class='line'>        let myRange = NSRange(location: 0, length: 5) // range of "Swift"
</span><span class='line'>        let myCustomAttribute = [ "MyCustomAttributeName": "some value"]
</span><span class='line'>        myString.addAttributes(myCustomAttribute, range: myRange)
</span><span class='line'>
</span><span class='line'>        textView.attributedText = myString
</span><span class='line'>
</span><span class='line'>        // Add tap gesture recognizer to Text View
</span><span class='line'>        let tap = UITapGestureRecognizer(target: self, action: #selector(myMethodToHandleTap(_:)))
</span><span class='line'>        tap.delegate = self
</span><span class='line'>        textView.addGestureRecognizer(tap)
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    func myMethodToHandleTap(sender: UITapGestureRecognizer) {
</span><span class='line'>
</span><span class='line'>        let myTextView = sender.view as! UITextView
</span><span class='line'>        let layoutManager = myTextView.layoutManager
</span><span class='line'>
</span><span class='line'>        // location of tap in myTextView coordinates and taking the inset into account
</span><span class='line'>        var location = sender.locationInView(myTextView)
</span><span class='line'>        location.x -= myTextView.textContainerInset.left;
</span><span class='line'>        location.y -= myTextView.textContainerInset.top;
</span><span class='line'>
</span><span class='line'>        // character index at tap location
</span><span class='line'>        let characterIndex = layoutManager.characterIndexForPoint(location, inTextContainer: myTextView.textContainer, fractionOfDistanceBetweenInsertionPoints: nil)
</span><span class='line'>
</span><span class='line'>        // if index is valid then do something.
</span><span class='line'>        if characterIndex &lt; myTextView.textStorage.length {
</span><span class='line'>
</span><span class='line'>            // print the character index
</span><span class='line'>            print("character index: \(characterIndex)")
</span><span class='line'>
</span><span class='line'>            // print the character at the index
</span><span class='line'>            let myRange = NSRange(location: characterIndex, length: 1)
</span><span class='line'>            let substring = (myTextView.attributedText.string as NSString).substringWithRange(myRange)
</span><span class='line'>            print("character at index: \(substring)")
</span><span class='line'>
</span><span class='line'>            // check if the tap location has a certain attribute
</span><span class='line'>            let attributeName = "MyCustomAttributeName"
</span><span class='line'>            let attributeValue = myTextView.attributedText.attribute(attributeName, atIndex: characterIndex, effectiveRange: nil) as? String
</span><span class='line'>            if let value = attributeValue {
</span><span class='line'>               print("You tapped on \(attributeName) and the value is: \(value)")
</span><span class='line'>            }
</span><span class='line'>
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/19332283/detecting-taps-on-attributed-text-in-a-uitextview-in-ios?rq=1">http://stackoverflow.com/questions/19332283/detecting-taps-on-attributed-text-in-a-uitextview-in-ios?rq=1</a></p>

<h3>14. iOS 开发中如何获取农历？</h3>

<p>A: iOS 8 以后 Apple 内置了农历支持，可以得到类似<strong>2016丙申年五月十七星期二</strong>的信息，如果你只需要这些信息就够了，那使用内置的农历就可以了。如果还想获取类似<strong>壬辰年癸卯月庚辰日</strong>，那可以用<a href="https://github.com/autopear/LunarCalendar">LunarCalendar</a>。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>NSCalendar *chineseCalendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSCalendarIdentifierChinese];
</span><span class='line'>
</span><span class='line'>NSDateFormatter *dateFormatter = [NSDateFormatter new];
</span><span class='line'>dateFormatter.locale = [NSLocale localeWithLocaleIdentifier:@"zh_Hans_CN"];
</span><span class='line'>dateFormatter.dateStyle = NSDateFormatterFullStyle;
</span><span class='line'>dateFormatter.calendar = chineseCalendar;
</span><span class='line'>
</span><span class='line'>NSLog(@"%@", [dateFormatter stringFromDate:[NSDate date]]);
</span><span class='line'>
</span><span class='line'>// Output:2016丙申年五月十七星期二</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="https://www.quora.com/What-does-Apple-mean-when-it-says-iOS-8-will-include-lunar-calendar-support">https://www.quora.com/What-does-Apple-mean-when-it-says-iOS-8-will-include-lunar-calendar-support</a>
<a href="http://stackoverflow.com/questions/27878696/nscalendaridentifierrepublicofchina-vs-nscalendaridentifierchinese">http://stackoverflow.com/questions/27878696/nscalendaridentifierrepublicofchina-vs-nscalendaridentifierchinese</a></p>

<h3>15. How to fix tableView&rsquo;s tableHeaderView overlap first cell?</h3>

<p>A: The core of solution is when you change the frame of tableHeaderView, you need reassign it to tableView.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>UIView *headerView = self.tableHeaderView;
</span><span class='line'>
</span><span class='line'>[headerView setNeedsLayout];
</span><span class='line'>[headerView layoutIfNeeded];
</span><span class='line'>CGFloat height = [headerView systemLayoutSizeFittingSize:UILayoutFittingCompressedSize].height;
</span><span class='line'>
</span><span class='line'>headerView.frame = ({
</span><span class='line'>    CGRect headerFrame = headerView.frame;
</span><span class='line'>    headerFrame.size.height = height;
</span><span class='line'>    headerFrame;
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>self.tableHeaderView = headerView;</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/28782319/tableheaderview-on-top-of-first-cell">http://stackoverflow.com/questions/28782319/tableheaderview-on-top-of-first-cell</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（六）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-6.html"/>
    <updated>2016-03-28T20:14:53+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-6</id>
    <content type="html"><![CDATA[<h3>1. The data couldn’t be read because it isn’t in the correct format.</h3>

<p>A:项目是2014年开发的，打包导出 Ad-hoc 时报上面的错误，Build Setting > Enable Bitcode > NO 之后再试成功了。</p>

<p>Reference:<a href="http://stackoverflow.com/questions/33995769/ipatool-fails-to-build-with-bitcode-xcode-7-1-1">http://stackoverflow.com/questions/33995769/ipatool-fails-to-build-with-bitcode-xcode-7-1-1</a></p>

<h3>2.setNeedsLayout vs. setNeedsUpdateConstraints and layoutIfNeeded vs updateConstraintsIfNeeded</h3>

<p>A:</p>

<ul>
<li>If you manipulated constraints directly, call setNeedsLayout.</li>
<li>If you changed some conditions (like offsets or smth) which would change constraints in your overridden updateConstraints method (a recommended way to change constraints, btw), call setNeedsUpdateConstraints, and most of the time, setNeedsLayout after that.</li>
<li>If you need any of the actions above to have immediate effect—e.g. when your need to learn new frame height after a layout pass—append it with a layoutIfNeeded.</li>
</ul>


<p>Reference:<a href="http://stackoverflow.com/questions/20609206/setneedslayout-vs-setneedsupdateconstraints-and-layoutifneeded-vs-updateconstra">http://stackoverflow.com/questions/20609206/setneedslayout-vs-setneedsupdateconstraints-and-layoutifneeded-vs-updateconstra</a></p>

<h3>3.父类如何关联子类通过nib初始化的属性？</h3>

<p>A: Select xib > Show Utilities > Show The Connection In Inspector > + > Connect to View</p>

<!-- more -->


<h3>4. Failed to load test bundle from file</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Failed to load test bundle from file:///Users/dongmeiliang/Library/Developer/Xcode/DerivedData/JSQMessages-axyqhmblkssajpgcyzizcquhltft/Build/Products/Debug-iphonesimulator/JSQMessages.app/PlugIns/JSQMessagesTests.xctest/../JSQMessagesTests.xctest/: Error Domain=NSCocoaErrorDomain Code=4 "The bundle “$(PRODUCT_NAME)” couldn’t be loaded because its executable couldn’t be located." UserInfo={NSLocalizedFailureReason=The bundle’s executable couldn’t be located., NSLocalizedRecoverySuggestion=Try reinstalling the bundle., NSBundlePath=/Users/dongmeiliang/Library/Developer/Xcode/DerivedData/JSQMessages-axyqhmblkssajpgcyzizcquhltft/Build/Products/Debug-iphonesimulator/JSQMessages.app/PlugIns/JSQMessagesTests.xctest, NSLocalizedDescription=The bundle “$(PRODUCT_NAME)” couldn’t be loaded because its executable couldn’t be located.}</span></code></pre></td></tr></table></div></figure>


<p>A:Tests target > info.plist > delete the row <code>Bundle name $(PRODUCT_NAME)</code>;</p>

<h3>5. pathForResource:ofType:inDirectory:方法有时找不到图片？</h3>

<p>A:原因是这个方法必须要指定完整的名字，比如图片的名称为fail_indicator@2x.png，放在JSQMessagesAssets.bundle的images目录下，那可以用如下代码来获取这张图片：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>+ (NSBundle *)jsq_messagesBundle
</span><span class='line'>{
</span><span class='line'>    return [NSBundle bundleForClass:[JSQMessagesViewController class]];
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>+ (NSBundle *)jsq_messagesAssetBundle
</span><span class='line'>{
</span><span class='line'>    NSString *bundleResourcePath = [NSBundle jsq_messagesBundle].resourcePath;
</span><span class='line'>    NSString *assetPath = [bundleResourcePath stringByAppendingPathComponent:@"JSQMessagesAssets.bundle"];
</span><span class='line'>    return [NSBundle bundleWithPath:assetPath];
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>+ (UIImage *)jsq_imageFromMessagesAssetBundleWithName:(NSString *)name
</span><span class='line'>{
</span><span class='line'>    NSBundle *bundle = [NSBundle jsq_messagesAssetBundle];
</span><span class='line'>    NSString *path = [bundle pathForResource:name ofType:@"png" inDirectory:@"Images"];
</span><span class='line'>    return [UIImage imageWithContentsOfFile:path];
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>[UIImage jsq_imageFromMessagesAssetBundleWithName:@"fail_indicator@2x"];</span></code></pre></td></tr></table></div></figure>


<h3>6.自动布局的视图加上遮罩不生效而且视图上UIImageView的图片也不显示了,具体方法如下：</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (void)jsq_maskView:(UIView *)view withImage:(UIImage *)image
</span><span class='line'>{
</span><span class='line'>    NSParameterAssert(view != nil);
</span><span class='line'>    NSParameterAssert(image != nil);
</span><span class='line'>    
</span><span class='line'>    UIImageView *imageViewMask = [[UIImageView alloc] initWithImage:image];
</span><span class='line'>    imageViewMask.frame = CGRectInset(view.frame, 2.0f, 2.0f);
</span><span class='line'>    
</span><span class='line'>    view.layer.mask = imageViewMask.layer;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>A:先设置视图的frame。</p>

<h3>7. 设置视图的frame后，视图最终的坐标和设置的坐标不一致</h3>

<p>A:问题的原因是将translatesAutoresizingMaskIntoConstraints设置NO，然后再去设置视图的坐标，这样修改的坐标不会生效，解决办法就是使用坐标是不要将translatesAutoresizingMaskIntoConstraints设置为NO.</p>

<h3>8.设置视图遮罩时，遮罩以宿主视图的origin为原点，所以当宿主视图的origin不是(0, 0)时，设置遮罩的frame时要考虑将宿主视图的origin设置为(0, 0)之后再进行伸缩，最终得到遮罩的frame。</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (void)jsq_maskView:(UIView *)view withImage:(UIImage *)image
</span><span class='line'>{
</span><span class='line'>    NSParameterAssert(view != nil);
</span><span class='line'>    NSParameterAssert(image != nil);
</span><span class='line'>    
</span><span class='line'>    CGRect baseFrameForMask = view.frame;
</span><span class='line'>    baseFrameForMask.origin = CGPointZero;
</span><span class='line'>    
</span><span class='line'>    UIImageView *imageViewMask = [[UIImageView alloc] initWithImage:image];
</span><span class='line'>    imageViewMask.frame = CGRectInset(baseFrameForMask, 2.0f, 2.0f);
</span><span class='line'>
</span><span class='line'>    view.layer.mask = imageViewMask.layer;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h3>9.先调用方法二，然后调用方法一，最终的得到图片并没有水平翻转。</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// 1.
</span><span class='line'>- (UIImage *)jsq_imageMaskedWithColor:(UIColor *)maskColor
</span><span class='line'>{
</span><span class='line'>    NSParameterAssert(maskColor != nil);
</span><span class='line'>    
</span><span class='line'>    CGRect imageRect = CGRectMake(0.0f, 0.0f, self.size.width, self.size.height);
</span><span class='line'>    UIImage *newImage = nil;
</span><span class='line'>    
</span><span class='line'>    UIGraphicsBeginImageContextWithOptions(imageRect.size, NO, self.scale);
</span><span class='line'>    {
</span><span class='line'>        CGContextRef context = UIGraphicsGetCurrentContext();
</span><span class='line'>        
</span><span class='line'>        CGContextScaleCTM(context, 1.0f, -1.0f);
</span><span class='line'>        CGContextTranslateCTM(context, 0.0f, -(imageRect.size.height));
</span><span class='line'>        
</span><span class='line'>        CGContextClipToMask(context, imageRect, self.CGImage);
</span><span class='line'>        CGContextSetFillColorWithColor(context, maskColor.CGColor);
</span><span class='line'>        CGContextFillRect(context, imageRect);
</span><span class='line'>        
</span><span class='line'>        newImage = UIGraphicsGetImageFromCurrentImageContext();
</span><span class='line'>    }
</span><span class='line'>    UIGraphicsEndImageContext();
</span><span class='line'>    
</span><span class='line'>    return newImage;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>// 2.
</span><span class='line'>+ (UIImage *)imageWithCGImage:(CGImageRef)imageRef
</span><span class='line'>                        scale:(CGFloat)scale
</span><span class='line'>                  orientation:(UIImageOrientation)orientation</span></code></pre></td></tr></table></div></figure>


<p>Code Listing:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>UIImage *originImage = /* Get origin image*/
</span><span class='line'>
</span><span class='line'>UIImage *upMirroredImage = [UIImage imageWithCGImage:originImage.CGImage scale:originImage.scale orientation:UIImageOrientationUpMirrored];
</span><span class='line'>
</span><span class='line'>UIImage *upMirroredImageWithMaskedColor = [upMirroredImage jsq_imageMaskedWithColor:[UIColor grayColor]];</span></code></pre></td></tr></table></div></figure>


<p>A:调试中发现<code>+ (UIImage *)imageWithCGImage:(CGImageRef)imageRef scale:(CGFloat)scale orientation:(UIImageOrientation)orientation</code> 方法应该没有直接操作图片，而是更改了图片的metadata, 然后<code>- (UIImage *)jsq_imageMaskedWithColor:(UIColor *)maskColor</code>是直接操作图片时没有考虑图片的metadata,于是最终得到是原图加上指定颜色遮罩的图片。</p>

<h3>10. How to determine if an NSDate is today(Prior iOS 8)?</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>NSDate *today = nil;
</span><span class='line'>NSDate *beginningOfOtherDate = nil;
</span><span class='line'>
</span><span class='line'>NSDate *now = [NSDate date];
</span><span class='line'>[[NSCalendar currentCalendar] rangeOfUnit:NSDayCalendarUnit startDate:&today interval:NULL forDate:now];
</span><span class='line'>[[NSCalendar currentCalendar] rangeOfUnit:NSDayCalendarUnit startDate:&beginningOfOtherDate interval:NULL forDate:otherDate];
</span><span class='line'>
</span><span class='line'>if([today compare:beginningOfOtherDate] == NSOrderedSame) {
</span><span class='line'>    //otherDate is a date in the current day
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/2331129/how-to-determine-if-an-nsdate-is-today">http://stackoverflow.com/questions/2331129/how-to-determine-if-an-nsdate-is-today</a></p>

<h3>11. How do you resize an image?</h3>

<p>A:</p>

<ul>
<li>UIKit, Core Graphics, and Image I/O all perform well for scaling operations on most images.</li>
<li>Core Image is outperformed for image scaling operations. In fact, it is specifically recommended in the Performance Best Practices section of the Core Image Programming Guide to use Core Graphics or Image I/O functions to crop or downsample images beforehand.</li>
<li>For general image scaling without any additional functionality, UIGraphicsBeginImageContextWithOptions is probably the best option.</li>
<li>If image quality is a consideration, consider using CGBitmapContextCreate in combination with CGContextSetInterpolationQuality.</li>
<li>When scaling images with the intent purpose of displaying thumbnails, CGImageSourceCreateThumbnailAtIndex offers a compelling solution for both rendering and caching.</li>
<li>Unless you’re already working with vImage, the extra work to use the low-level Accelerate framework for resizing doesn’t pay off.</li>
</ul>


<p>Reference:<a href="http://nshipster.com/image-resizing/">http://nshipster.com/image-resizing/</a></p>

<h3>12. How can I deal with this warning: hash mismatch?</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>warning: hash mismatch: this object file was built against a different version of the module /Users/dongmeiliang/Library/Developer/Xcode/DerivedData/ModuleCache/1ZNHC044GWHJS/SystemConfiguration-1U17T3939DDG.pcm
</span></code></pre></td></tr></table></div></figure>


<p>A:Clean > Build
Reference:<a href="http://stackoverflow.com/questions/36467348/how-can-i-deal-with-this-warning-hash-mismatch">http://stackoverflow.com/questions/36467348/how-can-i-deal-with-this-warning-hash-mismatch</a></p>

<h3>13. Cocoa Coding Style Enforcement</h3>

<p>A:<a href="http://emlyn.net/posts/cocoa-coding-style-enforcement/">http://emlyn.net/posts/cocoa-coding-style-enforcement/</a></p>

<h3>14. Importing Swift into Objective-C Within the Same App Target</h3>

<p>A:</p>

<blockquote><p>When you import Swift code into Objective-C, you rely on an Xcode-generated header file to expose those files to Objective-C. This automatically generated file is an Objective-C header that declares the Swift interfaces in your target. It can be thought of as an umbrella header for your Swift code. The name of this header is your product module name followed by adding &ldquo;-Swift.h&rdquo;. (You’ll learn more about the product module name later, in Naming Your Product Module.)</p></blockquote>

<p>在同一个 App Target 中， 导入 Swift 到 Objective-C 只需要 <code>#import "ProductModuleName-Swift.h"</code>, 需要注意 ProductModuleName-Swift.h 是 Xcode 生成的文件，所以在工程中看不到，只需要在用到 Swift 的 Objective-C 文件中引用这个文件就好了。</p>

<p>Reference:<a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html#//apple_ref/doc/uid/TP40014216-CH10-ID138">https://developer.apple.com/library/ios/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html#//apple_ref/doc/uid/TP40014216-CH10-ID138</a></p>

<h3>15. Swift 中对应 Objectie-C 中的class 类方法</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tableView.registerClass(UITableViewCell.self, forCellReuseIdentifier: cellIdentifier)</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Notes Of Using Debian]]></title>
    <link href="http://DamianSheldon.github.io/blog/notes-of-using-debian.html"/>
    <updated>2016-02-29T21:46:20+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/notes-of-using-debian</id>
    <content type="html"><![CDATA[<h3>1. Install pear on Debian</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget http://pear.php.net/go-pear.phar
</span><span class='line'>$ sudo php go-pear.phar
</span><span class='line'>
</span><span class='line'>Below is a suggested file layout for your new PEAR installation.  To
</span><span class='line'>change individual locations, type the number in front of the
</span><span class='line'>directory.  Type 'all' to change all of them or simply press Enter to
</span><span class='line'>accept these locations.
</span><span class='line'>
</span><span class='line'> 1. Installation base ($prefix)                   : /home/meiliang/pear
</span><span class='line'> 2. Temporary directory for processing            : /tmp/pear/install
</span><span class='line'> 3. Temporary directory for downloads             : /tmp/pear/install
</span><span class='line'> 4. Binaries directory                            : /home/meiliang/pear/bin
</span><span class='line'> 5. PHP code directory ($php_dir)                 : /home/meiliang/pear/share/pear
</span><span class='line'> 6. Documentation directory                       : /home/meiliang/pear/docs
</span><span class='line'> 7. Data directory                                : /home/meiliang/pear/data
</span><span class='line'> 8. User-modifiable configuration files directory : /home/meiliang/pear/cfg
</span><span class='line'> 9. Public Web Files directory                    : /home/meiliang/pear/www
</span><span class='line'>10. System manual pages directory                 : /home/meiliang/pear/man
</span><span class='line'>11. Tests directory                               : /home/meiliang/pear/tests
</span><span class='line'>12. Name of configuration file                    : /home/meiliang/.pearrc
</span><span class='line'>
</span><span class='line'>1-12, 'all' or Enter to continue: 1
</span><span class='line'>(Use $prefix as a shortcut for '/home/meiliang/pear', etc.)
</span><span class='line'>Installation base ($prefix) [/home/meiliang/pear] : /usr/local/bin/pear
</span><span class='line'>
</span><span class='line'>$ vim .bashrc
</span><span class='line'># Append the /usr/local/bin/pear directory in the user's home directory onto the PATH environment variable
</span><span class='line'>export PATH=$PATH:/usr/local/bin/pear/bin
</span><span class='line'>
</span><span class='line'>// Reload bash configure file
</span><span class='line'>$ source .bashrc
</span><span class='line'>
</span><span class='line'>$ echo $PATH
</span><span class='line'>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/bin/pear/bin
</span><span class='line'>
</span><span class='line'>// Check wether it works
</span><span class='line'>$ pear version
</span><span class='line'>PEAR Version: 1.10.1
</span><span class='line'>PHP Version: 5.6.17-0+deb8u1
</span><span class='line'>Zend Engine Version: 2.6.0
</span><span class='line'>Running on: Linux Debian 3.16.0-4-amd64 #1 SMP Debian 3.16.7-ckt11-1 (2015-05-24) x86_64</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<h3>2. Install PHP GD extension on Debian</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo aptitude install php5-gd
</span><span class='line'>
</span><span class='line'>// How do I verify that php5-gd support loaded or not?
</span><span class='line'>// Type the following command at a shell prompt:
</span><span class='line'>$ php5 -m | grep -i gd
</span><span class='line'>
</span><span class='line'>Sample outputs:
</span><span class='line'>
</span><span class='line'>gd</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://www.cyberciti.biz/faq/ubuntu-linux-install-or-add-php-gd-support-to-apache/">http://www.cyberciti.biz/faq/ubuntu-linux-install-or-add-php-gd-support-to-apache/</a></p>

<h3>3. Install PHP cURL extension on Debian</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo aptitude install php5-curl</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/20073676/how-do-i-install-php-curl-on-linux-debian">http://stackoverflow.com/questions/20073676/how-do-i-install-php-curl-on-linux-debian</a></p>

<h3>4. Install PHP mCrypt extension on Debian</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ aptitude search mCrypt
</span><span class='line'>p   libmcrypt-dev                                                                    - De-/Encryption Library development files
</span><span class='line'>p   libmcrypt4                                                                       - De-/Encryption Library
</span><span class='line'>p   libtomcrypt-dev                                                                  - static library, header files and documentation for libtomcrypt
</span><span class='line'>p   libtomcrypt0                                                                     - public domain open source cryptographic toolkit
</span><span class='line'>p   mcrypt                                                                           - Replacement for old unix crypt(1)
</span><span class='line'>p   php5-mcrypt                                                                      - MCrypt module for php5
</span><span class='line'>
</span><span class='line'>$ sudo aptitude install php5-mcrypt
</span><span class='line'>$ sudo service apache2 restart</span></code></pre></td></tr></table></div></figure>


<h3>5. Default installation layouts for Apache HTTPD on Debian</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ServerRoot              ::      /etc/apache2
</span><span class='line'>DocumentRoot            ::      /var/www
</span><span class='line'>Apache Config Files     ::      /etc/apache2/apache2.conf
</span><span class='line'>                        ::      /etc/apache2/ports.conf
</span><span class='line'>Default VHost Config    ::      /etc/apache2/sites-available/default, /etc/apache2/sites-enabled/000-default
</span><span class='line'>Module Locations        ::      /etc/apache2/mods-available, /etc/apache2/mods-enabled
</span><span class='line'>ErrorLog                ::      /var/log/apache2/error.log
</span><span class='line'>AccessLog               ::      /var/log/apache2/access.log
</span><span class='line'>cgi-bin                 ::      /usr/lib/cgi-bin
</span><span class='line'>binaries (apachectl)    ::      /usr/sbin
</span><span class='line'>start/stop              ::      /etc/init.d/apache2 (start|stop|restart|reload|force-reload|start-htcacheclean|stop-htcacheclean)</span></code></pre></td></tr></table></div></figure>


<p>Notes:</p>

<ol>
<li>The Debian/Ubuntu layout is fully documented in /usr/share/doc/apache2/README.Debian</li>
<li>Debian/Ubuntu use symlinks to configure vhosts and load modules. Configuration files are created in their respective sites-available and mods-available directories. To activate vhosts and modules, symlinks are created in the respective sites-enabled and mods-enabled directories to the config files in either sites-available and mods-available. Debian provides scripts to handle this process called &lsquo;a2ensite&rsquo; and &lsquo;a2enmod&rsquo; which activates vhosts and modules.</li>
<li>The default vhost is defined in /etc/apache2/sites-available/default, and overrides the DocumentRoot set in the server context.</li>
</ol>


<p>Reference:<a href="http://wiki.apache.org/httpd/DistrosDefaultLayout#Debian.2C_Ubuntu_.28Apache_httpd_2.x.29:">http://wiki.apache.org/httpd/DistrosDefaultLayout#Debian.2C_Ubuntu_.28Apache_httpd_2.x.29:</a></p>

<h3>6. Can&rsquo;t connect to PPTP VPN with ufw enabled on Debian 3.16.7-ckt11-1 with kernel 3.16.0-4-amd64</h3>

<p>A: Allow Port 1723 on UFW</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ufw allow 1723</span></code></pre></td></tr></table></div></figure>


<p>This is caused by a change for security reason in kernel 3.18 [1]. There are two ways to fix this.</p>

<p>First approach is adding this rule to the file /etc/ufw/before.rules before the line # drop INVALID packets &hellip;</p>

<p>-A ufw-before-input -p 47 -j ACCEPT
Second approach is manually loading the nf_conntrack_pptp module. You can do this by running</p>

<p>sudo modprobe nf_conntrack_pptp
To load this module on every boot on Ubuntu, add it to the file /etc/modules.</p>

<p>Reference:<a href="http://askubuntu.com/questions/572497/cant-connect-to-pptp-vpn-with-ufw-enabled-on-ubuntu-14-04-with-kernel-3-18">http://askubuntu.com/questions/572497/cant-connect-to-pptp-vpn-with-ufw-enabled-on-ubuntu-14-04-with-kernel-3-18</a></p>

<p><a href="http://silverlinux.blogspot.com/2012/05/how-to-pptp-vpn-on-ubuntu-1204-pptpd.html">http://silverlinux.blogspot.com/2012/05/how-to-pptp-vpn-on-ubuntu-1204-pptpd.html</a></p>

<h2>7.OpenVPN server configure correct, but client can&rsquo;t brower web site block by GTW.</h2>

<p>A:There is a crue the the log of VPN client issue client DNS be used. So I think this may be the problem. YES, client can brower all web site after remove all client DNS settings.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>192.168.8.1
</span><span class='line'>202.103.96.112
</span><span class='line'>8.8.8.8
</span><span class='line'>208.67.222.222
</span><span class='line'>208.67.220.220</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-debian-8">https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-debian-8</a>
<a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-ubuntu-14-04#step-5---installing-the-client-profile">https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-ubuntu-14-04#step-5---installing-the-client-profile</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS Technical Interview Part 3]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-technical-interview-part-3.html"/>
    <updated>2016-02-25T18:43:44+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-technical-interview-part-3</id>
    <content type="html"><![CDATA[<h3>1.Difference between categories and extensions?</h3>

<p>A:There are two difference beween categories and extensions:</p>

<ol>
<li>The extension has no name;</li>
<li>The implementation of the extension must be in the main @implementation block of the file.</li>
</ol>


<p>Reference:<a href="http://stackoverflow.com/questions/3499704/difference-between-category-and-class-extension">http://stackoverflow.com/questions/3499704/difference-between-category-and-class-extension</a></p>

<h3>2.What is advantage of category?</h3>

<p>A:</p>

<ul>
<li>You can add method to existing class even to that class whose source is not available to you.</li>
<li>You can extend functionality of a class without subclassing.</li>
<li>You can split implementation in multiple classes.</li>
</ul>


<p>Reference:<a href="http://psri13.blogspot.com/2014/07/what-is-advantage-of-categories-what-is.html">http://psri13.blogspot.com/2014/07/what-is-advantage-of-categories-what-is.html</a></p>

<h3>3.What are KVO and KVC?</h3>

<p>A:</p>

<blockquote><p>Key-value observing is a mechanism that enables an object to be notified directly when a property of another object changes.
Key-value coding is a mechanism for indirectly accessing an object’s attributes and relationships using string identifiers.</p></blockquote>

<p>Reference:Cocoa Core Competencies</p>

<!-- more -->


<h3>4.Difference between shallow copy and deep copy?</h3>

<p>A:
The difference between shallow and deep copying is only relevant for compound objects (objects that contain other objects, like lists or class instances):</p>

<p>A shallow copy constructs a new compound object and then (to the extent possible) inserts references into it to the objects found in the original.
A deep copy constructs a new compound object and then, recursively, inserts copies into it of the objects found in the original.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/17246693/what-exactly-is-the-difference-between-shallow-copy-deepcopy-and-normal-assignm">http://stackoverflow.com/questions/17246693/what-exactly-is-the-difference-between-shallow-copy-deepcopy-and-normal-assignm</a></p>

<h3>5.When retain count increase?</h3>

<p>A:</p>

<ul>
<li>When you create an object;</li>
<li>When you send an object retain message;</li>
</ul>


<p>Reference:<a href="http://stackoverflow.com/questions/4254346/conditions-in-which-retaincount-increases-or-decreases">http://stackoverflow.com/questions/4254346/conditions-in-which-retaincount-increases-or-decreases</a></p>

<h3>6.If we don’t create any autorelease pool in our application then is there any autorelease pool already provided to us?</h3>

<p>A: Yes, there is a autorelease pool already provided to us.</p>

<h3>7.When you will create an autorelease pool in your application?</h3>

<p>A:There are three occasions when you might use your own autorelease pool blocks:</p>

<ul>
<li>If you are writing a program that is not based on a UI framework, such as a command-line tool.</li>
<li><p>If you write a loop that creates many temporary objects.
You may use an autorelease pool block inside the loop to dispose of those objects   before the next iteration. Using an autorelease pool block in the loop helps to  reduce the maximum memory footprint of the application.</p></li>
<li><p>If you spawn a secondary thread.
You must create your own autorelease pool block as soon as the thread begins executing; otherwise, your application will leak objects.</p></li>
</ul>


<h3>8.How many autorelease pool you can create in your application? Is there any limit?</h3>

<p>A: You can create autorelease pool as much as possible, there is no limit.</p>

<h3>9.What is purpose of delegates?</h3>

<p>A:Delegation is a simple and powerful pattern in which one object in a program acts on behalf of, or in coordination with, another object.</p>

<h3>10.What is difference between NSNotification and protocol?</h3>

<p>A:</p>

<ul>
<li>Protocol is To-one Relationships; NSNotification is To-many Relationships.</li>
<li>Protocol support bidirectional data-transfer between two classes.</li>
</ul>


<h3>11.Polymorphism？</h3>

<p>A: The ability of different objects to respond, each in its own way, to identical messages is called polymorphism.</p>

<h3>12.Singleton?</h3>

<p>A:A singleton class returns the same instance no matter how many times an application requests it.</p>

<h3>13.Give us example of what are delegate methods and what are data source methods of UITableView?</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Delegate methods
</span><span class='line'>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions;
</span><span class='line'>- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex;
</span><span class='line'>- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex;
</span><span class='line'>
</span><span class='line'> // Data source methods
</span><span class='line'> - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView;
</span><span class='line'> - (NSInteger)tableView:(UITalbleView *)tableView numberOfRowsInSections:(NSInteger)section;
</span><span class='line'> - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath;
</span></code></pre></td></tr></table></div></figure>


<h3>14.What are mutable and immutable types in Objective C?</h3>

<p>A:A mutable object can be mutated or changed. An immutable object cannot.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/7071096/what-is-difference-between-mutable-and-immutable">http://stackoverflow.com/questions/7071096/what-is-difference-between-mutable-and-immutable</a></p>

<h3>15.When to use NSMutableArray and when to use NSArray?</h3>

<p>A:When collection will mutable you should use NSMutableArray, otherwise use NSArray.</p>

<h3>16.What is convenience constructor?</h3>

<p>A:A convenience constructor is one that performs object allocation &amp; initialization in one step &amp; returns an autoreleased object to the caller.</p>

<p>Reference:<a href="https://www.quora.com/Objective-C-programming-language/What-is-a-convenience-constructor">https://www.quora.com/Objective-C-programming-language/What-is-a-convenience-constructor</a></p>

<h3>17.What is responder chain?</h3>

<p>A:The responder chain is a series of linked responder objects.</p>

<h3>18.What is push notification?</h3>

<p>A:Apple Push Notification service (APNs for short) is the centerpiece of the remote notifications feature. It is a robust and highly efficient service for propagating information to iOS and OS X devices. Each device establishes an accredited and encrypted IP connection with the service and receives notifications over this persistent connection. If a notification for an app arrives when that app is not running, the device alerts the user that the app has data waiting for it.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS Technical Interview Part 2]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-technical-interview-part-2.html"/>
    <updated>2016-02-25T16:54:55+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-technical-interview-part-2</id>
    <content type="html"><![CDATA[<ol>
<li><p>@property中有哪些属性关键字？/ @property 后面可以有哪些修饰符？<br/>
 A:</p>

<ul>
<li>Write Serialization(not general thread safety): nonatomic atomic (default)</li>
<li>Mutability: readonly readwrite (default)</li>
<li>API Contron :getter = methodname setter = mehtodname:</li>
<li>Memory Management: copy strong (default) weak unsafe_unretained assign</li>
</ul>
</li>
<li><p>ARC下，不显式指定任何属性关键字时，默认的关键字都有哪些？<br/>
 A:</p>

<ul>
<li>Write Serialization: atomic</li>
<li>Mutability: readwrite</li>
<li>Memory Management: assign(non-object) strong(object)</li>
</ul>
</li>
<li><p>什么情况使用 weak 关键字，相比 assign 有什么不同？<br/>
 A:
 什么情况使用 weak 关键字？</p>

<ul>
<li>强引用关系的对象会发生循环引用时用weak关键字；</li>
<li>已经被强引用的对象，如Interface Builder创建的视图被声明为weak。</li>
</ul>


<p> weak 相比 assign 有什么不同？</p>

<ul>
<li>weak 必须修饰对象，assign还可以修饰非对象；</li>
<li>weak 修饰的属性所指向的对象销毁后，该属性会被置为nil，而assign修改的属性所指向的对象销毁后，属性仍然指向对象分配的内存地址成为野指针。</li>
</ul>
</li>
</ol>


<!-- more -->


<ol>
<li><p>weak属性需要在dealloc中置nil么？<br/>
 A: 不需要，因为 weak 属性不影响对象的引用计数。</p></li>
<li><p>用@property声明的NSString（或NSArray，NSDictionary）经常使用copy关键字，为什么？如果改用strong关键字，可能造成什么问题？</p>

<ul>
<li>对非集合类对象的copy操作</li>
<li>集合类对象的copy与mutableCopy</li>
</ul>


<p> A:
 为什么？
 因为父类指针可以指向子类对象,而使用 copy 可以让本对象的属性不受外界影响,无论给我传入是一个可变对象还是不可对象,我本身持有的就是一个不可变的副本.</p>

<p> 如果改用strong关键字，可能造成什么问题？
 如果我们使用是 strong ,那么这个属性就有可能指向一个可变对象,如果这个可变对象在外部被修改了,那么会影响该属性.</p>

<p> 非集合类对象的copy与mutableCopy：
 对 immutable 对象进行 copy 操作，是指针复制，mutableCopy 操作时内容复制；对 mutable 对象进行 copy 和 mutableCopy 都是内容复制。用代码简单表示如下：</p>

<pre><code class="`"> [immutableObject copy] // 浅复制
 [immutableObject mutableCopy] //深复制
 [mutableObject copy] //深复制
 [mutableObject mutableCopy] //深复制
</code></pre>

<p> 实例验证：</p>

<pre><code class="`"> NSMutableString *string = [NSMutableString stringWithString:@"origin"];//copy
 NSString *stringCopy = [string copy];

 // 查看内存，会发现 string、stringCopy 内存地址都不一样，说明此时都是做内容拷贝、深拷贝。即使你进行如下操作：
 [string appendString:@"origion!"]

 // stringCopy 的值也不会因此改变，但是如果不使用 copy，stringCopy 的值就会被改变。
</code></pre>

<p> 集合类对象的copy与mutableCopy:
 对 immutable 对象进行 copy，是指针复制， mutableCopy 是内容复制；对 mutable 对象进行 copy 和 mutableCopy 都是内容复制。但是：集合对象的内容复制仅限于对象本身，对象元素仍然是指针复制。用代码简单表示如下：</p>

<pre><code class="`"> [immutableObject copy] // 浅复制
 [immutableObject mutableCopy] //单层深复制
 [mutableObject copy] //单层深复制
 [mutableObject mutableCopy] //单层深复制
</code></pre>

<p> 实例验证：</p>

<pre><code class="`"> // 下面先看集合类immutable对象使用 copy 和 mutableCopy 的一个例子：
 NSArray *array = @[@[@"a", @"b"], @[@"c", @"d"]];
 NSArray *copyArray = [array copy];
 NSMutableArray *mCopyArray = [array mutableCopy];
 // 查看内容，可以看到 copyArray 和 array 的地址是一样的，而 mCopyArray 和 array 的地址   是不同的。说明 copy 操作进行了指针拷贝，mutableCopy 进行了内容拷贝。但需要强调的是：此处的内   容拷贝，仅仅是拷贝 array 这个对象，array 集合内部的元素仍然是指针拷贝。这和上面的非集合    immutable 对象的拷贝还是挺相似的，那么mutable对象的拷贝会不会类似呢？我们继续往下，看     mutable 对象拷贝的例子：

 NSMutableArray *array = [NSMutableArray arrayWithObjects:[NSMutableString   stringWithString:@"a"],@"b",@"c",nil];
 NSArray *copyArray = [array copy];
 NSMutableArray *mCopyArray = [array mutableCopy];

 // 查看内存，如我们所料，copyArray、mCopyArray和 array 的内存地址都不一样，说明    copyArray、mCopyArray 都对 array 进行了内容拷贝。
</code></pre></li>
<li><p>这个写法会出什么问题： @property (copy) NSMutableArray *array?<br/>
 A:问题一：由于属性声明为 copy, 所以它最终指向的是一个 NSArray，对它调用 NSMutableArray 中定义的方法会导致应用奔溃；
 问题二：如果是开发 iOS 程序，这会影响性能。</p></li>
<li><p>怎么用 copy 关键字？<br/>
 A:声明为属性的类遵守 NSCopying 协议，而且我们希望设置新值时保存一份自己的拷贝。</p></li>
<li><p>如何让自己的类用 copy 修饰符？如何重写带 copy 关键字的 setter？<br/>
 A:</p>

<blockquote><p>Any object that you wish to set for a copy property must support NSCopying, which means that it should conform to the NSCopying protocol.
Only classes that define an “immutable vs. mutable” distinction should adopt this protocol.</p></blockquote></li>
<li><p>protocol 和 category 中如何使用 @property?<br/>
 A:</p>

<ul>
<li>protocol 使用 property 和 class 类似，只是 protocol 的 property 只会生成相应 getter 和 setter 方法声明，遵守协议的类需要实现相应的 getter 和 setter 方法；</li>
<li>category 使用 property 和 class 有点区别，主要原因是 category 不支持添加实例变量，所以 category 中可以声明组合已有类 property 的 readonly 修饰的便捷 property；或者通过关联引用来辅助实现 getter 和 setter 方法。</li>
</ul>
</li>
<li><p>@property 的本质是什么？ivar、getter、setter 是如何生成并添加到这个类中的?<br/>
A:@property 的本质是什么？
    @property = ivar + getter + setter;</p>

<p>ivar、getter、setter 是如何生成并添加到这个类中的?
“自动合成”( autosynthesis)
完成属性定义后，编译器会自动编写访问这些属性所需的方法，此过程叫做“自动合成”(autosynthesis)。需要强调的是，这个过程由编译器在编译期执行，所以编辑器里看不到这些“合成方法”(synthesized method)的源代码。除了生成方法代码 getter、setter 之外，编译器还要自动向类中添加适当类型的实例变量，并且在属性名前面加下划线，以此作为实例变量的名字。</p></li>
<li><p>@synthesize和@dynamic分别有什么作用？<br/>
A:</p>

<ul>
<li>@synthesize 是告诉编译器怎么去合成相应属性的 getter 和 setter 方法；</li>
<li>@dynamic 告诉编译器属性的 setter 与 getter 方法由用户自己实现，不自动合成。</li>
</ul>
</li>
<li><p>在有了自动合成属性实例变量之后，@synthesize还有哪些使用场景？<br/>
A:</p>

<ul>
<li>自定义自动合成的实例变量的名称；</li>
<li>自动合成协议中声明 getter 和 setter 方法。</li>
</ul>
</li>
<li><p>@synthesize合成实例变量的规则是什么？假如property名为foo，存在一个名为<em>foo的实例变量，那么还会自动合成新变量么？<br/>
A:
@synthesize合成实例变量的规则是什么？
假设声明了propertyname的属性，默认会合成</em>propertyname的实例变量，也可以自定义合成实例变量的名称，如果目标合成实例变量已经存在则不再合成。</p>

<p>假如property名为foo，存在一个名为_foo的实例变量，那么还会自动合成新变量么？
不会。</p></li>
<li><p>ARC通过什么方式帮助开发者管理内存？<br/>
A:</p>

<blockquote><p>ARC works by adding code at compile time to ensure that objects live as long as necessary, but no longer.</p></blockquote></li>
<li><p>objc使用什么机制管理对象内存？<br/>
A: 引用计数机制。</p></li>
<li><p>不手动指定autoreleasepool的前提下，一个autorealese对象在什么时刻释放？（比如在一个vc的viewDidLoad中创建）<br/>
A: Autorelease对象出了作用域之后，会被添加到最近一次创建的自动释放池中，并会在当前的 runloop 迭代结束时释放。如果在一个vc的viewDidLoad中创建一个 Autorelease对象，那么该对象会在 viewDidAppear 方法执行前就被销毁了。</p></li>
<li><p>苹果是如何实现autoreleasepool的?<br/>
A:</p></li>
<li><p>使用block时什么情况会发生引用循环，如何解决？<br/>
A:一个对象中强引用了block，在block中又使用了该对象，就会发生循环引用。
解决方法是将该对象使用<code>__weak</code>或者<code>__block</code>修饰符修饰之后再在block中使用。</p>

<ul>
<li>id weak weakSelf = self，或者 weak __typeof(self)weakSelf = self</li>
<li>id __block weakSelf = self;</li>
</ul>
</li>
<li><p>在block内如何修改block外部变量？<br/>
A:使用 _block 存储类型修饰外部变量。</p></li>
<li><p>使用系统的某些block api（如UIView的block版本写动画时），是否也考虑引用循环问题？
A:使用系统的block api要不要考虑引用循环问题取决于它会不会造成引用循环，如果不会造成引用循环则不需要考虑，反之则需要考虑。UIView的block版本写动画时不需要考虑引用循环问题。</p></li>
<li><p>IBOutlet连出来的视图属性为什么可以被设置成weak?<br/>
A:IBOutlet 连出来的视图是视图层级的组成部分，对它已经有一个强引用，所以它可以被设置为 weak。</p></li>
<li><p>IB中User Defined Runtime Attributes如何使用？<br/>
A:</p>

<blockquote><p>Add initialization of custom runtime attributes to objects that do not have a corresponding Interface Builder inspector.</p></blockquote></li>
<li><p>若一个类有实例变量 NSString *<em>foo ，调用setValue:forKey:时，可以以foo还是 </em>foo 作为key？<br/>
A:都可以。</p></li>
<li><p>KVC的keyPath中的集合运算符如何使用？<br/>
A:</p>

<ul>
<li>必须是集合对象</li>
<li>KVC支持的集合运算符</li>
<li>正确的  Operator key path 格式</li>
</ul>
</li>
<li><p>KVC和KVO的keyPath一定是属性么？<br/>
A:KVO支持实例变量。</p></li>
<li><p>addObserver:forKeyPath:options:context:各个参数的作用分别是什么，observer中需要实现哪个方法才能获得KVO回调？<br/>
A:</p>

<table>
<thead>
<tr>
<th> Parameter </th>
<th> Function </th>
</tr>
</thead>
<tbody>
<tr>
<td> anObserver </td>
<td> The object to register for KVO notifications. The observer must implement the key-value observing method observeValueForKeyPath:ofObject:change:context:. </td>
</tr>
<tr>
<td> keyPath </td>
<td> The key path, relative to the receiver, of the property to observe. This value must not be nil. </td>
</tr>
<tr>
<td> options </td>
<td> A combination of the NSKeyValueObservingOptions values that specifies what is included in observation notifications. For possible values, see NSKeyValueObservingOptions. </td>
</tr>
<tr>
<td> context </td>
<td> Arbitrary data that is passed to anObserver in observeValueForKeyPath:ofObject:change:context:. </td>
</tr>
</tbody>
</table>
</li>
</ol>


<p>observer中需要实现- observeValueForKeyPath:ofObject:change:context:才能获得KVO回调。</p>

<ol>
<li><p>如何手动触发一个value的KVO?<br/>
A:改变值之前调用 willChangeValueForKey:，改变值之后调用 didChangeValueForKey:。</p></li>
<li><p>如何关闭默认的KVO的默认实现，并进入自定义的KVO实现？<br/>
A:</p>

<ul>
<li>A class that implements manual notification must override the NSObject implementation of automaticallyNotifiesObserversForKey:.For properties that perform manual notification, the subclass implementation of automaticallyNotifiesObserversForKey: should return NO.</li>
<li>To implement manual observer notification, you invoke willChangeValueForKey: before changing the value, and didChangeValueForKey: after changing the value.</li>
</ul>
</li>
<li><p>apple用什么方式实现对一个对象的KVO？<br/>
A:</p>

<blockquote><p>Automatic key-value observing is implemented using a technique called isa-swizzling.</p></blockquote></li>
<li><p>GCD的队列（dispatch_queue_t）分哪两种类型？<br/>
A:</p>

<ul>
<li>DISPATCH_QUEUE_SERIAL</li>
<li>DISPATCH_QUEUE_CONCURRENT</li>
</ul>
</li>
<li><p>如何用GCD同步若干个异步调用？（如根据若干个url异步加载多张图片，然后在都下载完成后合成一张整图）<br/>
A:</p>

<blockquote><p>Dispatch groups are a way to block a thread until one or more tasks finish executing.</p></blockquote>

<pre><code>    dispatch_queue_t queue =        dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    dispatch_group_t group = dispatch_group_create();
    dispatch_group_async(group, queue, ^{ /*加载图片1 */ });
    dispatch_group_async(group, queue, ^{ /*加载图片2 */ });
    dispatch_group_async(group, queue, ^{ /*加载图片3 */ }); 
    dispatch_group_notify(group, dispatch_get_main_queue(), ^{
            // 合并图片
    });
</code></pre></li>
<li><p>dispatch_barrier_async的作用是什么？<br/>
A:</p>

<blockquote><p>Submits a barrier block for asynchronous execution and returns immediately.
A dispatch barrier allows you to create a synchronization point within a concurrent dispatch queue. When it encounters a barrier, a concurrent queue delays the execution of the barrier block (or any further blocks) until all blocks submitted before the barrier finish executing. At that point, the barrier block executes by itself. Upon completion, the queue resumes its normal execution behavior.</p></blockquote></li>
<li><p>苹果为什么要废弃dispatch_get_current_queue？<br/>
A:dispatch_get_current_queue 容易造成死锁。</p></li>
<li><p>以下代码运行结果如何？</p></li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (void)viewDidLoad
</span><span class='line'>{
</span><span class='line'>  [super viewDidLoad];
</span><span class='line'>  NSLog(@"1");
</span><span class='line'>  dispatch_sync(dispatch_get_main_queue(), ^{
</span><span class='line'>      NSLog(@"2");
</span><span class='line'>  });
</span><span class='line'>  NSLog(@"3");
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>A: 只输出：1 。发生主线程锁死。</p>

<ol>
<li><p>runloop和线程有什么关系？<br/>
A:</p>

<blockquote><p>Run loops are intended for situations where you want more interactivity with the thread.</p></blockquote>

<p>当我们和线程有很多交互时，可以为线程配置一个 RunLoop.</p>

<pre><code>- (void)networkRunLoopThreadEntry
// This thread runs all of our network operation run loop callbacks.
{
assert( ! [NSThread isMainThread] );
while (YES) {
    NSAutoreleasePool * pool;

    pool = [[NSAutoreleasePool alloc] init];
    assert(pool != nil);

    [[NSRunLoop currentRunLoop] run];

    [pool drain];
}
assert(NO);
}
</code></pre></li>
<li><p>runloop的mode作用是什么？<br/>
A:</p>

<blockquote><p>A run loop mode is a collection of input sources and timers to be monitored and a collection of run loop observers to be notified.
Each time you run your run loop, you specify (either explicitly or implicitly) a particular “mode” in which to run. During that pass of the run loop, only sources associated with that mode are monitored and allowed to deliver their events. (Similarly, only observers associated with that mode are notified of the run loop’s progress.) Sources associated with other modes hold on to any new events until subsequent passes through the loop in the appropriate mode.</p></blockquote></li>
</ol>


<p>mode的作用是设置好需要监控的 input sources 和 timers，以及需要通知的 run loop observers。</p>

<ol>
<li>以+ scheduledTimerWithTimeInterval&hellip;的方式触发的timer，在滑动页面上的列表时，timer会暂定回调，为什么？如何解决？<br/>
A:滑动页面的列表时 RunLoop 会从 NSDefaultRunLoopMode 切换到 NSEventTrackingRunLoopMode，而以+ scheduledTimerWithTimeInterval&hellip;的方式触发的timer默认是在 NSDefaultRunLoopMode 下被监控，所以会出现暂停回调。</li>
</ol>


<p>如何解决？
解决办法自然是希望 timer 触发的事件不被限制，也就是说在 NSEventTrackingRunLoopMode 下也能被监控，可以通过把 timer 加入到 NSRunLoopCommonModes 中，因为关联到它的 timer 也会被相应关联到 NSEventTrackingRunLoopMode 中。</p>

<blockquote><p>NSRunLoopCommonModes (Cocoa)
kCFRunLoopCommonModes (Core Foundation)
This is a configurable group of commonly used modes. Associating an input source with this mode also associates it with each of the modes in the group. For Cocoa applications, this set includes the default, modal, and event tracking modes by default. Core Foundation includes just the default mode initially. You can add custom modes to the set using the CFRunLoopAddCommonMode function.</p></blockquote>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//将timer添加到NSDefaultRunLoopMode中
</span><span class='line'>[NSTimer scheduledTimerWithTimeInterval:1.0
</span><span class='line'>     target:self
</span><span class='line'>     selector:@selector(timerTick:)
</span><span class='line'>     userInfo:nil
</span><span class='line'>     repeats:YES];
</span><span class='line'>//然后再添加到NSRunLoopCommonModes里
</span><span class='line'>NSTimer *timer = [NSTimer timerWithTimeInterval:1.0
</span><span class='line'>     target:self
</span><span class='line'>     selector:@selector(timerTick:)
</span><span class='line'>     userInfo:nil
</span><span class='line'>     repeats:YES];
</span><span class='line'>[[NSRunLoop currentRunLoop] addTimer:timer forMode:NSRunLoopCommonModes];</span></code></pre></td></tr></table></div></figure>


<ol>
<li><p>猜想runloop内部是如何实现的？<br/>
A:</p>

<blockquote><p>It is a loop your thread enters and uses to run event handlers in response to incoming events.</p></blockquote></li>
<li><p>runtime 如何实现 weak 属性?/runtime如何实现weak变量的自动置nil？<br/>
A:runtime 对注册的类， 会进行布局，对于 weak 对象会放入一个 hash 表中。 用 weak 指向的对象内存地址作为 key，当此对象的引用计数为0的时候会 dealloc，假如 weak 指向的对象内存地址是a，那么就会以a为键， 在这个 weak 表中搜索，找到所有以a为键的 weak 对象，从而设置为 nil。</p></li>
<li><p>objc中向一个对象发送消息[obj foo]和objc_msgSend()函数之间有什么关系？<br/>
A:</p>

<blockquote><p>In Objective-C, messages aren’t bound to method implementations until runtime.
The compiler converts a message expression,</p></blockquote></li>
</ol>


<blockquote><p>[receiver message]
into a call on a messaging function, objc_msgSend.</p></blockquote>

<p>编译器会把向一个对象发送的消息转化成一次objc_msgSend()函数调用。</p>

<ol>
<li><p>objc中向一个nil对象发送消息将会发生什么？<br/>
A:</p>

<ul>
<li>如果一个方法返回值是一个对象，那么发送给nil的消息将返回nil;</li>
<li>如果方法返回值为指针类型，其指针大小为小于或者等于sizeof(void*)，float，double，long double 或者 long long 的整型标量，发送给 nil 的消息将返回0;</li>
<li>如果方法返回值为结构体,发送给 nil 的消息将返回0。结构体中各个字段的值将都是0</li>
<li>如果方法的返回值不是上述提到的几种情况，那么发送给 nil 的消息的返回值将是未定义的</li>
</ul>
</li>
<li><p><em>objc_msgForward 函数是做什么的，直接调用它将会发生什么？<br/>
A:当向一个对象发送一条消息，但它并没有实现的时候，</em>objc_msgForward会尝试做消息转发。直接调用_objc_msgForward是非常危险的事，如果用不好会直接导致程序Crash，但是如果用得好，能做很多非常酷的事。</p></li>
<li><p>能否向编译后得到的类中增加实例变量？能否向运行时创建的类中添加实例变量？为什么？<br/>
A:</p>

<ul>
<li>不能向编译后得到的类中增加实例变量；</li>
<li>能向运行时创建的类中添加实例变量；</li>
</ul>
</li>
</ol>


<p>解释:</p>

<pre><code>* 因为编译后的类已经注册在 runtime 中，类结构体中的 objc_ivar_list 实例变量的链表 和 instance_size 实例变量的内存大小已经确定，同时runtime 会调用 class_setIvarLayout 或 class_setWeakIvarLayout 来处理 strong weak 引用。所以不能向存在的类中添加实例变量；
* 运行时创建的类是可以添加实例变量，调用 class_addIvar 函数。但是得在调用 objc_allocateClassPair 之后，objc_registerClassPair 之前，原因同上。
</code></pre>

<ol>
<li><p>一个objc对象如何进行内存布局？（考虑有父类的情况）<br/>
A:
Objective-C 对象的结构图
ISA指针
根类的实例变量
倒数第二层父类的实例变量
&hellip;
父类的实例变量
类的实例变量</p></li>
<li><p>一个objc对象的isa的指针指向什么？有什么作用？<br/>
A:</p>

<blockquote><p>The isa pointer, as the name suggests, points to the object&rsquo;s class which maintains a dispatch table.</p></blockquote></li>
</ol>


<p>指向对象的类。</p>

<ol>
<li>下面的代码输出什么？</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@implementation Son : Father
</span><span class='line'>- (id)init
</span><span class='line'>{
</span><span class='line'>    self = [super init];
</span><span class='line'>    if (self) {
</span><span class='line'>        NSLog(@"%@", NSStringFromClass([self class]));
</span><span class='line'>        NSLog(@"%@", NSStringFromClass([super class]));
</span><span class='line'>    }
</span><span class='line'>    return self;
</span><span class='line'>}
</span><span class='line'>@end</span></code></pre></td></tr></table></div></figure>


<p>A:都输出 Son.
super 是一个 Magic Keyword， 它本质是一个编译器标示符，和 self 是指向的同一个消息接受者！他们两个的不同点在于：super 会告诉编译器，调用 class 这个方法时，要去父类的方法，而不是本类里的。</p>

<ol>
<li><p>什么时候会报unrecognized selector的异常？<br/>
A:当调用该对象上某个方法,而该对象上没有实现这个方法的时候。</p></li>
<li><p>BAD_ACCESS在什么情况下出现？<br/>
A:</p>

<ul>
<li>访问了野指针，比如对一个已经释放的对象执行了release、访问已经释放对象的成员变量或者发消息。</li>
<li>死循环</li>
</ul>
</li>
<li><p>如何调试BAD_ACCESS错误?<br/>
A:</p>

<ul>
<li>Enable Zombie Objects</li>
<li>Enable Address Sanitizer</li>
<li>重写object的respondsToSelector方法，显示出现EXEC_BAD_ACCESS前访问的最后一个object</li>
</ul>
</li>
<li><p>lldb（gdb）常用的调试命令？<br/>
A:</p></li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>lldb po
</span><span class='line'>lldb p
</span><span class='line'>lldb expression
</span><span class='line'>lldb bt
</span><span class='line'>lldb c</span></code></pre></td></tr></table></div></figure>


<ol>
<li><p>使用runtime Associate方法关联的对象，需要在主对象dealloc的时候释放么？<br/>
A:不需要。</p></li>
<li><p>runtime如何通过selector找到对应的IMP地址？（分别考虑类方法和实例方法）<br/>
A:每一个类对象或对象中有一个方法列表,方法列表中记录着方法的名称,方法实现,以及参数类型,其实selector本质就是方法名称,通过这个方法名称就可以在方法列表中找到对应的方法实现.</p></li>
<li><p>objc中的类方法和实例方法有什么本质区别和联系？<br/>
A:
类方法：</p></li>
</ol>


<p>类方法是属于类对象的
类方法只能通过类对象调用
类方法中的self是类对象
类方法可以调用其他的类方法
类方法中不能访问成员变量
类方法中不定直接调用对象方法</p>

<p>实例方法：</p>

<p>实例方法是属于实例对象的
实例方法只能通过实例对象调用
实例方法中的self是实例对象
实例方法中可以访问成员变量
实例方法中直接调用实例方法
实例方法中也可以调用类方法(通过类名)</p>

<p>扩展阅读：<br/>
o <a href="http://onevcat.com/2013/04/ios-interview/">上级向的十个iOS面试问题</a><br/>
o <a href="http://studentdeng.github.io/blog/2014/02/11/baidu-interview/">百度面试</a></p>

<p>Reference:<br/>
o <a href="http://blog.sunnyxx.com/2015/07/04/ios-interview/">http://blog.sunnyxx.com/2015/07/04/ios-interview/</a><br/>
o <a href="https://github.com/ChenYilong/iOSInterviewQuestions">https://github.com/ChenYilong/iOSInterviewQuestions</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Notes Of Using OpenCart]]></title>
    <link href="http://DamianSheldon.github.io/blog/notes-of-using-opencart.html"/>
    <updated>2016-02-21T17:50:35+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/notes-of-using-opencart</id>
    <content type="html"><![CDATA[<h3>1. opencart 安装中文语言包</h3>

<p>A:</p>

<ul>
<li>[下载中文语言包](<a href="http://www.opencart.cn/thread-9982-1-1.html%EF%BC%89">http://www.opencart.cn/thread-9982-1-1.html%EF%BC%89</a></li>
<li>解压压缩包，里面有两个文件夹，admin是后台语言包，catalog文件是前台语言包</li>
<li>把文件上传到对应的目录下</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd ~/Downloads/
</span><span class='line'>$ tar -xzvf OpenCart_SimplifiedChinese_language_v2.0.3.1.zip
</span><span class='line'>$ cp -R OpenCart_SimplifiedChinese_language_v2.0.3.1/upload/catalog/language/zh-CN  ~/Sites/upload/catalog/language/
</span><span class='line'>$ cp -R OpenCart_SimplifiedChinese_language_v2.0.3.1/upload/admin/language/zh-CN ~/Sites/upload/admin/language/</span></code></pre></td></tr></table></div></figure>


<ul>
<li>System > Localisation > languages > + > Chinese(Language Name) > Code(select zh-CN) > Save</li>
<li>System > Settings > Your Store > Edit > Local > Language (Chinese) > Administration Language (Chinese) > Save</li>
</ul>


<h3>2. opencart如何增加人民币？</h3>

<p>A:</p>

<ul>
<li><p>系统设置 > 参数设置 > 货币设置 > +</p>

<ul>
<li>货币名称 人民币</li>
<li>货币代码 CNY</li>
<li>左符号 ¥</li>
<li>右符号</li>
<li>小数位 2</li>
<li>汇率 1.00000</li>
<li>状态 启用</li>
</ul>
</li>
<li><p>系统设置 > 网店设置 > 选择你的网店 > 编辑 > 本地化设置 > 货币设置 > 人民币 > 保存</p></li>
</ul>


<p>Reference:<a href="http://www.opencart-extension.com/opencart-add-renminbi.html">http://www.opencart-extension.com/opencart-add-renminbi.html</a></p>

<h3>3. 如何添加推荐商品？</h3>

<p>A: 扩展功能 > 模块配置 > 推荐商品 > Home Page > Product Name</p>

<h3>4. 如何设置幻灯片？</h3>

<p>A: 设计 > 横幅 > Home Page Slideshow > Edit</p>

<h3>5. OpenCart迁移到新的服务器后布局不正常显示</h3>

<p>A:打开Chrome的Developer Tool,报了很多Failed to load resource: <a href="http://localhost/~meiliang/upload/catalog/view/javascript/jquery/jquery-2.1.1.min.js">http://localhost/~meiliang/upload/catalog/view/javascript/jquery/jquery-2.1.1.min.js</a> net::ERR_CONNECTION_REFUSED之类的错误，所以我估计错误是 CSS 和 js 没有正确加载，于是修改public_html/upload/config.php</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>define('HTTP_SERVER', 'http://ip/~meiliang/upload/');
</span><span class='line'>define('HTTPS_SERVER', 'http://ip/~meiliang/upload/');</span></code></pre></td></tr></table></div></figure>


<h3>6. 增加语言后，语言图标不显示</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cp public_html/upload/image/flags/cn.png public_html/upload/catalog/language/zh-CN/zh-CN.png</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS Unit Testing With OCMock]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-unit-testing-with-ocmock.html"/>
    <updated>2016-01-22T14:19:12+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-unit-testing-with-ocmock</id>
    <content type="html"><![CDATA[<p>单元测试是我们保障代码质量的重要手段， Apple 对此也十分重视，这点可以从 Xcode 新建工程时会自动创建单元测试的 Target 看出来。单元测试牵涉的内容很多，这篇文章是目前我对单元测试的理解。</p>

<p>既然是单元测试，那么什么是单元呢？我没有去考证，但我是这么理解的：面向对象编程范式里一切皆对象，而对象是由实例变量和方法组成，对象之间通过方法互相作用，我们的应用可以看作是一个对象图，对象图上的对象相互作用来实现我们的需求。这么看来我们的单元应该是对象的方法。</p>

<p>对象的方法在工作的时候可能要依赖其他对象，为了去除依赖对象对测试的影响，我们引入 Mock.</p>

<blockquote><p>Mocks are ‘fake’ objects with pre-defined behavior to stand-in for concrete objects during testing. &ndash; HackaZach</p></blockquote>

<p>引用 Mock 之后，我们在单元测试中如何使用它呢？</p>

<blockquote><p>The general recipe for using mocks in unit-tests is:</p>

<ol>
<li>Create the mock object</li>
<li>Specify the expected invocations and return values</li>
<li>Associate the mock object with the code under test</li>
<li>Execute the code under test</li>
<li>Validate that your assertions are correct</li>
</ol>
</blockquote>

<!-- more -->


<h3>Create the mock object</h3>

<p>OCMock 中创建 Mock 对象的方法如下：</p>

<table>
<thead>
<tr>
<th> Factory Method </th>
<th> Description </th>
</tr>
</thead>
<tbody>
<tr>
<td> +mockForClass: </td>
<td> Create a mock based on the given class </td>
</tr>
<tr>
<td> +mockForProtocol: </td>
<td> Create a mock based on the given protocol </td>
</tr>
<tr>
<td> +niceMockForClass: </td>
<td> Create a &ldquo;nice&rdquo; mock based on the given class </td>
</tr>
<tr>
<td> +niceMockForProtocol: </td>
<td> Create a &ldquo;nice&rdquo; mock based on the given protocol </td>
</tr>
<tr>
<td> +partialMockForObject: </td>
<td> Create a mock based on the given object </td>
</tr>
<tr>
<td> +observerMock: </td>
<td> Create a notification observer (more on this later) </td>
</tr>
</tbody>
</table>


<p>Mock 对象是只是一个空壳，只能调用预先定义的方法，调用没有预先定义的方法会抛出异常；
Nice Mock 对象也是一个空壳，只是它会忽略没有预先定义的方法不会抛出异常；
Partial Mock 对象是把一个已有的对象转成 Mock，调用没有预先定义的方法，它会把方法传给已存在的对象；<br/>
Observer Mock 对象是用来观察通知的。</p>

<h3>Specify the expected invocations and return values</h3>

<blockquote><p>Calling either the -expect or -stub method will return an object that you can use to setup your expectations.</p></blockquote>

<ul>
<li><p>Specify the expected invocations</p>

<ol>
<li>不带参数的方法</li>
</ol>
</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>- (void)testInit {
</span><span class='line'>  id mockService = [OCMockObject mockForProtocol:@protocol(AVQuoteService)];
</span><span class='line'>  [[mockService expect] initiateConnection];
</span><span class='line'>  
</span><span class='line'>  AVStockPortfolio *portfolio = [[AVStockPortfolio alloc] initWithService:mockService];
</span><span class='line'>  
</span><span class='line'>  [mockService verify];
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p></br>
    2. 带参数的方法</p>

<blockquote><p>You can use any of the following OCMArg class methods in place of a real argument when setting up your method expectations:</p></blockquote>

<table>
<thead>
<tr>
<th> OCMArg method </th>
<th> Description </th>
</tr>
</thead>
<tbody>
<tr>
<td> +any </td>
<td> Any argument is accepted. </td>
</tr>
<tr>
<td> +anyPointer </td>
<td> Accepts any pointer </td>
</tr>
<tr>
<td> +isNil     </td>
<td> The given argument must be nil </td>
</tr>
<tr>
<td> +isNotNil  </td>
<td> The given argument must not be nil </td>
</tr>
<tr>
<td> +isNotEqual:   </td>
<td> Given argument is not object-equivalent with expectation </td>
</tr>
<tr>
<td> +checkWithSelector: </td>
<td> onObject:   Check the argument with the given action/target pair </td>
</tr>
<tr>
<td> +checkWithBlock: </td>
<td> Check the argument with the given block (OS X 10.6 or iOS 4) </td>
</tr>
</tbody>
</table>


<blockquote><p>OCMock also provides a few handy macros for argument matching:</p></blockquote>

<table>
<thead>
<tr>
<th> Macro </th>
<th> Description </th>
</tr>
</thead>
<tbody>
<tr>
<td> OCMOCK_ANY()   </td>
<td> Equivalent to [OCMArg any] </td>
</tr>
<tr>
<td> OCMOCK_VALUE(value) </td>
<td> A quick way to match a non-object argument </td>
</tr>
<tr>
<td> CONSTRAINT(selector) </td>
<td> Validate with a given selector on self </td>
</tr>
<tr>
<td> CONSTRAINTV(selector,value) </td>
<td>     Validate with a given selector on self and an additional argument </td>
</tr>
</tbody>
</table>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>id classMock = OCMClassMock([SomeClass class]);
</span><span class='line'>OCMExpect([classMock someMethodWithArgument:[OCMArg isNotNil]]);
</span><span class='line'>
</span><span class='line'>/* run code under test, which is assumed to call someMethod */
</span><span class='line'>
</span><span class='line'>OCMVerifyAll(classMock)</span></code></pre></td></tr></table></div></figure>


<p></br>
    3. 通知</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (void)testSellSharesInStock {
</span><span class='line'>  id mock = [OCMockObject observerMock];
</span><span class='line'>  // OCMock adds a custom methods to NSNotificationCenter via a category
</span><span class='line'>  [[NSNotificationCenter defaultCenter] addMockObserver:mock
</span><span class='line'>                                                   name:AVStockSoldNotification
</span><span class='line'>                                                 object:nil];
</span><span class='line'>                                               
</span><span class='line'>  [[mock expect] notificationWithName:AVStockSoldNotification object:[OCMArg any]];
</span><span class='line'>
</span><span class='line'>  AVPortfolio *portfolio = [self createPortfolio]; // made-up factory method
</span><span class='line'>  [portfolio sellShares:100 inStock:@"AAPL"];
</span><span class='line'>
</span><span class='line'>  [mock verify];
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Specify the return values</li>
</ul>


<blockquote><p>If methods on your mocks need to return values, you have a variety of methods to call on the object returned by -expect or -stub.</p></blockquote>

<table>
<thead>
<tr>
<th> Method </th>
<th> Explanation </th>
</tr>
</thead>
<tbody>
<tr>
<td> -andReturn: </td>
<td> Return the given object </td>
</tr>
<tr>
<td> -andReturnValue: </td>
<td> Return a non-object value (wrapped in a NSValue) </td>
</tr>
<tr>
<td> -andThrow: </td>
<td> Throw the given exception </td>
</tr>
<tr>
<td> -andPost: </td>
<td>   Post the given notification </td>
</tr>
<tr>
<td> -andCall:onObject: </td>
<td> Call the selector on the given object </td>
</tr>
<tr>
<td> -andDo: </td>
<td> Invoke the given block (only on OS X 10.6 or iOS 4) </td>
</tr>
</tbody>
</table>


<h3>Execution &amp; Validation</h3>

<ul>
<li>Associate the mock object with the code under test</li>
<li>Execute the code under test</li>
<li>Validate that your assertions are correct</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (void)testSellSharesInStock {
</span><span class='line'>  id quoteService = [[OCMockObject] mockForProtocol:@protocol(AVQuoteService)];
</span><span class='line'>  [[[quoteService expect] andDo:^(NSInvocation *invocation) {
</span><span class='line'>    // validate arguments, set return value on the invocation object
</span><span class='line'>  }] priceForStock:@"AAPL"];
</span><span class='line'>  
</span><span class='line'>  // Associate the mock object with the code under test
</span><span class='line'>  AVStockPortfolio *portfolio = [[AVStockPortfolio alloc] initWithService:quoteService];
</span><span class='line'>  // Execute the code under test
</span><span class='line'>  [portfolio sellShares:100 inStock:@"AAPL"];
</span><span class='line'>  
</span><span class='line'>  // Validate that your assertions are correct
</span><span class='line'>  
</span><span class='line'>  [quoteService verify];
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Q:How to mocking singleton?
A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// we can replace it with a mock object
</span><span class='line'>id mockManager = [OCMockObject mockForClass:[ArticleManager class]];
</span><span class='line'>[ArticleManager setSharedInstance:mockManager];
</span><span class='line'>// we can reset it so that it returns the actual ArticleManager
</span><span class='line'>[ArticleManager setSharedInstance:nil];
</span><span class='line'>
</span><span class='line'>// Objective-C Singleton Pattern Updated For Testability
</span><span class='line'>@implementation ArticleManager
</span><span class='line'>
</span><span class='line'>static ArticleManager *_sharedInstance = nil;
</span><span class='line'>static dispatch_once_t once_token = 0;
</span><span class='line'>
</span><span class='line'>+(instancetype)sharedInstance {
</span><span class='line'>    dispatch_once(&once_token, ^{
</span><span class='line'>        if (_sharedInstance == nil) {
</span><span class='line'>            _sharedInstance = [[ArticleManager alloc] init];
</span><span class='line'>        }
</span><span class='line'>    });
</span><span class='line'>    return _sharedInstance;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>+(void)setSharedInstance:(ArticleManager *)instance {
</span><span class='line'>    once_token = 0; // resets the once_token so dispatch_once will run again
</span><span class='line'>    _sharedInstance = instance;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>@end</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://twobitlabs.com/2013/01/objective-c-singleton-pattern-unit-testing/">Objective-C Singleton Pattern Updated For Testability</a></p>

<h2>Reference:</h2>

<p><a href="http://ocmock.org">OCMock</a><br/>
<a href="http://www.archive.alexvollmer.com/posts/2010/06/28/making-fun-of-things-with-ocmock/">Making Fun of Things with OCMock</a><br/>
<a href="http://hackazach.net/code/2014/03/03/effective-testing-with-ocmock/">OCMock Test Origami</a><br/>
<a href="http://engineering.aweber.com/improving-ios-unit-tests-with-ocmock/">IMPROVING IOS UNIT TESTS WITH OCMOCK</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（五）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-development-problems-part-5.html"/>
    <updated>2016-01-08T21:32:22+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-development-problems-part-5</id>
    <content type="html"><![CDATA[<h3>1.On iOS 7 and later, how do I take a snapshot of my view and save the result in a UIImage?</h3>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (UIImage *)snapshot:(UIView *)view
</span><span class='line'>{
</span><span class='line'>    UIGraphicsBeginImageContextWithOptions(view.bounds.size, YES, 0);
</span><span class='line'>    [view drawViewHierarchyInRect:view.bounds afterScreenUpdates:YES];
</span><span class='line'>    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
</span><span class='line'>    UIGraphicsEndImageContext();
</span><span class='line'>    
</span><span class='line'>    return image;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="https://developer.apple.com/library/ios/qa/qa1817/_index.html">https://developer.apple.com/library/ios/qa/qa1817/_index.html</a></p>

<h3>2.How to present a view controller on iOS7 without the status bar overlapping?</h3>

<p>Solution:The easiest workaround I&rsquo;ve found is to wrap the view controller you want to present inside a navigation controller, and then present that navigation controller.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MyViewController *vc = [MyViewController new];
</span><span class='line'>UINavigationController *nvc = [[UINavigationController alloc] 
</span><span class='line'>    initWithRootViewController:vc];
</span><span class='line'>[self presentViewController:nvc animated:YES completion:nil];</span></code></pre></td></tr></table></div></figure>


<h3>3.代码创建 UITableView 时如何使用各种系统样式的 UITableViewCell?</h3>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
</span><span class='line'>{
</span><span class='line'>    static NSString *sCellID = @"CellID";
</span><span class='line'>
</span><span class='line'>    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:sCellID];
</span><span class='line'>    if (!cell) {
</span><span class='line'>        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:sCellID];
</span><span class='line'>    }
</span><span class='line'>    // Configure the cell...
</span><span class='line'>    
</span><span class='line'>    return cell;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<h3>4.Settings bundle not showing up in iPhone settings</h3>

<p>Solution:iOS 9.0.x - 9.2 Settings App Bug, Using the App Switch UI (double-press Home button) to kill the Settings App.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/2683793/settings-bundle-not-showing-up-in-iphone-settings">http://stackoverflow.com/questions/2683793/settings-bundle-not-showing-up-in-iphone-settings</a></p>

<h3>5.单元测试的 Target 在测试导航栏里是灰色的不能点击测试。</h3>

<p>Solution: Edit Scheme &hellip; > Test > + > Select your test target.</p>

<h3>6.How to change UITableViewCell Image to Circle in UITableView</h3>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Subclass UITableViewCell override layoutSubviews method
</span><span class='line'>
</span><span class='line'>- (void)layoutSubviews
</span><span class='line'>{
</span><span class='line'>    [super layoutSubviews];
</span><span class='line'>    
</span><span class='line'>    self.imageView.layer.cornerRadius = CGRectGetHeight(self.imageView.frame) * 0.5;
</span><span class='line'>    self.imageView.layer.masksToBounds = YES;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/23350728/how-to-change-uitableviewcell-image-to-circle-in-uitableview">http://stackoverflow.com/questions/23350728/how-to-change-uitableviewcell-image-to-circle-in-uitableview</a></p>

<h3>7.How to downgrading Cocoapods?</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// First you can figure out which version of Cocoapods you are on with the command:
</span><span class='line'>$ pod --version
</span><span class='line'>
</span><span class='line'>// You can also see all the version of Cocoapods you have installed with this command:
</span><span class='line'>$ sudo gem list cocoapods
</span><span class='line'>
</span><span class='line'>// Next uninstall Cocoapods. If you have multiple version, you will have the choice of uninstalling all or a specific version.
</span><span class='line'>$ sudo gem uninstall cocoapods
</span><span class='line'>
</span><span class='line'>// Finally you can install the specific version with this command:
</span><span class='line'>$ sudo gem install cocoapods -v 0.39.0</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="https://diego.org/2015/09/24/downgrading-cocoapods/">https://diego.org/2015/09/24/downgrading-cocoapods/</a></p>

<h3>8.How to get UISearchDisplayController to search only after search button is pressed？</h3>

<p>A:Setup a delegate for the search bar and implement the searchBarSearchButtonClicked: method. Do your searching from that method. Just return NO from the shouldReloadTableForSearchString method.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/18563529/how-to-get-uisearchdisplaycontroller-to-search-only-after-search-button-is-press">http://stackoverflow.com/questions/18563529/how-to-get-uisearchdisplaycontroller-to-search-only-after-search-button-is-press</a></p>

<h3>9.Warning: the running version of Bundler is older than the version that created the lockfile. We suggest you upgrade to the latest version of Bundler by running <code>gem install bundler</code>.</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo gem install bundler
</span><span class='line'>$ bundle install
</span><span class='line'>
</span><span class='line'>...
</span><span class='line'>An error occurred while installing git (1.2.9.1), and Bundler cannot continue.
</span><span class='line'>Make sure that `gem install git -v '1.2.9.1'` succeeds before bundling.
</span><span class='line'>
</span><span class='line'>$ sudo gem install git -v '1.2.9.1'
</span><span class='line'>$ sudo gem install lowdown -v '0.0.5' --verbose
</span><span class='line'>...
</span><span class='line'>ERROR:  Error installing lowdown:
</span><span class='line'>  lowdown requires Ruby version &gt;= 2.1.0.
</span><span class='line'>  
</span><span class='line'>$ ruby --version
</span><span class='line'>ruby 2.0.0p645 (2015-04-13 revision 50299) [universal.x86_64-darwin15]
</span><span class='line'>// On OS X machines, you can use third-party tools (rbenv and RVM).
</span><span class='line'>// Install RVM:
</span><span class='line'>$ \curl -sSL https://get.rvm.io | bash -s stable --ruby=2.1.8
</span><span class='line'>
</span><span class='line'>* To start using RVM you need to run `source /Users/dongmeiliang/.rvm/scripts/rvm`
</span><span class='line'>    in all your open shell windows, in rare cases you need to reopen all shell windows.
</span><span class='line'>$ source /Users/dongmeiliang/.rvm/scripts/rvm
</span><span class='line'>
</span><span class='line'>// Check rvm has been installed successfully
</span><span class='line'>$ rvm --help
</span><span class='line'>
</span><span class='line'>$ bundle install
</span><span class='line'>/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/dependency.rb:296:in `to_specs': Could not find 'bundler' (&gt;= 0) among 13 total gem(s) (Gem::LoadError)
</span><span class='line'>  from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/dependency.rb:307:in `to_spec'
</span><span class='line'>  from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_gem.rb:47:in `gem'
</span><span class='line'>  from /usr/local/bin/bundle:22:in `&lt;main&gt;'
</span><span class='line'>  
</span><span class='line'>We need reinstall bundler after update ruby:
</span><span class='line'>$ gem install bundler
</span><span class='line'>Fetching: bundler-1.11.2.gem (100%)
</span><span class='line'>Successfully installed bundler-1.11.2
</span><span class='line'>Parsing documentation for bundler-1.11.2
</span><span class='line'>Installing ri documentation for bundler-1.11.2
</span><span class='line'>Done installing documentation for bundler after 6 seconds
</span><span class='line'>1 gem installed
</span><span class='line'>
</span><span class='line'>//bundle - Ruby Dependency Management
</span><span class='line'>//gem -- RubyGems program, RubyGems is a sophisticated package manager for Ruby.
</span><span class='line'>//rvm - The Ruby Version Manager</span></code></pre></td></tr></table></div></figure>


<h3>10.Attempt to set a non-property-list object</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Attempt to set a non-property-list object &lt;CFBasicHash 0x15809b8d0 [0x19ec23b68]&gt;{type = immutable dict, count = 12,
</span><span class='line'>
</span><span class='line'>entries =&gt;
</span><span class='line'>
</span><span class='line'>  0 : id = &lt;CFNumber 0xb000000000000043 [0x19ec23b68]&gt;{value = +4, type = kCFNumberSInt64Type}
</span><span class='line'>
</span><span class='line'>  1 : &lt;CFString 0x156dda8d0 [0x19ec23b68]&gt;{contents = "allFreeLifeId"} = &lt;CFNull 0x19ec23ea8 [0x19ec23b68]&gt;
</span><span class='line'>
</span><span class='line'>  5 : &lt;CFString 0x156fd04d0 [0x19ec23b68]&gt;{contents = "portraitUri"} = &lt;CFNull 0x19ec23ea8 [0x19ec23b68]&gt;
</span><span class='line'>
</span><span class='line'>  6 : mobile = &lt;CFString 0x156df0dd0 [0x19ec23b68]&gt;{contents = "18670789602"}
</span><span class='line'>
</span><span class='line'>  11 : ryUserId = &lt;CFString 0x156fbef80 [0x19ec23b68]&gt;{contents = "AFL2016020310001627518670789602"}
</span><span class='line'>
</span><span class='line'>  13 : birthDay = &lt;CFNull 0x19ec23ea8 [0x19ec23b68]&gt;
</span><span class='line'>
</span><span class='line'>  14 : signature = &lt;CFString 0x19a51d480 [0x19ec23b68]&gt;{contents = ""}
</span><span class='line'>
</span><span class='line'>  15 : token = &lt;CFString 0x1580a3cc0 [0x19ec23b68]&gt;{contents = "vL9oen0gHgJF7sRMWdaacY9LZ0Y0py8pcDvpcwTzcsCvfbB0kFB1PaDbWZ1c1GGZ8/jRvJ5KfX2oT3Sv+7Wb75r8W7FhoewF9l1Si6GJa2B48Xpc3rElo2a6FVG/X29zQOiOTHRjfiM="}
</span><span class='line'>
</span><span class='line'>  16 : password = &lt;CFString 0x1580d5050 [0x19ec23b68]&gt;{contents = "E10ADC3949BA59ABBE56E057F20F883E"}
</span><span class='line'>
</span><span class='line'>  20 : email = &lt;CFNull 0x19ec23ea8 [0x19ec23b68]&gt;
</span><span class='line'>
</span><span class='line'>  21 : name = Julian
</span><span class='line'>
</span><span class='line'>  22 : gender = &lt;CFNull 0x19ec23ea8 [0x19ec23b68]&gt;
</span><span class='line'>
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'> as an NSUserDefaults/CFPreferences value for key UserInfo</span></code></pre></td></tr></table></div></figure>


<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Write
</span><span class='line'>NSData *dataFromUserInfo = [NSKeyedArchiver archivedDataWithRootObject:userInfo];
</span><span class='line'>[[NSUserDefaults standardUserDefaults] setObject:dataFromUserInfo forKey:sUserInfoKey];
</span><span class='line'>
</span><span class='line'>// Read
</span><span class='line'>NSData *dataFromUserInfo = [[NSUserDefaults standardUserDefaults] objectForKey:sUserInfoKey];
</span><span class='line'>NSDictionary *ret = [NSKeyedUnarchiver unarchiveObjectWithData:dataFromUserInfo];</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/19720611/attempt-to-set-a-non-property-list-object-as-an-nsuserdefaults">http://stackoverflow.com/questions/19720611/attempt-to-set-a-non-property-list-object-as-an-nsuserdefaults</a></p>

<h3>11.Missing iOS Distribution signing identity</h3>

<p>A:KeyChain Access > select the System keychain > View > Show Expired Certificates > delete the expired version of the Apple Worldwide Developer Relations Certificate Authority Intermediate certificate (expired on February 14, 2016)</p>

<p>Reference:<a href="http://stackoverflow.com/questions/32821189/xcode-7-error-missing-ios-distribution-signing-identity-for">http://stackoverflow.com/questions/32821189/xcode-7-error-missing-ios-distribution-signing-identity-for</a></p>

<h3>12. FMDB unable to open db under Application Support directory.</h3>

<p>A:Unlike the Documents directory, the Application Support directory does not exist in the app&rsquo;s sandbox by default. You need to create it before you can use it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>NSURL * ApplicationSupportDirectory()
</span><span class='line'>{
</span><span class='line'>    NSURL *applicationSupportDir = URLOfDirectory(NSApplicationSupportDirectory);
</span><span class='line'>    
</span><span class='line'>    if (applicationSupportDir) {
</span><span class='line'>        // If the directory does not exist, this method creates it.
</span><span class='line'>        // This method is only available in OS X v10.7 and iOS 5.0 or later.
</span><span class='line'>        [[NSFileManager defaultManager] createDirectoryAtURL:applicationSupportDir withIntermediateDirectories:YES attributes:nil error:nil];
</span><span class='line'>    }
</span><span class='line'>    
</span><span class='line'>    return applicationSupportDir;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/16204988/ios-cant-save-file-to-application-support-folder-but-can-to-documents">http://stackoverflow.com/questions/16204988/ios-cant-save-file-to-application-support-folder-but-can-to-documents</a>
<a href="http://www.cocoawithlove.com/2010/05/finding-or-creating-application-support.html">http://www.cocoawithlove.com/2010/05/finding-or-creating-application-support.html</a></p>

<h3>13.How to NSLog a Call stack when a program is running?</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// 1. Cocoa framework
</span><span class='line'>NSLog(@"%@", [NSThread callStackSymbols]);
</span><span class='line'>
</span><span class='line'>// 2. C API
</span><span class='line'>#include &lt;execinfo.h&gt;
</span><span class='line'>
</span><span class='line'>int size = 256;
</span><span class='line'>void *stack[size];
</span><span class='line'>size = backtrace(stack, size);
</span><span class='line'>
</span><span class='line'>char **syms = backtrace_symbols(stack, size);
</span><span class='line'>for (int i = 0; i &lt; size; i++) {
</span><span class='line'>    printf("Frame #%d: %s\n", i, syms[i]);
</span><span class='line'>}
</span><span class='line'>free(syms);</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/13319551/how-to-nslog-a-call-stack-when-a-program-is-running">http://stackoverflow.com/questions/13319551/how-to-nslog-a-call-stack-when-a-program-is-running</a></p>

<h3>14.How does programmatically construct to-one and to-many relationship in Core Data?</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>NSRelationshipDescription *department = [NSRelationshipDescription new];
</span><span class='line'>department.name = @"department";
</span><span class='line'>department.deleteRule = NSNullifyDeleteRule;
</span><span class='line'>department.minCount = 0;
</span><span class='line'>department.maxCount = 1;// max = 1 for to-one relationship
</span><span class='line'>    
</span><span class='line'>NSRelationshipDescription *employees = [NSRelationshipDescription new];
</span><span class='line'>employees.name = @"employees";
</span><span class='line'>employees.deleteRule = NSNullifyDeleteRule;
</span><span class='line'>employees.minCount = 0;
</span><span class='line'>employees.maxCount = 0;// max = 0 for to-many relationship</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/13743242/adding-relationships-in-nsmanagedobjectmodel-to-programmatically-created-nsentit">http://stackoverflow.com/questions/13743242/adding-relationships-in-nsmanagedobjectmodel-to-programmatically-created-nsentit</a></p>

<h3>15.ld: warning: directory not found for option &lsquo;-F/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator9.2.sdk/Developer/Library/Frameworks&rsquo;</h3>

<p>A:Delete entries that generate warnings.</p>

<p>UnitTest > Build Settings > Search Paths > Framework Search Paths ></p>

<p>$(SDKROOT)/Developer/Library/Frameworks
$(DEVELOPER_FRAMEWORKS_DIR)</p>

<p>Reference:<a href="http://stackoverflow.com/questions/30827022/xcode-7-library-search-path-warning/32620919#32620919">http://stackoverflow.com/questions/30827022/xcode-7-library-search-path-warning/32620919#32620919</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用 Wireshark 抓 iPhone 网络请求的数据包]]></title>
    <link href="http://DamianSheldon.github.io/blog/capturing-iphone-traffic-on-wireshark.html"/>
    <updated>2016-01-04T14:43:00+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/capturing-iphone-traffic-on-wireshark</id>
    <content type="html"><![CDATA[<p>开发过程中经常可能遇到网络问题，这时候我们需要抓包来定位问题所在。那么如何用 Wireshark 抓取 iPhone 真机网络请求的数据包呢？</p>

<blockquote><p>iOS does not support packet tracing directly. However, if you&rsquo;re developing for iOS you can take a packet trace of your app in a number of different ways:</p>

<p>If the problem you&rsquo;re trying to debug occurs on Wi-Fi, you can put your iOS device on a test Wi-Fi network. See Wi-Fi Capture for details.<br/>
If your app uses HTTP, you can configure your iOS device to use a debugging HTTP proxy (such as Charles HTTP Proxy).<br/>
In iOS 5 and later you can use the remote virtual interface facility.</p></blockquote>

<!-- more -->


<p>这里我使用的是第三种方法：remote virtual interface。</p>

<p>iOS 5 added a remote virtual interface (RVI) facility that lets you use OS X packet trace programs to capture traces from an iOS device. The basic strategy is:</p>

<ol>
<li>Connect your iOS device to your Mac via USB.</li>
<li>Set up an RVI for that device. This creates a virtual network interface on your Mac that represents the iOS device&rsquo;s networking stack.</li>
<li>Run your OS X packet trace program, and point it at the RVI created in the previous step.</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ # First get the current list of interfaces.
</span><span class='line'>$ ifconfig -l
</span><span class='line'>lo0 gif0 stf0 en0 en1 p2p0 fw0 ppp0 utun0
</span><span class='line'>$ # Get connected device's UDID follow: Xcode &gt; Window &gt; Devices &gt; Select connected device &gt; identifier
</span><span class='line'>$ # Then run the tool with the UDID of the device.
</span><span class='line'>$ rvictl -s 74bd53c647548234ddcef0ee3abee616005051ed
</span><span class='line'> 
</span><span class='line'>Starting device 74bd53c647548234ddcef0ee3abee616005051ed [SUCCEEDED]
</span><span class='line'> 
</span><span class='line'>$ # Get the list of interfaces again, and you can see the new virtual
</span><span class='line'>$ # network interface, rvi0, added by the previous command.
</span><span class='line'>$ ifconfig -l
</span><span class='line'>lo0 gif0 stf0 en0 en1 p2p0 fw0 ppp0 utun0 rvi0</span></code></pre></td></tr></table></div></figure>


<p>打开 Wireshark, 选择 rvi0 作为待抓包的接口。</p>

<h1>Reference</h1>

<p><a href="https://developer.apple.com/library/mac/qa/qa1176/_index.html">Getting a Packet Trace</a><br/>
<a href="http://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark">Capturing mobile phone traffic on wireshark</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Web Development Notes Part One]]></title>
    <link href="http://DamianSheldon.github.io/blog/web-development-notes-part-one.html"/>
    <updated>2015-12-12T22:27:22+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/web-development-notes-part-one</id>
    <content type="html"><![CDATA[<h3>1. What is href=“#” and why is it used?</h3>

<p>Solution:A hashtag - # within a hyperlink specifies an html element id to which the window should be scrolled.<br/>
href=&ldquo;#some-id&rdquo; would scroll to an element on the current page such as <div id="some-id">.</p>

<p>href=&ldquo;//site.com/#some-id&rdquo; would go to site.com and scroll to the id on that page.</p>

<p>href=&ldquo;#&rdquo; doesn&rsquo;t specify an id name, but does have a corresponding location - the top of the page. Clicking an anchor with href=&ldquo;#&rdquo; will move the scroll position to the top.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/4855168/what-is-href-and-why-is-it-used">http://stackoverflow.com/questions/4855168/what-is-href-and-why-is-it-used</a></p>

<h3>2. How to debug your web page, technology stack is LAMP.</h3>

<p>Solution:View log, figure out what cause problems.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ tail -f /var/log/apache2/error_log
</span><span class='line'>[Fri Dec 11 21:34:57.003657 2015] [:error] [pid 17465] [client ::1:50505] PHP Parse error:  parse error, expecting `','' or `';'' in /Users/dongmeiliang/Sites/knowledgeispower/includes/header.html on line 7
</span><span class='line'>[Fri Dec 11 21:34:57.003701 2015] [:error] [pid 17465] [client ::1:50505] PHP Stack trace:
</span><span class='line'>[Fri Dec 11 21:34:57.003723 2015] [:error] [pid 17465] [client ::1:50505] PHP   1. {main}() /Users/dongmeiliang/Sites/knowledgeispower/index.php:0</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<h3>3. Install mcrypt_filter extension on El capitan</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Please make sure the PHP extensions listed below are installed.
</span><span class='line'>mCrypt
</span><span class='line'>
</span><span class='line'>// PECL is a repository of PHP extensions that are made available to you via the » PEAR packaging system. 
</span><span class='line'>
</span><span class='line'>// There are several options for downloading PECL extensions, such as:
</span><span class='line'>o The pecl install extname command downloads the extensions code automatically, so in this case there is no need for a separate download.
</span><span class='line'>o » http://pecl.php.net/ The PECL web site contains information about the different extensions that are offered by the PHP Development Team. The information available here includes: ChangeLog, release notes, requirements and other similar details.
</span><span class='line'>o pecl download extname PECL extensions that have releases listed on the PECL web site are available for download and installation using the » pecl command. Specific revisions may also be specified.
</span><span class='line'>o SVN Most PECL extensions also reside in SVN. A web-based view may be seen at » http://svn.php.net/viewvc/pecl/. To download straight from SVN, the following sequence of commands may be used:
</span><span class='line'>
</span><span class='line'>$ pecl search mCrypt
</span><span class='line'>Retrieving data...0%
</span><span class='line'>Matched packages, channel pecl.php.net:
</span><span class='line'>=======================================
</span><span class='line'>Package       Stable/(Latest) Local
</span><span class='line'>mcrypt_filter 0.1.0 (beta)          Applies mcrypt symmetric encryption using stream filters
</span><span class='line'>
</span><span class='line'>$ pecl install mcrypt_filter
</span><span class='line'>Failed to download pecl/mcrypt_filter within preferred state "stable", latest release is version 0.1.0, stability "beta", use "channel://pecl.php.net/mcrypt_filter-0.1.0" to install
</span><span class='line'>install failed
</span><span class='line'>
</span><span class='line'>$ pecl install channel://pecl.php.net/mcrypt_filter-0.1.0/mcrypt_filter
</span><span class='line'>Attempting to discover channel "pecl.php.net/mcrypt_filter-0.1.0"...
</span><span class='line'>Attempting fallback to https instead of http on channel "pecl.php.net/mcrypt_filter-0.1.0"...
</span><span class='line'>unknown channel "pecl.php.net/mcrypt_filter-0.1.0" in "channel://pecl.php.net/mcrypt_filter-0.1.0/mcrypt_filter"
</span><span class='line'>invalid package name/package file "channel://pecl.php.net/mcrypt_filter-0.1.0/mcrypt_filter"
</span><span class='line'>install failed
</span><span class='line'>
</span><span class='line'>$ pecl install channel://pecl.php.net/mcrypt_filter-0.1.0
</span><span class='line'>Cannot install, php_dir for channel "pecl.php.net" is not writeable by the current user
</span><span class='line'>DongMeiliangsMacBook-Pro:upload dongmeiliang$ sudo pecl install channel://pecl.php.net/mcrypt_filter-0.1.0
</span><span class='line'>Password:
</span><span class='line'>downloading mcrypt_filter-0.1.0.tgz ...
</span><span class='line'>Starting to download mcrypt_filter-0.1.0.tgz (4,586 bytes)
</span><span class='line'>...
</span><span class='line'>checking for mcrypt support... yes, shared
</span><span class='line'>configure: error: mcrypt.h not found. Please reinstall libmcrypt.
</span><span class='line'>ERROR: `/private/tmp/pear/install/mcrypt_filter/configure --with-php-config=/usr/bin/php-config' failed
</span><span class='line'>
</span><span class='line'>// Resolve configure: error: mcrypt.h not found. Please reinstall libmcrypt.
</span><span class='line'>Get libmcrypt 2.5.8 from Sourceforge: http://sourceforge.net/projects/mcrypt/files/Libmcrypt/2.5.8/libmcrypt-2.5.8.tar.gz/download
</span><span class='line'>
</span><span class='line'>$ tar -zxvf libmcrypt-2.5.8.tar.gz
</span><span class='line'>$ mkdir -p /usr/local/src
</span><span class='line'>$ mv libmcrypt-2.5.8 /usr/local/src/
</span><span class='line'>$ cd /usr/local/src/libmcrypt-2.5.8/
</span><span class='line'>$ ./configure --prefix=/usr/local
</span><span class='line'>$ make && make install
</span><span class='line'>
</span><span class='line'>// Continue install mCrypt extension
</span><span class='line'>$ sudo pecl install channel://pecl.php.net/mcrypt_filter-0.1.0
</span><span class='line'>...
</span><span class='line'>
</span><span class='line'>12472464 40 -rwxr-xr-x  1 root  wheel  16704 Feb 15 21:41 /private/tmp/pear/install/pear-build-rootEyJ4Jg/install-mcrypt_filter-0.1.0/usr/lib/php/extensions/no-debug-non-zts-20121212/mcrypt_filter.so
</span><span class='line'>
</span><span class='line'>Build process completed successfully
</span><span class='line'>Installing '/usr/lib/php/extensions/no-debug-non-zts-20121212/mcrypt_filter.so'
</span><span class='line'>ERROR: failed to write /usr/lib/php/extensions/no-debug-non-zts-20121212/mcrypt_filter.so (copy(/usr/lib/php/extensions/no-debug-non-zts-20121212/mcrypt_filter.so): failed to open stream: Operation not permitted)
</span><span class='line'>
</span><span class='line'>We need to disable SIP.
</span><span class='line'>
</span><span class='line'>OSX 10.11 El Capitan ships with a new security process referred to as SIP or Security Integrity Protection also known as rootless.
</span><span class='line'>
</span><span class='line'>What this essentially does is protect certain system level directories from being changes, notably
</span><span class='line'>
</span><span class='line'>o /System
</span><span class='line'>o /sbin
</span><span class='line'>o /usr
</span><span class='line'>o not /usr/local
</span><span class='line'>
</span><span class='line'>// Disabling SIP in OSX
</span><span class='line'>o Reboot your Mac into Recovery Mode by rebooting and holding down ‘command’ + ‘r’
</span><span class='line'>o Launch a Terminal session and enter csrutil disable
</span><span class='line'>o Reboot
</span><span class='line'>
</span><span class='line'>// Reinstall mCrypt extension
</span><span class='line'>$ sudo pecl install channel://pecl.php.net/mcrypt_filter-0.1.0
</span><span class='line'>
</span><span class='line'>...
</span><span class='line'>
</span><span class='line'>Build process completed successfully
</span><span class='line'>Installing '/usr/lib/php/extensions/no-debug-non-zts-20121212/mcrypt_filter.so'
</span><span class='line'>install ok: channel://pecl.php.net/mcrypt_filter-0.1.0
</span><span class='line'>configuration option "php_ini" is not set to php.ini location
</span><span class='line'>You should add "extension=mcrypt_filter.so" to php.ini
</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://www.nginx.cn/2196.html">http://www.nginx.cn/2196.html</a>
<a href="http://coolestguidesontheplanet.com/install-mcrypt-for-php-on-mac-osx-10-10-yosemite-for-a-development-server/">http://coolestguidesontheplanet.com/install-mcrypt-for-php-on-mac-osx-10-10-yosemite-for-a-development-server/</a></p>

<h3>4.Install mcrypt for php on Mac OSX 10.11 El Capitan</h3>

<p>o Disable SIP/rootless
You need to disable the new System Integrity Protection to install into some system protected directories – this involves a recovery reboot and disabling with.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ csrutil disable</span></code></pre></td></tr></table></div></figure>


<p>o Getting it on in OS X El Capitan 10.11</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd ~ ; mkdir mcrypt ; cd mcrypt</span></code></pre></td></tr></table></div></figure>


<p><a href="http://sourceforge.net/projects/mcrypt/files/Libmcrypt/2.5.8/libmcrypt-2.5.8.tar.gz/download">Get libmcrypt 2.5.8 from Sourceforge</a>,  this is direct download link.</p>

<p><a href="http://php.net/releases/index.php">Get the php code in a tar.gz or .bz2 format</a>- (version 5.5.27 is the one that currently ships with OSX 10.11)</p>

<p>Move both of these files that you downloaded into your working directory – mcrypt in this instance, and go back to Terminal</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd ~/mcrypt</span></code></pre></td></tr></table></div></figure>


<p>Expand both files via the command line or just double click them in the Finder:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ tar -zxvf libmcrypt-2.5.8.tar.gz
</span><span class='line'>$ tar -zxvf php-5.5.27.tar.gz</span></code></pre></td></tr></table></div></figure>


<p>o Configuring libmcrypt</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd libmcrypt-2.5.8
</span><span class='line'>$ ./configure
</span><span class='line'>$ make
</span><span class='line'>$ sudo make install</span></code></pre></td></tr></table></div></figure>


<p>o Compile mcrypt php Extension</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd ../php-5.5.27/ext/mcrypt/
</span><span class='line'>$ /usr/bin/phpize
</span><span class='line'>$ ./configure
</span><span class='line'>$ make
</span><span class='line'>$ sudo make install</span></code></pre></td></tr></table></div></figure>


<p>o Enabling mcrypt.so  php Extension</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Open /etc/php.ini and add the line below at the end
</span><span class='line'>extension=mcrypt.so
</span><span class='line'>
</span><span class='line'>// If there is no php.ini file,  then you need to make one from php.ini.default in the same location like so:
</span><span class='line'>$ sudo cp /etc/php.ini.default /etc/php.ini
</span><span class='line'>
</span><span class='line'>// And allow write capability
</span><span class='line'>$ sudo chmod u+w  /etc/php.ini
</span><span class='line'>
</span><span class='line'>// Then add the line as above in your favourite text editor:
</span><span class='line'>$ sudo vi /etc/php.ini
</span><span class='line'>
</span><span class='line'>// make sure dynamic extensions are set to on…
</span><span class='line'>extension_dl = On
</span><span class='line'>
</span><span class='line'>// If it didn’t load you may need to declare the extensions directory in /etc/php.ini
</span><span class='line'>extension_dir = "/usr/lib/php/extensions/no-debug-non-zts-20100525/"</span></code></pre></td></tr></table></div></figure>


<p>o Restart Apache</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apachectl restart</span></code></pre></td></tr></table></div></figure>


<p>That’s it, create a php page with the function phpinfo();  to see if it loaded correctly.</p>

<p>Reference:<a href="http://coolestguidesontheplanet.com/install-mcrypt-for-php-on-mac-osx-10-10-yosemite-for-a-development-server/">http://coolestguidesontheplanet.com/install-mcrypt-for-php-on-mac-osx-10-10-yosemite-for-a-development-server/</a>
<a href="http://coolestguidesontheplanet.com/what-is-sip-in-osx-10-11-el-capitan/">http://coolestguidesontheplanet.com/what-is-sip-in-osx-10-11-el-capitan/</a></p>

<h3>4. How to set up Apache MySQL PHP on Debian?</h3>

<p>A:<a href="https://wiki.debian.org/LaMp">https://wiki.debian.org/LaMp</a></p>

<h3>5. Where is apache error log path on Debian?</h3>

<p>A:/var/log/apache2/error.log</p>

<h3>6.</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ php arrayTests.php
</span><span class='line'>PHP Warning:  PHP Startup: Unable to load dynamic library '/usr/lib/php/extensions/no-debug-non-zts-20121212/' - dlopen(/usr/lib/php/extensions/no-debug-non-zts-20121212/, 9): no suitable image found.  Did find:
</span><span class='line'>  /usr/lib/php/extensions/no-debug-non-zts-20121212/: not a file in Unknown on line 0</span></code></pre></td></tr></table></div></figure>


<p>A:这个问题的原因是本来我应该是设置 extension_dir 的，结果在 php.ini里写成了 extension， 更正之后问题就解决了。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>extension_dir = "/usr/lib/php/extensions/no-debug-non-zts-20121212/"</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/5282264/php-warning-php-startup-unable-to-load-dynamic-library">http://stackoverflow.com/questions/5282264/php-warning-php-startup-unable-to-load-dynamic-library</a></p>

<h3>7.Why should the &lsquo;&amp;&rsquo; (ampersand) character be HTML escaped?</h3>

<p>A:The reason we escape the &amp; is precisely because it is the first character in special characters such as &amp;rsquo. If it is not escaped, some programs may be expecting a special character to begin when they see the ampersand.</p>

<p>But it is only escaped when you actually want the ampersand to show. You would not escape it in a special character. So you would always use &amp;rsquo and never &amp;rsquo.</p>

<p>Reference:<a href="https://www.quora.com/Why-should-the-ampersand-character-be-HTML-escaped">https://www.quora.com/Why-should-the-ampersand-character-be-HTML-escaped</a></p>

<h3>8.Evaluate JavaScript in terminal on Mac</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// 1.
</span><span class='line'>$ osascript test.js
</span><span class='line'>// 2.
</span><span class='line'>// Use specified language and evaluate given script file
</span><span class='line'>$jrunscript -l js -f test.js
</span><span class='line'>$jrunscript test.js</span></code></pre></td></tr></table></div></figure>


<h3>9.How to debug JavaScript?</h3>

<p>A:
Reference:<a href="https://developer.mozilla.org/en-US/docs/Mozilla/Debugging/Debugging_JavaScript">https://developer.mozilla.org/en-US/docs/Mozilla/Debugging/Debugging_JavaScript</a></p>

<h3>10.How to use WebSocket with an Apache server while main develop language is PHP?</h3>

<p>A:
One path is to use an independent installed web sockets server.</p>

<p>For PHP you can try: <a href="http://code.google.com/p/phpwebsocket/">http://code.google.com/p/phpwebsocket/</a> or <a href="http://code.google.com/p/phpws/">http://code.google.com/p/phpws/</a></p>

<p>There are some other projects which you can try as well.</p>

<p>Basically, you need to upload, unpack and start running the process.</p>

<p>On the frontend, you&rsquo;ll have javascript connecting to the server on the specific port.</p>

<p>Most websocket servers have a demo which echoes back whatever it hears, so this is a good place to write some test code. You may even find a rudimentary chat implementation.</p>

<p>The tricky part is to monitor the web socket server and to make sure it runs smoothly and continuously.</p>

<p>Try to test on as many browsers/devices as possible as this will decide on which websocket server implementation you choose. There are old and new protocols you have to watch out for.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/11334320/using-websocket-on-apache-server">http://stackoverflow.com/questions/11334320/using-websocket-on-apache-server</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS 项目持续集成和部署笔记]]></title>
    <link href="http://DamianSheldon.github.io/blog/continuous-integration-and-deployment-for-ios-projects.html"/>
    <updated>2015-11-04T09:38:13+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/continuous-integration-and-deployment-for-ios-projects</id>
    <content type="html"><![CDATA[<p>本文是我做 iOS 项目持续集成和部署的笔记。</p>

<h3>安装工具</h3>

<ol>
<li><p><a href="http://jenkins-ci.org/">jenkins</a>;</p>

<pre><code class="`"> $ brew update &amp;&amp; brew install jenkins
</code></pre></li>
<li><p><a href="https://github.com/fastlane/fastlane">fastlane</a>;</p>

<pre><code class="`"> $ sudo gem install fastlane --verbose
</code></pre></li>
<li><p><a href="https://github.com/FIRHQ/fir-cli/blob/master/README.md">fir-cli</a>;</p>

<pre><code class="`"> $ sudo gem install fir-cli
</code></pre></li>
</ol>


<!-- more -->


<h3>fastlane 自动构建</h3>

<ul>
<li>cd [your_project_folder]</li>
<li>fastlane init</li>
<li>Follow the setup assistant, which will set up fastlane for you</li>
<li>Edit Fastfile</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>fastlane_version "1.25.0"
</span><span class='line'>
</span><span class='line'>default_platform :ios
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>platform :ios do
</span><span class='line'>  before_all do
</span><span class='line'>    ENV["SLACK_URL"] = "https://hooks.slack.com/services/..."
</span><span class='line'>    #cocoapods
</span><span class='line'>
</span><span class='line'>    increment_build_number
</span><span class='line'>
</span><span class='line'>    gym(scheme: "srsApp") # Build your app - more options available
</span><span class='line'>
</span><span class='line'>    # xctool # run the tests of your app
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  desc "Runs all the tests"
</span><span class='line'>  lane :test do
</span><span class='line'>    snapshot
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  desc "Submit a new Beta Build to fir"
</span><span class='line'>  desc "This will also make sure the profile is up to date"
</span><span class='line'>  lane :fir do
</span><span class='line'>    #snapshot
</span><span class='line'>    sh "sigh --team_id your_team_id"
</span><span class='line'>    #deliver(beta: true)
</span><span class='line'>
</span><span class='line'>    #"ipa distribute:pgyer -u USER_KEY -a APP_KEY" # 上传到蒲公英
</span><span class='line'>
</span><span class='line'>    #"ipa distribute:fir -u USER_TOKEN -a APP_ID" # 上传到fir.im
</span><span class='line'>
</span><span class='line'>    # sh"ipa distribute:fir -u USER_KEY -a APP_KEY"
</span><span class='line'>    # You can also use other beta testing services here
</span><span class='line'>    sh "fir p ../srsApp.ipa -T USER_TOKEN"
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  desc "Submit a new Beta Build to pgyer "
</span><span class='line'>  desc "This will also make sure the profile is up to date"
</span><span class='line'>  lane :pgyer do
</span><span class='line'>    #snapshot
</span><span class='line'>    sh "sigh --team_id your_team_id"
</span><span class='line'>    #deliver(beta: true)
</span><span class='line'>
</span><span class='line'>    # You can also use other beta testing services here
</span><span class='line'>    sh "curl -F \"file=@/Users/dongmeiliang/Documents/HJKApp/srsApp/srsApp.ipa\" -F \"uKey=USER_TOKEN\" -F \"_api_key=APP_KEY\" http://www.pgyer.com/apiv1/app/upload"
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # You can define as many lanes as you want
</span><span class='line'>
</span><span class='line'>  after_all do |lane|
</span><span class='line'>    # This block is called, only if the executed lane was successful
</span><span class='line'>
</span><span class='line'>     slack(
</span><span class='line'>       message: "Successfully deployed new App Update."
</span><span class='line'>     )
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  error do |lane, exception|
</span><span class='line'>     slack(
</span><span class='line'>       message: exception.message,
</span><span class='line'>       success: false
</span><span class='line'>     )
</span><span class='line'>  end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>使用 <code>fastlane fir</code>测试能否正常构建。</p>

<h3>自动测试</h3>

<p>可以利用 xcodebuild 命令来实现自动测试。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ xcodebuild -project UI\ Testing\ In\ Xcode.xcodeproj -scheme UI\ Testing\ In\ Xcode -destination 'platform=iOS Simulator,name=iPhone 6s,OS=9.1' test</span></code></pre></td></tr></table></div></figure>


<h3>jenkins 持续集成</h3>

<ol>
<li><p>创建自动构建 job</p>

<ul>
<li>Open <a href="http://localhost:8080">http://localhost:8080</a> with safari</li>
<li><p>Install plugins</p>

<ul>
<li>HTML Publisher Plugin</li>
<li>AnsiColor Plugin</li>
<li>Rebuild Plugin</li>
<li>GIT Plugin</li>
</ul>
</li>
<li><p>Create job > input item name > Freestyle project > OK</p></li>
<li><p>Configuration
  Source Code Management
  Git
  Repository URL /Users/dongmeiliang/Documents/HJKApp
  Branches to build */test
  Add build step > Execute shell</p>

<pre><code class="``">  #!/bin/bash   
  source ~/.bash_profile  
  cd srsApp/  
  fastlane  fir  
</code></pre></li>
<li>Save > build</li>
</ul>
</li>
<li><p>创建自动测试 job</p>

<p> Add build step > Execute shell</p>

<pre><code class="`"> #!/bin/bash   
 source ~/.bash_profile  
 $ xcodebuild -project UI\ Testing\ In\ Xcode.xcodeproj -scheme UI\ Testing\ In\ Xcode -destination 'platform=iOS Simulator,name=iPhone 6s,OS=9.1' test
</code></pre></li>
</ol>


<h2>Reference</h2>

<p>Testing with Xcode
<a href="https://github.com/fastlane/fastlane">fastlane</a><br/>
<a href="https://github.com/fastlane/fastlane/blob/master/docs/Jenkins.md">Jenkins Integration</a><br/>
<a href="http://blog.csdn.net/colorapp/article/details/47007329">iOS可持续化集成: Jenkins + bundler + cocoapods + shenzhen + fastlane + pgyer</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App 开发问题汇总（四）]]></title>
    <link href="http://DamianSheldon.github.io/blog/ios-devleopment-problems-part-4.html"/>
    <updated>2015-10-15T15:04:13+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/ios-devleopment-problems-part-4</id>
    <content type="html"><![CDATA[<h3>1. Suppressing deprecated warnings</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#pragma clang diagnostic push
</span><span class='line'>#pragma clang diagnostic ignored "-Wdeprecated-declarations"
</span><span class='line'>[reciver deprecatedMethod];
</span><span class='line'>#pragma clang diagnostic pop</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://nshipster.cn/pragma/">http://nshipster.cn/pragma/</a></p>

<h3>2. Warning libopencore-amrnb.a, missing required architecture arm64</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ld: warning: ignoring file /Users/dongmeiliang/Downloads/VoiceConvert/VoiceConvert/VoiceConvert/lib/libopencore-amrnb.a, missing required architecture arm64 in file /Users/dongmeiliang/Downloads/VoiceConvert/VoiceConvert/VoiceConvert/lib/libopencore-amrnb.a (3 slices)
</span><span class='line'>ld: warning: ignoring file /Users/dongmeiliang/Downloads/VoiceConvert/VoiceConvert/VoiceConvert/lib/libopencore-amrwb.a, missing required architecture arm64 in file /Users/dongmeiliang/Downloads/VoiceConvert/VoiceConvert/VoiceConvert/lib/libopencore-amrwb.a (3 slices)
</span><span class='line'>Undefined symbols for architecture arm64:
</span><span class='line'>  "_Decoder_Interface_init", referenced from:
</span><span class='line'>      DecodeAMRFileToWAVEFile(char const*, char const*) in libVoiceConvert.a(amrFileCodec.o)
</span><span class='line'>  "_Decoder_Interface_Decode", referenced from:
</span><span class='line'>      DecodeAMRFileToWAVEFile(char const*, char const*) in libVoiceConvert.a(amrFileCodec.o)
</span><span class='line'>  "_Decoder_Interface_exit", referenced from:
</span><span class='line'>      DecodeAMRFileToWAVEFile(char const*, char const*) in libVoiceConvert.a(amrFileCodec.o)
</span><span class='line'>  "_Encoder_Interface_init", referenced from:
</span><span class='line'>      EncodeWAVEFileToAMRFile(char const*, char const*, int, int) in libVoiceConvert.a(amrFileCodec.o)
</span><span class='line'>  "___gxx_personality_v0", referenced from:
</span><span class='line'>      +[VoiceConverter amrToWav:wavSavePath:] in libVoiceConvert.a(VoiceConverter.o)
</span><span class='line'>      +[VoiceConverter wavToAmr:amrSavePath:] in libVoiceConvert.a(VoiceConverter.o)
</span><span class='line'>  "_Encoder_Interface_Encode", referenced from:
</span><span class='line'>      EncodeWAVEFileToAMRFile(char const*, char const*, int, int) in libVoiceConvert.a(amrFileCodec.o)
</span><span class='line'>  "_Encoder_Interface_exit", referenced from:
</span><span class='line'>      EncodeWAVEFileToAMRFile(char const*, char const*, int, int) in libVoiceConvert.a(amrFileCodec.o)</span></code></pre></td></tr></table></div></figure>


<p>Solution: Recompile a static library refer <a href="https://github.com/feuvan/opencore-amr-iOS">opencore-amr-iOS</a></p>

<!-- more -->


<h3>3. Undefined symbols for architecture arm64:</h3>

<p>  &ldquo;___gxx_personality_v0&rdquo;, referenced from:
      +[VoiceConverter amrToWav:wavSavePath:] in libVoiceConvert.a(VoiceConverter.o)
      +[VoiceConverter wavToAmr:amrSavePath:] in libVoiceConvert.a(VoiceConverter.o)
ld: symbol(s) not found for architecture arm64</p>

<p>Solution: Project > Targets > Select your product target > Build Settings > Other Linker Flags > Add -l"stdc++"</p>

<p>Reference:<a href="http://stackoverflow.com/questions/2846679/creating-an-objective-c-static-library-in-xcode">http://stackoverflow.com/questions/2846679/creating-an-objective-c-static-library-in-xcode</a></p>

<h3>4. Suppressing performSelector may cause leaks warnings</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#pragma clang diagnostic push
</span><span class='line'>#pragma clang diagnostic ignored "-Warc-performSelector-leaks"
</span><span class='line'>    [self.ticketTarget performSelector: self.ticketAction withObject: self];
</span><span class='line'>#pragma clang diagnostic pop</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/7017281/performselector-may-cause-a-leak-because-its-selector-is-unknown">http://stackoverflow.com/questions/7017281/performselector-may-cause-a-leak-because-its-selector-is-unknown</a></p>

<h3>5.How to remove UINavigationBar and UISearchBar hairline?</h3>

<p>Solution:</p>

<blockquote><p>For a custom shadow image to be shown, a custom background image must also be set with the setBackgroundImage:forBarMetrics: method. If the default background image is used, then the default shadow image will be used regardless of the value of this property.</p></blockquote>

<p>So we can cut a 1x1 pixel pure color image, set this image as navigation bar&rsquo;s shadow image.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/19037464/how-to-remove-uinavigationbar-and-uisearchbar-hairline">http://stackoverflow.com/questions/19037464/how-to-remove-uinavigationbar-and-uisearchbar-hairline</a><br/>
<a href="http://stackoverflow.com/questions/19226965/how-to-hide-ios7-uinavigationbar-1px-bottom-line">http://stackoverflow.com/questions/19226965/how-to-hide-ios7-uinavigationbar-1px-bottom-line</a></p>

<h3>6. Tab Bar item 设置的默认图片是白色的，但是显示却是灰色</h3>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>UIImage *userImage = [UIImage imageNamed:@"User"];
</span><span class='line'>userImage = [userImage imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];
</span><span class='line'>UITabBarItem *friends = [[UITabBarItem alloc] initWithTitle:@"Recommand Friends" image:userImage selectedImage:userImage];</span></code></pre></td></tr></table></div></figure>


<h3>7. UIWebView&rsquo;s cache doesn&rsquo;t work</h3>

<p>Solution:</p>

<blockquote><p>Create requestObj with specific cache policy ReturnCacheDataElseLoad if you can tell there is no network, or use the default behavior.</p></blockquote>

<p>Reference:<a href="http://stackoverflow.com/questions/32605084/uiwebview-cache-not-working">http://stackoverflow.com/questions/32605084/uiwebview-cache-not-working</a></p>

<h3>8.How to only show bottom border of UITextField</h3>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var bottomLine = CALayer()
</span><span class='line'>bottomLine.frame = CGRectMake(0.0, myTextField.frame.height - 1, myTextField.frame.width, 1.0)
</span><span class='line'>bottomLine.backgroundColor = UIColor.whiteColor().CGColor
</span><span class='line'>myTextField.borderStyle = UITextBorderStyle.None
</span><span class='line'>myTextField.layer.addSublayer(bottomLine)</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/31107994/how-to-only-show-bottom-border-of-uitextfield-in-swift">http://stackoverflow.com/questions/31107994/how-to-only-show-bottom-border-of-uitextfield-in-swift</a></p>

<h3>9. 让Button的大小比它的内容略大</h3>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>_loginViaSMSButton.contentEdgeInsets = UIEdgeInsetsMake(0, 20, 0, 20);
</span></code></pre></td></tr></table></div></figure>


<h3>10. UITableViewStyleGrouped style UITableView has extra space at top</h3>

<p>Solution:</p>

<blockquote><p>UITableViewStyleGrouped divides each section into a &ldquo;group&rdquo; by inserting that extra padding…similar to what it did pre-iOS7, but clear instead of colored by default, and just at the top instead of all the way around. If you don&rsquo;t want the padding by default, use UITableViewStylePlain.</p></blockquote>

<p>Otherwise, if you need to keep the style the same, do what this other posted from that link recommended and change the content inset:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>self.tableView.contentInset = UIEdgeInsetsMake(-36, 0, 0, 0);
</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/20305943/why-extra-space-is-at-top-of-uitableview-simple">http://stackoverflow.com/questions/20305943/why-extra-space-is-at-top-of-uitableview-simple</a></p>

<h3>11. 使用 UISearchDisplayController 遇到的问题</h3>

<p>使用代码创建的 UISearchDisplayController 必须用一个属性来持有它，个人觉得这里有点奇怪，因为 UIViewController 在头文件中的声明是：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@property(nonatomic, readonly, strong) UISearchDisplayController *searchDisplayController</span></code></pre></td></tr></table></div></figure>


<p>理论上来讲既然是 strong 那么这个对象应该会存在才对，但不知道什么原因，这样并不行，它会在内存中被销毁，还是得在扩展里用一个属性来持有它。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>*.m
</span><span class='line'>
</span><span class='line'>@property (nonatomic) UISearchDisplayController *wt_searchDisplayController;
</span><span class='line'>
</span><span class='line'>self.wt_searchDisplayController = [[UISearchDisplayController alloc] initWithSearchBar:self.searchBar contentsController:self];
</span><span class='line'>self.wt_searchDisplayController.delegate = self;
</span><span class='line'>self.wt_searchDisplayController.searchResultsDataSource = self.searchCoordinator;
</span><span class='line'>self.wt_searchDisplayController.searchResultsDelegate = self.searchCoordinator;
</span><span class='line'>[self.wt_searchDisplayController.searchResultsTableView registerClass:[RCConversationCell class] forCellReuseIdentifier:sSearchCellIdentifier];
</span></code></pre></td></tr></table></div></figure>


<p>问题还没有完全解决，我应用的导航结构是 UINavigationController > UITabBarController [VC1, VC 2, VC3], 在 VC1 界面里需要搜索功能，然后我在 VC1 navigation bar 下方放置了一个 search bar， 这个 search bar 和 searchDisplayController 关联起来，结果却出现 search result tableView 覆盖 search bar 的情况，最后的解决办法是调整导航结构 UINavigationController > UITabBarController [(UINavigationController > VC1), (UINavigationController > VC2), (UINavigationController > VC3)], 也就是先把 UIViewController 嵌入到 UINavigationController 中， 再把它做为 UITabBarController 的 childController.</p>

<h3>12. Controller 的视图 Layer 上添加 AVCaptureVideoPreviewLayer， 然后再在 Controller 的 View 上添加一个扫描框视图，用系统的 View 作为扫描框视图时能正常显示相机的捕获的内容， 用自定义的视图时，扫描框内全是黑的。</h3>

<p>Solution:在自定义视图的初始化方法中设置 opaque 为 NO。</p>

<h3>13. You are not authorized to use this service.</h3>

<p>Solution: I recently enable Apple ID two-step verification. When I upload app to App Store via Xcode it inform me &ldquo;You are not authorized to use this service.&rdquo; I feel very strange. I decide to use Application Loader after search with google.  Sign in Application Loader need app-specific password, you can get it follow instructs:</p>

<ol>
<li>Sign in to your <a href="https://appleid.apple.com/account/home">Apple ID account page</a>;</li>
<li>In the Security section, click Edit.</li>
<li>Click Generate Password and follow the steps on your screen.</li>
</ol>


<p>Reference:<a href="https://support.apple.com/en-us/HT204397">https://support.apple.com/en-us/HT204397</a></p>

<p>Now we can upload app with Application Loader:
1. Xcode > Open Developer Tool > Application Loader
2. Sign in Application Loader with app-specific password
3. Click on &ldquo;Choose&rdquo;
4. Pick the IPA you have just exported
5. Follow submission process</p>

<p>Reference:<a href="http://stackoverflow.com/questions/33291394/xcode-7-1-not-authorized-to-use-this-service-error">http://stackoverflow.com/questions/33291394/xcode-7-1-not-authorized-to-use-this-service-error</a></p>

<h3>14.</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ERROR ITMS-90535: "Unexpected CFBundleExecutable Key. The bundle at 'Payload/sohiOSApp.app/TencentOpenApi_IOS_Bundle.bundle' does not contain a bundle executable. If this bundle intentionally does not contain an executable, consider removing the CFBundleExecutable key from its Info.plist and using a CFBundlePackageType of BNDL. If this bundle is part of a third-party framework, consider contacting the developer of the framework for an update to address this issue."</span></code></pre></td></tr></table></div></figure>


<p>Solotion:Removing the CFBundleExecutable key from TencentOpenApi_IOS_Bundle.bundle&rsquo;s Info.plist and using a CFBundlePackageType of BNDL.</p>

<h3>15. Pointer is missing a nullability type specifier</h3>

<p>Solution:It&rsquo;s simply because as soon as you supply any nullability information in a header, you are expected to supply nullability information for everything in that header. Either the whole API is unspecified or the whole API is specified, with regard to nullability. The compiler is just warning you that you have left the job half-finished.</p>

<p>Reference:<a href="http://stackoverflow.com/questions/33028900/pointer-is-missing-a-nullability-type-specifier-on-function-interface">http://stackoverflow.com/questions/33028900/pointer-is-missing-a-nullability-type-specifier-on-function-interface</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[使用 Mac 遇到的问题]]></title>
    <link href="http://DamianSheldon.github.io/blog/problems-when-use-mac.html"/>
    <updated>2015-10-10T08:49:37+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/problems-when-use-mac</id>
    <content type="html"><![CDATA[<h2>1. How to enable the three finger drag on OS X 10.11</h2>

<p>Step 1: Open System Preferences</p>

<p>Step 2: Click Accessibility</p>

<p>Step 3: Click Mouse &amp; Trackpad</p>

<p>Step 4: Click Trackpad Options…</p>

<p>Step 5: Click Enable dragging</p>

<p>Step 6: Select “three finger drag” in the drop down box</p>

<p>Reference:<a href="http://www.idownloadblog.com/2015/06/25/three-finger-drag-gesture-os-x-el-capitan/">http://www.idownloadblog.com/2015/06/25/three-finger-drag-gesture-os-x-el-capitan/</a></p>

<!-- more -->


<h2>2. How to find computer name on Mac</h2>

<ol>
<li><p>GUI<br/>
System Preference > Sharing</p></li>
<li><p>Command Line</p>

<pre><code class="`"> $ hostname
</code></pre></li>
</ol>


<h2>3. SSH to Server Without Entering Password From Mac</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cp ~/.ssh/id_rsa.pub ~/.ssh/authorized_keys</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="https://thecustomizewindows.com/2014/04/ssh-server-without-entering-password-mac-os-x/">https://thecustomizewindows.com/2014/04/ssh-server-without-entering-password-mac-os-x/</a></p>

<!-- more -->


<h2>4. How to open google search results in a new tab？</h2>

<p>Solution:Here&rsquo;s how to make Google open your results in a new tab every time. If you&rsquo;d rather Google not open your results on the same page, you can set the default by going to Google and clicking on the cog in the upper right-hand corner. Choose &ldquo;Search Settings&rdquo; from the list, then scroll down to &ldquo;Where Results Open&rdquo;.</p>

<h2>5. 怎么输入千分号？</h2>

<p>Solution:shift-option-R输入‰
Reference:<a href="http://newping.cn/414">http://newping.cn/414</a></p>

<h2>6. Mac keyboard shortcuts</h2>

<p>Solution:
Command ⌘
Shift ⇧
Option ⌥
Control ⌃
Caps Lock ⇪
Fn</p>

<p>Reference:<a href="https://support.apple.com/en-us/HT201236">https://support.apple.com/en-us/HT201236</a></p>

<h2>7. Add a user to a group</h2>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo dscl localhost -append /Local/Default/Groups/thegroupname GroupMembership theusername</span></code></pre></td></tr></table></div></figure>


<h2>8. To create a group</h2>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ dscl / -create /Groups/GROUP
</span><span class='line'>$ dscl / -create /Groups/GROUP PrimaryGroupID GID
</span><span class='line'>$ dscl / -create /Groups/GROUP Password \*</span></code></pre></td></tr></table></div></figure>


<h2>9. To create a user</h2>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ dscl / -create /Users/USER
</span><span class='line'>$ dscl / -create /Users/USER UniqueID UID
</span><span class='line'>$ dscl / -create /Users/USER UserShell /usr/bin/false
</span><span class='line'>$ dscl / -create /Users/USER RealName 'DESCRIPTION'
</span><span class='line'>$ dscl / -create /Users/USER NFSHomeDirectory DIRECTORY
</span><span class='line'>$ dscl / -create /Users/USER PrimaryGroupID GID
</span><span class='line'>$ dscl / -create /Users/USER Password \*</span></code></pre></td></tr></table></div></figure>


<h2>10. How to view whether port was occupied under mac?</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1) netstat -an | grep 'port'
</span><span class='line'>2) lsof -i:port</span></code></pre></td></tr></table></div></figure>


<h2>11. If you forgot the passcode for your iPhone, iPad, or iPod touch, or your device is disabled</h2>

<p>A:<a href="https://support.apple.com/en-us/HT204306">https://support.apple.com/en-us/HT204306</a></p>

<h2>12. Disable AAM Updates Notifier</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo mv /Library/LaunchAgents/com.adobe.AAM.Updater-1.0.plist /Library/LaunchAgents/com.adobe.AAM.Updater-1.0.plist.disable</span></code></pre></td></tr></table></div></figure>


<h2>13. 如何解决Mac里面解压后文件名乱码问题?</h2>

<p>A: <a href="http://www.jayz.me/?p=493">http://www.jayz.me/?p=493</a></p>

<h2>14. 如何识别 MacBook Pro 机型?</h2>

<p>A:<a href="https://support.apple.com/zh-cn/HT201300">https://support.apple.com/zh-cn/HT201300</a></p>

<h2>15.Mac: Can&rsquo;t assign requested address (code=49) or ssh: connect to host xxx.xx.xx.xx port xx: Can&rsquo;t assign requested address</h2>

<p>A:
Can&rsquo;t assign requested address (code=49) is a bug in Mac OS X, and not an issue with OVPN itself.</p>

<p>There are two ways of fixing this issue. The first one is easier as you simply have to restart your computer. Otherwise, you can solve the problem through the terminal. If you have a cable connection, you type the following into a terminal:</p>

<p>sudo ifconfig en0 down</p>

<p>sudo route flush</p>

<p>sudo ifconfig en0 up</p>

<p>If you instead use WiFi, you type:</p>

<p>sudo ifconfig en1 down</p>

<p>sudo route flush</p>

<p>sudo ifconfig en1 up</p>

<p>Type every line separately. If asked for your password, simply type the password for your computer and not for OVPN.</p>

<p>If the command sudo route flush takes longer than 10 seconds to complete, hold down Ctrl + C.</p>

<p>Reference:<a href="https://www.ovpn.se/en/faq/troubleshooting/mac-cant-assign-requested-address-code49">https://www.ovpn.se/en/faq/troubleshooting/mac-cant-assign-requested-address-code49</a></p>

<h2>16. iPhone每次连接Mac都会弹出iPhoto</h2>

<p>解决办法：</p>

<ol>
<li>Plug in your iPad/iPhone</li>
<li>Open Image Capture</li>
<li>Select your device (&ldquo;devMikePad&rdquo;)</li>
<li>Press the triangle in square symbol in the lower left corner.</li>
<li>Select &ldquo;No application&rdquo; in the menu.</li>
</ol>


<p>iPhoto:
Preferences > General > &ldquo;Connecting Camera Opens &hellip;&rdquo;
set it to &ldquo;No Application&rdquo;</p>

<h2>17. Add environment variable</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// ~/.bash_profile
</span><span class='line'>export var=value</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mac 安装 OS X El Capitan]]></title>
    <link href="http://DamianSheldon.github.io/blog/note-of-install-os-x-el-capitan-and-set-up-development-enviroment.html"/>
    <updated>2015-10-09T18:00:22+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/note-of-install-os-x-el-capitan-and-set-up-development-enviroment</id>
    <content type="html"><![CDATA[<p>最近 Apple 更新了 OS X，通过 App Store 更新下载下来 OS X El Capitan 的安装时遇到问题了 &ndash; 手头的这台 Mac 之前有人分区安装了 Windows, OS X 安装在第二个分区， OS X El Capitan 却不能安装在 OS X 所在的分区，而且格式化 Windows 所在的分区又报错，也是醉了，只好重装。</p>

<h2>备份数据</h2>

<p>我用 sftp 把数据备份到另一台 Mac 上, 之前也试过 Migration Assitant 都是卡在最后一分钟，不知道现在这个问题改善了没有。 用 sftp 备份中间也中断了好多次，但手头也没移动硬盘也只能这么将就着了。</p>

<h2>Install OS X El Capitan</h2>

<ol>
<li>需要一个 8GB 左右的 U 盘，因为 El Capitan 的大小超过 6GB ;</li>
<li>从 App Store 下载 El Capitan;</li>
<li>制作安装盘：</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo /Applications/Install\ OS\ X\ Mavericks.app/Contents/Resources/createinstallmedia --volume /Volumes/Untitled --applicationpath /Applications/Install\ OS\ X\ Mavericks.app --nointeraction</span></code></pre></td></tr></table></div></figure>


<ol>
<li>重新启动，按住 option 键，选择通过U盘启动，之后先进入磁盘工具里面把硬盘格式化了（你也可以选择不格式化，这样就是覆盖安装）;</li>
</ol>


<!-- more -->


<h2>安装常用软件</h2>

<ol>
<li>Download Xcode in App Store;</li>
<li>iTerm;</li>
<li>Chrome;</li>
<li>LibreOffice;</li>
<li>Microsoft Remote Desktop Connection;</li>
<li>Homebrew;</li>
<li>ruby;</li>
<li>Set up web development envrionment</li>
</ol>


<p>Reference:<a href="http://blog.devtang.com/blog/2014/04/12/install-mavericks-note/">http://blog.devtang.com/blog/2014/04/12/install-mavericks-note/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Set up PHP development environment]]></title>
    <link href="http://DamianSheldon.github.io/blog/set-up-php-development-environment.html"/>
    <updated>2015-09-19T22:25:19+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/set-up-php-development-environment</id>
    <content type="html"><![CDATA[<h3>Notes of Set up PHP development environment</h3>

<ol>
<li>Install <a href="https://eclipse.org/pdt/#download">Eclipse PDT</a>;</li>
<li><a href="http://jason.pureconcepts.net/2012/10/install-pear-pecl-mac-os-x/">Install PEAR and PECL on Mac OS X</a>, php.ini locate in /etc on Yosemite;</li>
<li><p><a href="http://www.xdebug.org/docs/install">Install Xdebug through PEAR/PECL</a>;<br/>
 Addition configure for Yosemite</p>

<ul>
<li><code>sudo cp /etc/php.ini.default /etc/php.ini</code></li>
<li>add &ldquo;zend_extension=/usr/lib/php/extensions/no-debug-non-zts-20121212/xdebug.so&rdquo; to php.ini</li>
</ul>
</li>
<li><p>Debugging Local PHP Files (PHP CLI Application)</p>

<ul>
<li>Create a PHP project;</li>
<li>Create a PHP file;</li>
<li>Set a breakpoint in PHP file;</li>
<li>Save file;</li>
<li>Create a new debug configuration;

<ul>
<li>Eclipse > Preference&hellip; > PHP Executables > Add (Executable path: <code>which php</code>)</li>
<li>Run > Debug Configurations > Select PHP CLI Application > New</li>
</ul>
</li>
</ul>
</li>
<li><p>Debugging PHP Web Applications (PHP Web Application)</p>

<ul>
<li>Create a PHP project;</li>
<li>Create a PHP file;</li>
<li>Create a new debug configuration;

<ul>
<li>Run > Debug Configurations > Select PHP Web Application > New</li>
</ul>
</li>
</ul>
</li>
<li><p>Test with PHPUnit</p>

<ul>
<li>Run > External Tools > External Tools Configurations&hellip; > Program > New
[Main]
Location:/usr/local/bin/phpunit
Working Directory:${workspace_loc:/Backend/tests}
Apply > Run
<a href="http://stackoverflow.com/questions/966673/eclipse-pdt-phpunit">Reference</a></li>
</ul>
</li>
<li><p>Integrate MakeGood (failure)</p>

<ul>
<li>Installing Prerequisite Software

<ul>
<li>PHP 5.5.27 (cli)</li>
<li>xdebug-2.3.2</li>
<li>eclipse mars(4.5.0)</li>
<li>PDT(3.5.0)</li>
<li>PHPUnit (4.8.6)</li>
</ul>
</li>
<li><p>Installing MakeGood
  Help -> Install New Software&hellip; -> Add&hellip; -> <a href="http://eclipse.piece-framework.com/">http://eclipse.piece-framework.com/</a></p></li>
<li><p>Selecting a Testing Framework</p></li>
<li><p>Resolving the Dependencies to the Testing Framework</p>

<pre><code>  * Defining User Libraries
      Eclipse -&gt; Preferences... &gt; PHP -&gt; PHP Libraries &gt; New... &gt; OK
      Add External folder... &gt; [Verifying the include path](http://pear.php.net/manual/en/installation.checking.php)
  * Adding User Libraries to the Project
</code></pre>

<p>   fail with PHPUnit_Framework_TestCase class is not available. Fix&hellip;, I doubt that MakeGood doesn&rsquo;t support eclipse mars.</p></li>
</ul>


<p> *Testing Framework Specific Configuration<br/>
     PHPUnit</p>

<pre><code> * Open the properties for the project.
 * Select MakeGood.
 * Select PHPUnit.
 * Specify the XML Configuration File. [eg](http://beagile.biz/a-simple-phpunit-xml-configuration-example/)
</code></pre>

<p> <a href="http://piece-framework.com/projects/makegood/wiki/MakeGood_User_Guide_1_7_0">Reference</a></p></li>
</ol>


<h3>Throw java.lang.NullPointerException when create a new debug configuration</h3>

<p>Solution: Add a PHP Executable, Eclipse > Preference&hellip; > PHP Executables > Add (Executable path: <code>which php</code>)</p>

<h3>Wait for XDebug session</h3>

<p>Solution:Debugging PHP Web Applications时卡在这里，原因是XDebug remote debug没配置好，参考了<a href="http://www.xdebug.org/docs/remote">Remote Debugging</a>和<a href="https://wiki.eclipse.org/Debugging_using_XDebug">Debugging using XDebug</a>，发现phpinfo()输出的内容并没有XDebug。于是来开始配置php.ini,参考的<a href="http://stackoverflow.com/questions/27861720/how-to-set-default-php-ini-to-be-used-osx-yosemite">How to set default php.ini to be used, OSX Yosemite</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo cp /etc/php.ini.default /etc/php.ini
</span><span class='line'>
</span><span class='line'>// Add follow content to php.ini
</span><span class='line'>[XDebug]
</span><span class='line'>zend_extension=/usr/lib/php/extensions/no-debug-non-zts-20121212/xdebug.so
</span><span class='line'>xdebug.remote_enable=On
</span><span class='line'>xdebug.remote_handler=dbgp
</span><span class='line'>xdebug.remote_host=helloworld.local
</span><span class='line'>xdebug.remote_port=9000
</span><span class='line'>;xdebug.remote_connect_back=1
</span><span class='line'>xdebug.remote_mode="req"
</span><span class='line'>xdebug.remote_log="/var/log/xdebug.log"
</span><span class='line'>
</span><span class='line'>sudo apachectl restart</span></code></pre></td></tr></table></div></figure>


<h3>/private/tmp/pear/install/xdebug/xdebug.c:25:10: fatal error: &lsquo;php.h&rsquo; file not found</h3>

<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ xcode-select --install</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/19531262/cant-phpize-or-configure-an-extension-in-os-x-10-9-mavericks">http://stackoverflow.com/questions/19531262/cant-phpize-or-configure-an-extension-in-os-x-10-9-mavericks</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Notes of Wireshark]]></title>
    <link href="http://DamianSheldon.github.io/blog/notes-of-wireshark.html"/>
    <updated>2015-09-15T09:05:51+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/notes-of-wireshark</id>
    <content type="html"><![CDATA[<h3>1.Capture HTTP traffic on your server</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Capture &gt; Capture Filters... &gt; New &gt; OK
</span><span class='line'>Capture &gt; Options... &gt; Capture Filter(Set to appropriate filter) &gt; Start
</span><span class='line'>
</span><span class='line'>host www.baidu.com
</span><span class='line'>
</span><span class='line'>curl -d "name=test&page=1" http://www.baidu.com</span></code></pre></td></tr></table></div></figure>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>POST / HTTP/1.1
</span><span class='line'>User-Agent: curl/7.37.1
</span><span class='line'>Host: www.baidu.com
</span><span class='line'>Accept: */*
</span><span class='line'>Content-Length: 16
</span><span class='line'>Content-Type: application/x-www-form-urlencoded
</span><span class='line'>
</span><span class='line'>name=test&page=1
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>HTTP/1.1 302 Moved Temporarily
</span><span class='line'>Date: Tue, 15 Sep 2015 00:56:03 GMT
</span><span class='line'>Content-Type: text/html
</span><span class='line'>Content-Length: 215
</span><span class='line'>Connection: Keep-Alive
</span><span class='line'>Location: http://www.baidu.com/search/error.html
</span><span class='line'>Server: BWS/1.1
</span><span class='line'>X-UA-Compatible: IE=Edge,chrome=1
</span><span class='line'>BDPAGETYPE: 3
</span><span class='line'>Set-Cookie: BDSVRTM=0; path=/
</span><span class='line'>
</span><span class='line'>&lt;html&gt;
</span><span class='line'>&lt;head&gt;&lt;title&gt;302 Found&lt;/title&gt;&lt;/head&gt;
</span><span class='line'>&lt;body bgcolor="white"&gt;
</span><span class='line'>&lt;center&gt;&lt;h1&gt;302 Found&lt;/h1&gt;&lt;/center&gt;
</span><span class='line'>&lt;hr&gt;&lt;center&gt;pr-nginx_1-0-245_BRANCH Branch
</span><span class='line'>Time : Thu Sep 10 11:36:26 CST 2015&lt;/center&gt;
</span><span class='line'>&lt;/body&gt;
</span><span class='line'>&lt;/html&gt;</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="https://wiki.wireshark.org/CaptureFilters">https://wiki.wireshark.org/CaptureFilters</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux Useful Command Line Part 2]]></title>
    <link href="http://DamianSheldon.github.io/blog/linux-useful-command-line-part-2.html"/>
    <updated>2015-09-11T09:30:16+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/linux-useful-command-line-part-2</id>
    <content type="html"><![CDATA[<h3>1.Rails Error: ImageMagick/GraphicsMagick is not installed</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brew install graphicsmagick
</span><span class='line'>brew install ImageMagick</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/29377651/rails-error-imagemagick-graphicsmagick-is-not-installed">http://stackoverflow.com/questions/29377651/rails-error-imagemagick-graphicsmagick-is-not-installed</a></p>

<h3>2.Transfer file via scp (or sftp) between two Mac</h3>

<p>Via scp:<br/>
1.Enable Enable SSH
     System Preferences > Sharing > enable the “Remote Login” feature</p>

<p>2.type scp command</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>scp VirtualBox-5.0.4-102546-OSX.dmg dongmeiliang@192.168.1.255:/Users/dongmeiliang/Documents/</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<p>Via s<a href="ftp:">ftp:</a></p>

<p>1.sftp <a href="&#109;&#97;&#x69;&#108;&#116;&#111;&#58;&#100;&#111;&#x6e;&#x67;&#x6d;&#101;&#105;&#x6c;&#105;&#x61;&#110;&#x67;&#x40;&#x31;&#x39;&#50;&#x2e;&#49;&#x36;&#x38;&#46;&#x31;&#46;&#50;&#x35;&#53;">&#x64;&#x6f;&#110;&#x67;&#x6d;&#101;&#x69;&#108;&#x69;&#97;&#110;&#x67;&#64;&#x31;&#x39;&#50;&#46;&#49;&#x36;&#x38;&#x2e;&#49;&#46;&#50;&#x35;&#53;</a><br/>
2.cd path<br/>
  Change remote directory to path.</p>

<p>3.lcd path<br/>
  Change local directory to path.</p>

<p>4.get [-Ppr] remote-path [local-path]</p>

<p>5.lpwd    Print local working directory.</p>

<p>6.pwd     Display remote working directory.</p>

<p>7.put [-Ppr] local-path [remote-path]</p>

<p>8.lls [ls-options [path]]
             Display local directory listing of either path or current directory if path is not specified.  ls-options may con-
             tain any flags supported by the local system&rsquo;s ls(1) command.  path may contain glob(3) characters and may match
             multiple files.</p>

<p>9.ls [-1afhlnrSt] [path]
             Display a remote directory listing of either path or the current directory if path is not specified.  path may con-
             tain glob(3) characters and may match multiple files.</p>

<p>10.Quit sftp</p>

<p>bye<br/>
exit<br/>
quit</p>

<h3>3.Installing Apps with Homebrew Cask</h3>

<p><a href="http://caskroom.io/">Homebrew Cask</a> is an extension for Homebrew that allows you to automate the installation of Mac Apps and Fonts.</p>

<p>After you have homebrew installed, you&rsquo;ll want to install Homebrew Cask:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ brew install caskroom/cask/brew-cask</span></code></pre></td></tr></table></div></figure>


<h3>4.复制目录及子目录下的某种类型文件</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cp  ~/Documents/HJKApp/srsApp/srsApp/Sections/Home/Main.xcassets/**/*.png  ~/Pictures/HJKApp/OnlyHaveScale2/</span></code></pre></td></tr></table></div></figure>


<h3>5.Recursive copy of specific files in Unix/Linux?</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rsync -avm --include='*.jar' -f 'hide,! */' . /destination_dir</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://stackoverflow.com/questions/9622883/recursive-copy-of-specific-files-in-unix-linux">http://stackoverflow.com/questions/9622883/recursive-copy-of-specific-files-in-unix-linux</a></p>

<h3>6.Uploading directories with sftp?</h3>

<p>I don&rsquo;t know why sftp does this but you can only recursive copy if the destination directory already exists. So do this&hellip;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sftp&gt; mkdir bin  
</span><span class='line'>sftp&gt; put -r bin</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://unix.stackexchange.com/questions/7004/uploading-directories-with-sftp">http://unix.stackexchange.com/questions/7004/uploading-directories-with-sftp</a></p>

<h3>7.Scanning machine&rsquo;s specified ports</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ nmap -p 37099 192.168.3.214
</span><span class='line'>// -Pn: Treat all hosts as online -- skip host discovery
</span><span class='line'>$ nmap -Pn 192.168.3.214</span></code></pre></td></tr></table></div></figure>


<h3>8.Reverse search history command</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Execute last command
</span><span class='line'>$ !!
</span><span class='line'>
</span><span class='line'>Ctrl + r
</span><span class='line'>(reverse-i-search)`': pull
</span><span class='line'>(reverse-i-search)`': git</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://unix.stackexchange.com/questions/3747/understanding-the-exclamation-mark-in-bash">http://unix.stackexchange.com/questions/3747/understanding-the-exclamation-mark-in-bash</a></p>

<h3>9.How to use rsync upload directory to remote server?</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rsync --delete --rsh=ssh -av /Users/dongmeiliang/Sites/upload/ meiliang@remote_ip:/home/meiliang/public_html/upload</span></code></pre></td></tr></table></div></figure>


<h3>10.Recursively Search All Files For A String</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// grep command: Recursively Search All Files For A String
</span><span class='line'>
</span><span class='line'>cd /path/to/dir
</span><span class='line'>grep -r "word" .
</span><span class='line'>
</span><span class='line'>grep -r "string" .
</span><span class='line'>
</span><span class='line'>// Ignore case distinctions:
</span><span class='line'>grep -ri "word" .
</span><span class='line'>
</span><span class='line'>// To display print only the filenames with GNU grep, enter:
</span><span class='line'>grep -r -l "foo" .
</span><span class='line'>
</span><span class='line'>// You can also specify directory name:
</span><span class='line'>grep -r -l "foo" /path/to/dir/*.c
</span><span class='line'>
</span><span class='line'>// find command: Recursively Search All Files For A String
</span><span class='line'>
</span><span class='line'>// find command is recommend because of speed and ability to deal with filenames that contain spaces.
</span><span class='line'>cd /path/to/dir
</span><span class='line'>find . -type f -exec grep -l "word" {} +
</span><span class='line'>find . -type f -exec grep -l "seting" {} +
</span><span class='line'>find . -type f -exec grep -l "foo" {} +
</span><span class='line'>// Older UNIX version should use xargs to speed up things:
</span><span class='line'>find /path/to/dir -type f | xargs grep -l "foo"
</span><span class='line'>
</span><span class='line'>// It is good idea to pass -print0 option to find command that it can deal with filenames that contain spaces or other metacharacters:
</span><span class='line'>find /path/to/dir -type f -print0 | xargs -0 grep -l "foo"
</span></code></pre></td></tr></table></div></figure>


<h3>11. Common terminal shutcuts</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Ctrl + A    Go to the beginning of the line you are currently typing on
</span><span class='line'>Ctrl + E    Go to the end of the line you are currently typing on
</span><span class='line'>Ctrl + L    Clears the Screen, similar to the clear command
</span><span class='line'>Ctrl + U    Clears the line before the cursor position. If you are at the end of the line, clears the entire line.
</span><span class='line'>Ctrl + H    Same as backspace
</span><span class='line'>Ctrl + R    Let’s you search through previously used commands
</span><span class='line'>Ctrl + C    Kill whatever you are running
</span><span class='line'>Ctrl + D    Exit the current shell
</span><span class='line'>Ctrl + Z    Puts whatever you are running into a suspended background process. fg restores it.
</span><span class='line'>Ctrl + W    Delete the word before the cursor
</span><span class='line'>Ctrl + K    Clear the line after the cursor
</span><span class='line'>Ctrl + T    Swap the last two characters before the cursor
</span><span class='line'>Esc + T Swap the last two words before the cursor</span></code></pre></td></tr></table></div></figure>


<h3>12. 比较目录下同名文件</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ diff -Naur old-dir new-dir</span></code></pre></td></tr></table></div></figure>


<h3>13. curl Command Download File Example</h3>

<p>A:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl  -o LongM4A.m4a http://download.wavetlan.com/SVV/Media/HTTP/LongM4A.m4a</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://www.cyberciti.biz/faq/curl-download-file-example-under-linux-unix/">http://www.cyberciti.biz/faq/curl-download-file-example-under-linux-unix/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vim]]></title>
    <link href="http://DamianSheldon.github.io/blog/vim.html"/>
    <updated>2015-09-10T21:09:05+08:00</updated>
    <id>http://DamianSheldon.github.io/blog/vim</id>
    <content type="html"><![CDATA[<h3>1.查看帮助</h3>

<p>:help</p>

<h3>2.查看quickref</h3>

<p>：help quickref</p>

<h3>3.语法高亮</h3>

<p>|:syn-on|       :syntax on              start using syntax highlighting
|:syn-off|      :syntax off             stop using syntax highlighting</p>

<h3>4.Move cursor to its last position</h3>

<p>The quickest way is to hit either:</p>

<p>&lsquo;&rsquo;
(two apostrophes) or:</p>

<p>``
(two backticks).</p>

<h3>5.Show line number</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:set number</span></code></pre></td></tr></table></div></figure>


<h3>6.Auto indent</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:set autoindent</span></code></pre></td></tr></table></div></figure>


<h3>7.Set background</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:set background=dark
</span><span class='line'>:set background=light</span></code></pre></td></tr></table></div></figure>


<h3>8.Common move command</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0, ^ line head
</span><span class='line'>$, g_ line foot
</span><span class='line'>ctl + f forword page
</span><span class='line'>ctl + b back page</span></code></pre></td></tr></table></div></figure>


<h3>9.用vim编辑一个文件，改动了很多内容；最终要保存时却发现没有权限</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:w !sudo tee % &gt; /dev/null</span></code></pre></td></tr></table></div></figure>


<p>Reference:<a href="http://www.caiyiting.com/blog/2014/vim-sudo.html">http://www.caiyiting.com/blog/2014/vim-sudo.html</a></p>

<h3>10.替换文字时有特殊字符怎么办？</h3>

<p>A:用 \ 转义。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>%s/\/Users\/dongmeiliang\/Sites/\/home\/meiliang\/public_html/g</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
</feed>
